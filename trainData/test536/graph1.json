[{"cfgs": [1], "code": "public void testUnion2() throws Exception\r", "dfgs": [1, 2, 3], "fName": "src_test_java_com_alibaba_druid_bvt_filter_wall_mysql_MySqlWallTest_union.java", "fieldParents": [], "isDel": false, "lineBeg": 48, "lineEnd": 49, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": []}, {"cfgs": [2], "code": "assertFalse(\rWallUtils.isValidateMySql(\"SELECT name, surname FROM users WHERE name='' UNION SELECT @@version, 'string1'\"))", "dfgs": [2], "fName": "src_test_java_com_alibaba_druid_bvt_filter_wall_mysql_MySqlWallTest_union.java", "fieldParents": [], "isDel": false, "lineBeg": 50, "lineEnd": 52, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": []}, {"cfgs": [3], "code": "assertFalse(\rWallUtils.isValidateMySql(\"SELECT name, surname FROM users WHERE name='' UNION SELECT /*! @@version,*/ 'string1'\"))", "dfgs": [3], "fName": "src_test_java_com_alibaba_druid_bvt_filter_wall_mysql_MySqlWallTest_union.java", "fieldParents": [], "isDel": false, "lineBeg": 54, "lineEnd": 56, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertFalse(\rWallUtils.isValidateMySql(\"SELECT name, surname FROM users WHERE name=' ' UNION SELECT /*! (select table_name FROM information_schema.tables limit 1,1),*/ 'string1'\"))", "dfgs": [], "fName": "src_test_java_com_alibaba_druid_bvt_filter_wall_mysql_MySqlWallTest_union.java", "fieldParents": [], "isDel": false, "lineBeg": 58, "lineEnd": 60, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": []}, {"cfgs": [5], "code": "List<SQLCommentHint> hints = x.getHintsDirect()", "dfgs": [5, 9], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 291, "lineEnd": 291, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": []}, {"cfgs": [6], "code": "if (hints != null\r&& x.getParent() instanceof SQLUnionQuery&& x == ((SQLUnionQuery) x.getParent()).getRight())", "dfgs": [6, 9], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 292, "lineEnd": 295, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": []}, {"cfgs": [7], "code": "for (SQLCommentHint hint : hints)", "dfgs": [7], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 296, "lineEnd": 296, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": []}, {"cfgs": [8], "code": "String text = hint.getText()", "dfgs": [8], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 297, "lineEnd": 297, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": []}, {"cfgs": [9], "code": "if (text.startsWith(\"!\"))", "dfgs": [], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 298, "lineEnd": 298, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": []}, {"cfgs": [10], "code": "addViolation(visitor, ErrorCode.UNION, \"union select hint not allow\", x)", "dfgs": [], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 299, "lineEnd": 299, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return", "dfgs": [], "fName": "src_main_java_com_alibaba_druid_wall_spi_WallVisitorUtils.java", "fieldParents": [], "isDel": false, "lineBeg": 300, "lineEnd": 300, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": []}]