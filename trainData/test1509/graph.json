[{"cfgs":[],"code":"XStream xstream = createXStream()","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":true,"lineBeg":38,"lineEnd":38,"lineMapIndex":16,"methodParents":[],"nodeIndex":0},{"cfgs":[],"code":"XStream xstream = createXStream()","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":true,"lineBeg":45,"lineEnd":45,"lineMapIndex":17,"methodParents":[],"nodeIndex":1},{"cfgs":[],"code":"import com.opensymphony.xwork2.ModelDriven","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":25,"lineEnd":25,"lineMapIndex":-1,"methodParents":[],"nodeIndex":2},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.ArrayTypePermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":27,"lineEnd":27,"lineMapIndex":-1,"methodParents":[],"nodeIndex":3},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.ExplicitTypePermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":28,"lineEnd":28,"lineMapIndex":-1,"methodParents":[],"nodeIndex":4},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.NoTypePermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":29,"lineEnd":29,"lineMapIndex":-1,"methodParents":[],"nodeIndex":5},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.NullPermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":30,"lineEnd":30,"lineMapIndex":-1,"methodParents":[],"nodeIndex":6},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.PrimitiveTypePermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":31,"lineEnd":31,"lineMapIndex":-1,"methodParents":[],"nodeIndex":7},{"cfgs":[],"code":"import com.thoughtworks.xstream.security.TypePermission","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":32,"lineEnd":32,"lineMapIndex":-1,"methodParents":[],"nodeIndex":8},{"cfgs":[],"code":"import org.apache.logging.log4j.LogManager","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":33,"lineEnd":33,"lineMapIndex":-1,"methodParents":[],"nodeIndex":9},{"cfgs":[],"code":"import org.apache.logging.log4j.Logger","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":34,"lineEnd":34,"lineMapIndex":-1,"methodParents":[],"nodeIndex":10},{"cfgs":[],"code":"import java.util.Collection","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":39,"lineEnd":39,"lineMapIndex":-1,"methodParents":[],"nodeIndex":11},{"cfgs":[],"code":"import java.util.Date","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":40,"lineEnd":40,"lineMapIndex":-1,"methodParents":[],"nodeIndex":12},{"cfgs":[],"code":"import java.util.Map","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":41,"lineEnd":41,"lineMapIndex":-1,"methodParents":[],"nodeIndex":13},{"cfgs":[],"code":"import java.util.Set","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":42,"lineEnd":42,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[],"code":"private static final Logger LOG = LogManager.getLogger(XStreamHandler.class)","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":49,"lineEnd":49,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[],"code":"XStream xstream = createXStream(invocation)","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":53,"lineEnd":53,"lineMapIndex":0,"methodParents":[19],"nodeIndex":16},{"cfgs":[],"code":"XStream xstream = createXStream(invocation)","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":60,"lineEnd":60,"lineMapIndex":1,"methodParents":[19],"nodeIndex":17},{"cfgs":[],"code":"LOG.warn(\"You are using a deprecated API!\")","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[15],"isDel":false,"lineBeg":69,"lineEnd":69,"lineMapIndex":-1,"methodParents":[],"nodeIndex":18},{"cfgs":[20],"code":"protected XStream createXStream(ActionInvocation invocation) ","dfgs":[20,21,22,23,24,25,26,27],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":73,"lineEnd":73,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21],"code":"XStream stream = new XStream()","dfgs":[22],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":74,"lineEnd":74,"lineMapIndex":-1,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"LOG.debug(\"Clears existing permissions\")","dfgs":[23],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[15],"isDel":false,"lineBeg":75,"lineEnd":75,"lineMapIndex":-1,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"stream.addPermission(NoTypePermission.NONE)","dfgs":[24],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":76,"lineEnd":76,"lineMapIndex":-1,"methodParents":[],"nodeIndex":22},{"cfgs":[24],"code":"LOG.debug(\"Adds per action permissions\")","dfgs":[25],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[15],"isDel":false,"lineBeg":78,"lineEnd":78,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[25],"code":"addPerActionPermission(invocation, stream)","dfgs":[26],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":79,"lineEnd":79,"lineMapIndex":-1,"methodParents":[28],"nodeIndex":24},{"cfgs":[26],"code":"LOG.debug(\"Adds default permissions\")","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[15],"isDel":false,"lineBeg":81,"lineEnd":81,"lineMapIndex":-1,"methodParents":[],"nodeIndex":25},{"cfgs":[27],"code":"addDefaultPermissions(invocation, stream)","dfgs":[27],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":82,"lineEnd":82,"lineMapIndex":-1,"methodParents":[40],"nodeIndex":26},{"cfgs":[],"code":"return stream","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":83,"lineEnd":83,"lineMapIndex":-1,"methodParents":[],"nodeIndex":27},{"cfgs":[29],"code":"private void addPerActionPermission(ActionInvocation invocation, XStream stream) ","dfgs":[29,30,33,36,32,35,31,34,37,38,39],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":86,"lineEnd":86,"lineMapIndex":-1,"methodParents":[],"nodeIndex":28},{"cfgs":[30],"code":"Object action = invocation.getAction()","dfgs":[30],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":87,"lineEnd":87,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[31,33],"code":"if (action instanceof AllowedClasses)","dfgs":[33,31],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":88,"lineEnd":88,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[32],"code":"Set<Class<?>> allowedClasses = ((AllowedClasses) action).allowedClasses()","dfgs":[32],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":89,"lineEnd":89,"lineMapIndex":-1,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"stream.addPermission(new ExplicitTypePermission(allowedClasses.toArray(new Class[allowedClasses.size()])))","dfgs":[35,39],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":90,"lineEnd":90,"lineMapIndex":-1,"methodParents":[],"nodeIndex":32},{"cfgs":[34,36],"code":"if (action instanceof AllowedClassNames)","dfgs":[36,34],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":92,"lineEnd":92,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"Set<String> allowedClassNames = ((AllowedClassNames) action).allowedClassNames()","dfgs":[35],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":93,"lineEnd":93,"lineMapIndex":-1,"methodParents":[],"nodeIndex":34},{"cfgs":[36],"code":"stream.addPermission(new ExplicitTypePermission(allowedClassNames.toArray(new String[allowedClassNames.size()])))","dfgs":[39],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":94,"lineEnd":94,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[37],"code":"if (action instanceof XStreamPermissionProvider)","dfgs":[37],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":96,"lineEnd":96,"lineMapIndex":-1,"methodParents":[],"nodeIndex":36},{"cfgs":[38],"code":"Collection<TypePermission> permissions = ((XStreamPermissionProvider) action).getTypePermissions()","dfgs":[38],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":97,"lineEnd":97,"lineMapIndex":-1,"methodParents":[],"nodeIndex":37},{"cfgs":[39],"code":"for (TypePermission permission : permissions)","dfgs":[39],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":98,"lineEnd":98,"lineMapIndex":-1,"methodParents":[],"nodeIndex":38},{"cfgs":[],"code":"stream.addPermission(permission)","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":99,"lineEnd":99,"lineMapIndex":-1,"methodParents":[],"nodeIndex":39},{"cfgs":[41],"code":"protected void addDefaultPermissions(ActionInvocation invocation, XStream stream) ","dfgs":[41,44,45,46,47,48,42,43],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":104,"lineEnd":104,"lineMapIndex":-1,"methodParents":[],"nodeIndex":40},{"cfgs":[42],"code":"stream.addPermission(new ExplicitTypePermission(new Class[]{invocation.getAction().getClass()}))","dfgs":[44,42,43],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":105,"lineEnd":105,"lineMapIndex":-1,"methodParents":[],"nodeIndex":41},{"cfgs":[43,44],"code":"if (invocation.getAction() instanceof ModelDriven)","dfgs":[43],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":106,"lineEnd":106,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"stream.addPermission(new ExplicitTypePermission(new Class[]{((ModelDriven) invocation.getAction()).getModel().getClass()}))","dfgs":[44],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":107,"lineEnd":107,"lineMapIndex":-1,"methodParents":[],"nodeIndex":43},{"cfgs":[45],"code":"stream.addPermission(NullPermission.NULL)","dfgs":[45],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":109,"lineEnd":109,"lineMapIndex":-1,"methodParents":[],"nodeIndex":44},{"cfgs":[46],"code":"stream.addPermission(PrimitiveTypePermission.PRIMITIVES)","dfgs":[46],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":110,"lineEnd":110,"lineMapIndex":-1,"methodParents":[],"nodeIndex":45},{"cfgs":[47],"code":"stream.addPermission(ArrayTypePermission.ARRAYS)","dfgs":[47],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":111,"lineEnd":111,"lineMapIndex":-1,"methodParents":[],"nodeIndex":46},{"cfgs":[48],"code":"stream.addPermission(CollectionTypePermission.COLLECTIONS)","dfgs":[48],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[50],"isDel":false,"lineBeg":112,"lineEnd":112,"lineMapIndex":-1,"methodParents":[],"nodeIndex":47},{"cfgs":[],"code":"stream.addPermission(new ExplicitTypePermission(new Class[]{Date.class}))","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":113,"lineEnd":113,"lineMapIndex":-1,"methodParents":[],"nodeIndex":48},{"cfgs":[],"code":"private static class CollectionTypePermission implements TypePermission ","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":124,"lineEnd":124,"lineMapIndex":-1,"methodParents":[],"nodeIndex":49},{"cfgs":[],"code":"private static final TypePermission COLLECTIONS = new CollectionTypePermission()","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":126,"lineEnd":126,"lineMapIndex":-1,"methodParents":[],"nodeIndex":50},{"cfgs":[52],"code":"public boolean allows(Class type) ","dfgs":[52],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":129,"lineEnd":129,"lineMapIndex":-1,"methodParents":[],"nodeIndex":51},{"cfgs":[],"code":"return type != null && type.isInterface() &&(Collection.class.isAssignableFrom(type) || Map.class.isAssignableFrom(type))","dfgs":[],"fName":"plugins_rest_src_main_java_org_apache_struts2_rest_handler_XStreamHandler.java","fieldParents":[],"isDel":false,"lineBeg":130,"lineEnd":131,"lineMapIndex":-1,"methodParents":[],"nodeIndex":52}]