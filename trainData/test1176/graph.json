[{"cfgs":[],"code":"if (H < thresholdData[p - 4])","dfgs":[],"fName":"src_main_java_com_clearspring_analytics_stream_cardinality_HyperLogLogPlus.java","fieldParents":[],"isDel":true,"lineBeg":464,"lineEnd":464,"lineMapIndex":3,"methodParents":[],"nodeIndex":0},{"cfgs":[],"code":"import java.util.ArrayList","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":true,"lineBeg":22,"lineEnd":22,"lineMapIndex":4,"methodParents":[],"nodeIndex":1},{"cfgs":[],"code":"import com.clearspring.analytics.util.*","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":true,"lineBeg":28,"lineEnd":28,"lineMapIndex":-1,"methodParents":[],"nodeIndex":2},{"cfgs":[],"code":"if (H < thresholdData[p])","dfgs":[],"fName":"src_main_java_com_clearspring_analytics_stream_cardinality_HyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":464,"lineEnd":464,"lineMapIndex":0,"methodParents":[],"nodeIndex":3},{"cfgs":[],"code":"import java.util.Random","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":23,"lineEnd":23,"lineMapIndex":1,"methodParents":[],"nodeIndex":4},{"cfgs":[],"code":"import java.util.UUID","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":24,"lineEnd":24,"lineMapIndex":-1,"methodParents":[],"nodeIndex":5},{"cfgs":[7],"code":"public static void main(final String[] args) throws Throwable ","dfgs":[8,10,12,14,21,25,26,27,28,29,7,9,13,20,24,15,22,23,17,16,18],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":33,"lineEnd":33,"lineMapIndex":-1,"methodParents":[],"nodeIndex":6},{"cfgs":[8],"code":"long startTime = System.currentTimeMillis()","dfgs":[25,26,27,28,29],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":34,"lineEnd":34,"lineMapIndex":-1,"methodParents":[],"nodeIndex":7},{"cfgs":[9],"code":"int numSets = 10","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":36,"lineEnd":36,"lineMapIndex":-1,"methodParents":[],"nodeIndex":8},{"cfgs":[10],"code":"int setSize = 1 * 1000 * 1000","dfgs":[24,15],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":37,"lineEnd":37,"lineMapIndex":-1,"methodParents":[],"nodeIndex":9},{"cfgs":[],"code":"int repeats = 5","dfgs":[17],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":38,"lineEnd":38,"lineMapIndex":-1,"methodParents":[],"nodeIndex":10},{"cfgs":[12],"code":"HyperLogLogPlus[] counters = new HyperLogLogPlus[numSets]","dfgs":[19,22,23,18],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":40,"lineEnd":40,"lineMapIndex":-1,"methodParents":[],"nodeIndex":11},{"cfgs":[13,14],"code":"for (int i = 0; i < numSets; i++)","dfgs":[14],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":41,"lineEnd":41,"lineMapIndex":-1,"methodParents":[],"nodeIndex":12},{"cfgs":[],"code":"counters[i] = new HyperLogLogPlus(15, 15)","dfgs":[22,18],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":42,"lineEnd":42,"lineMapIndex":-1,"methodParents":[],"nodeIndex":13},{"cfgs":[15,19],"code":"for (int i = 0; i < numSets; i++)","dfgs":[21],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":44,"lineEnd":44,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[16],"code":"for (int j = 0; j < setSize; j++)","dfgs":[24],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":45,"lineEnd":45,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[17],"code":"String val = UUID.randomUUID().toString()","dfgs":[18],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":46,"lineEnd":46,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[18],"code":"for (int z = 0; z < repeats; z++)","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":47,"lineEnd":47,"lineMapIndex":-1,"methodParents":[],"nodeIndex":17},{"cfgs":[],"code":"counters[i].offer(val)","dfgs":[22],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":49,"lineEnd":49,"lineMapIndex":-1,"methodParents":[],"nodeIndex":18},{"cfgs":[20],"code":"ICardinality merged = counters[0]","dfgs":[20],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":54,"lineEnd":54,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21],"code":"long sum = merged.cardinality()","dfgs":[26,22,27,23],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":55,"lineEnd":55,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":20},{"cfgs":[22,24],"code":"for (int i = 1; i < numSets; i++)","dfgs":[24],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":56,"lineEnd":56,"lineMapIndex":-1,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"sum += counters[i].cardinality()","dfgs":[26,23],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":57,"lineEnd":57,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":22},{"cfgs":[],"code":"merged = merged.merge(counters[i])","dfgs":[27],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":58,"lineEnd":58,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[25],"code":"long trueSize = numSets * setSize","dfgs":[25,28],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":61,"lineEnd":61,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[26],"code":"System.out.println(\"True Cardinality: \" + trueSize)","dfgs":[26],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":62,"lineEnd":62,"lineMapIndex":-1,"methodParents":[],"nodeIndex":25},{"cfgs":[27],"code":"System.out.println(\"Summed Cardinality: \" + sum)","dfgs":[27],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":63,"lineEnd":63,"lineMapIndex":-1,"methodParents":[],"nodeIndex":26},{"cfgs":[28],"code":"System.out.println(\"Merged Cardinality: \" + merged.cardinality())","dfgs":[28],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":64,"lineEnd":64,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":27},{"cfgs":[29],"code":"System.out.println(\"Merged Error: \" + (merged.cardinality() - trueSize) / (float)trueSize)","dfgs":[29],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":65,"lineEnd":65,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":28},{"cfgs":[],"code":"System.out.println(\"Duration: \" + ((System.currentTimeMillis() - startTime)/1000) + \"s\")","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":66,"lineEnd":66,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[],"code":"public void testSmallCardinalityRepeatedInsert() ","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":89,"lineEnd":89,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[32],"code":"HyperLogLogPlus hyperLogLogPlus = new HyperLogLogPlus(14, 25)","dfgs":[39,38],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":90,"lineEnd":90,"lineMapIndex":-1,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"int count = 15000","dfgs":[35],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":91,"lineEnd":91,"lineMapIndex":-1,"methodParents":[],"nodeIndex":32},{"cfgs":[34],"code":"int maxAttempts = 200","dfgs":[36],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":92,"lineEnd":92,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"Random r = new Random()","dfgs":[36],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":93,"lineEnd":93,"lineMapIndex":-1,"methodParents":[],"nodeIndex":34},{"cfgs":[36,39],"code":"for (int i = 0; i < count; i++)","dfgs":[40,38],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":94,"lineEnd":94,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[37],"code":"int n = r.nextInt(maxAttempts) + 1","dfgs":[37],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":96,"lineEnd":96,"lineMapIndex":-1,"methodParents":[],"nodeIndex":36},{"cfgs":[38],"code":"for (int j = 0; j < n ; j++)","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":97,"lineEnd":97,"lineMapIndex":-1,"methodParents":[],"nodeIndex":37},{"cfgs":[],"code":"hyperLogLogPlus.offer(\"i\" + i)","dfgs":[39],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":99,"lineEnd":99,"lineMapIndex":-1,"methodParents":[],"nodeIndex":38},{"cfgs":[40],"code":"long estimate = hyperLogLogPlus.cardinality()","dfgs":[42,43],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":102,"lineEnd":102,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":39},{"cfgs":[41],"code":"double se = count * (1.04 / Math.sqrt(Math.pow(2, 14)))","dfgs":[41,42],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":103,"lineEnd":103,"lineMapIndex":-1,"methodParents":[],"nodeIndex":40},{"cfgs":[42],"code":"long expectedCardinality = count","dfgs":[42],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":104,"lineEnd":104,"lineMapIndex":-1,"methodParents":[],"nodeIndex":41},{"cfgs":[43],"code":"System.out.println(\"Expect estimate: \" + estimate + \" is between \" + (expectedCardinality - (3 * se)) + \" and \" + (expectedCardinality + (3 * se)))","dfgs":[43],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":106,"lineEnd":106,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"assertTrue(estimate >= expectedCardinality - (3 * se))","dfgs":[44],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":108,"lineEnd":108,"lineMapIndex":-1,"methodParents":[],"nodeIndex":43},{"cfgs":[],"code":"assertTrue(estimate <= expectedCardinality + (3 * se))","dfgs":[],"fName":"src_test_java_com_clearspring_analytics_stream_cardinality_TestHyperLogLogPlus.java","fieldParents":[],"isDel":false,"lineBeg":109,"lineEnd":109,"lineMapIndex":-1,"methodParents":[],"nodeIndex":44}]