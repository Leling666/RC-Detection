[{"cfgs": [], "code": "import org.verdictdb.core.sqlobject.AbstractRelation", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 15, "lineEnd": 15, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.AliasedColumn", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 16, "lineEnd": 16, "lineMapIndex": 29, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.BaseColumn", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 17, "lineEnd": 17, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.BaseTable", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 18, "lineEnd": 18, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.ColumnOp", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 19, "lineEnd": 19, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.SelectItem", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 20, "lineEnd": 20, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.SelectQuery", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 21, "lineEnd": 21, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": ["e3b626906dc298789fd71aba41e214cd43c47cf9"]}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.SqlConvertible", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 22, "lineEnd": 22, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": ["11a27e9f18022942ec2415b8b2cd70942bf21d4a"]}, {"cfgs": [], "code": "measureItems.add(new AliasedColumn(ColumnOp.add(new BaseColumn(leftAliasName, a), new BaseColumn(rightAliasName, a)),a))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 92, "lineEnd": 94, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": ["0fdaa836eac9599803118e27839998c0a02255d6"]}, {"cfgs": [], "code": "if (!relation.isAggregateQuery())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_query_AggQueryRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 76, "lineEnd": 76, "lineMapIndex": 41, "methodParents": [12], "nodeIndex": 9, "rootcause": false, "commits": ["3c5189b1884d3b4507f3c45360d2e9e960befed0"]}, {"cfgs": [], "code": "return rewrittenOuter", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_query_AggQueryRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 785, "lineEnd": 785, "lineMapIndex": 42, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": ["0a521d296ae569c2dd474aa6796a2aa3e7ad07f4"]}, {"cfgs": [], "code": "if (this.getOpType().equals(\"avg\") ||this.getOpType().equals(\"sum\") ||this.getOpType().equals(\"count\"))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_sqlobject_ColumnOp.java", "fieldParents": [], "isDel": true, "lineBeg": 290, "lineEnd": 292, "lineMapIndex": 43, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": ["3c5189b1884d3b4507f3c45360d2e9e960befed0"]}, {"cfgs": [], "code": "public boolean isAggregateQuery() ", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_sqlobject_AbstractRelation.java", "fieldParents": [], "isDel": true, "lineBeg": 43, "lineEnd": 43, "lineMapIndex": 44, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": ["3c5189b1884d3b4507f3c45360d2e9e960befed0"]}, {"cfgs": [], "code": "if (!query.isAggregateQuery())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_QueryExecutionPlan.java", "fieldParents": [], "isDel": true, "lineBeg": 96, "lineEnd": 96, "lineMapIndex": 89, "methodParents": [12], "nodeIndex": 13, "rootcause": false, "commits": ["0d51c7548b2c609fd43457c730583c8b7eefe087"]}, {"cfgs": [], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 209, "lineEnd": 209, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [17, 18, 16], "code": "HashMap<String, ColumnOp> aggContents = new HashMap<>()", "dfgs": [16, 17, 18], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 344, "lineEnd": 344, "lineMapIndex": 103, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [17, 18], "code": "aggContents.put(((AliasedColumn) sel).getAliasName(), (ColumnOp) ((AliasedColumn) sel).getColumn())", "dfgs": [17, 18], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 348, "lineEnd": 348, "lineMapIndex": 104, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [18], "code": "ColumnOp aggContent = aggContents.get(aliasName)", "dfgs": [18], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 363, "lineEnd": 363, "lineMapIndex": 107, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [19], "code": "ColumnOp aggContentSum = aggContents.get(aliasNameSum)", "dfgs": [19], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 370, "lineEnd": 370, "lineMapIndex": 118, "methodParents": [], "nodeIndex": 18, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "ColumnOp aggContentCount = aggContents.get(aliasNameCount)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 372, "lineEnd": 372, "lineMapIndex": 119, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [21], "code": "String expected = \"select sum(vt5.\\\"value\\\") as \\\"agg0\\\", \"+ \"count(*) as \\\"agg1\\\" \"+ \"from \\\"originalSchema\\\".\\\"originalTable_scrambled\\\" as vt5 \"+ \"where vt5.\\\"verdictdbaggblock\\\" = 0\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": true, "lineBeg": 203, "lineEnd": 206, "lineMapIndex": 123, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": ["c6e6f0b4a5551a3a2325036209189a2c6f253236"]}, {"cfgs": [], "code": "expected = \"select (1 + ((2.0 * verdictdbbeforescaling.\\\"agg0\\\") / (2.0 * verdictdbbeforescaling.\\\"agg1\\\"))) * (2.0 * verdictdbbeforescaling.\\\"agg0\\\") as \\\"vc6\\\" from \\\"verdictdb_temp\\\".\\\"alias\\\" as verdictdbbeforescaling\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": true, "lineBeg": 225, "lineEnd": 225, "lineMapIndex": 124, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": ["a05e6757b690d5d31fa701b084868e4aa8fe5078"]}, {"cfgs": [], "code": "if (query.isAggregateQuery())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_SelectAllExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 36, "lineEnd": 36, "lineMapIndex": 235, "methodParents": [12], "nodeIndex": 22, "rootcause": false, "commits": ["8f1eb2df1b8866cc0889ab50a8c6e50480e53f7a"]}, {"cfgs": [25, 24], "code": "if (source.isAggregateQuery())", "dfgs": [25, 24], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": true, "lineBeg": 41, "lineEnd": 41, "lineMapIndex": 236, "methodParents": [12], "nodeIndex": 23, "rootcause": false, "commits": ["dee519556dd8ca14faeed0c615c9dcf513f5fee6"]}, {"cfgs": [25], "code": "if (s.isAggregateQuery())", "dfgs": [25], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": true, "lineBeg": 61, "lineEnd": 61, "lineMapIndex": 237, "methodParents": [12], "nodeIndex": 24, "rootcause": false, "commits": ["dee519556dd8ca14faeed0c615c9dcf513f5fee6"]}, {"cfgs": [], "code": "if (subquery.isAggregateQuery())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": true, "lineBeg": 101, "lineEnd": 101, "lineMapIndex": 238, "methodParents": [12], "nodeIndex": 25, "rootcause": false, "commits": ["ebd1be2d11532483b200d5d917074a8b754e60cb"]}, {"cfgs": [], "code": "if (((ColumnOp) s).getOpType().equals(\"count\") || ((ColumnOp) s).getOpType().equals(\"sum\") || ((ColumnOp) s).getOpType().equals(\"avg\"))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 311, "lineEnd": 311, "lineMapIndex": 240, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 349, "lineEnd": 349, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": ["c301e5457d09f239dcbc70e7e5f2a377fc68eb6a"]}, {"cfgs": [], "code": "import java.util.HashMap", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 5, "lineEnd": 5, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.verdictdb.core.sqlobject.*", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 16, "lineEnd": 16, "lineMapIndex": 1, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": []}, {"cfgs": [33, 31], "code": "HashMap<String, String> maxminAliasNames = new HashMap<>()", "dfgs": [33, 32], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 68, "lineEnd": 68, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": []}, {"cfgs": [32, 33], "code": "if (item instanceof AliasedColumn && ((AliasedColumn) item).getColumn() instanceof ColumnOp&& (((ColumnOp) ((AliasedColumn) item).getColumn()).getOpType().equals(\"max\")|| ((ColumnOp) ((AliasedColumn) item).getColumn()).getOpType().equals(\"min\")))", "dfgs": [33, 32], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 71, "lineEnd": 73, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": []}, {"cfgs": [33], "code": "maxminAliasNames.put(((AliasedColumn) item).getAliasName(), ((ColumnOp) ((AliasedColumn) item).getColumn()).getOpType())", "dfgs": [33], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 74, "lineEnd": 74, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": []}, {"cfgs": [34, 38], "code": "if (maxminAliasNames.keySet().contains(a))", "dfgs": [34, 35, 37], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 92, "lineEnd": 92, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": []}, {"cfgs": [35, 36], "code": "if (maxminAliasNames.get(a).equals(\"max\"))", "dfgs": [35, 37], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 93, "lineEnd": 93, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": []}, {"cfgs": [], "code": "measureItems.add(new AliasedColumn(new ColumnOp(\"whenthenelse\", Arrays.asList(new ColumnOp(\"greater\", Arrays.<UnnamedColumn>asList(new BaseColumn(leftAliasName, a), new BaseColumn(rightAliasName, a))),new BaseColumn(leftAliasName, a),new BaseColumn(rightAliasName, a))),a))", "dfgs": [37], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 94, "lineEnd": 100, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": []}, {"cfgs": [37], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 101, "lineEnd": 101, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": []}, {"cfgs": [], "code": "measureItems.add(new AliasedColumn(new ColumnOp(\"whenthenelse\", Arrays.asList(new ColumnOp(\"less\", Arrays.<UnnamedColumn>asList(new BaseColumn(leftAliasName, a), new BaseColumn(rightAliasName, a))),new BaseColumn(leftAliasName, a),new BaseColumn(rightAliasName, a))),a))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 102, "lineEnd": 108, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": []}, {"cfgs": [], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 111, "lineEnd": 111, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": []}, {"cfgs": [40], "code": "this.aggMeta.setAggColumnAggAliasPairOfMaxMin(aggMeta.getAggColumnAggAliasPairOfMaxMin())", "dfgs": [40], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 141, "lineEnd": 141, "lineMapIndex": -1, "methodParents": [98], "nodeIndex": 39, "rootcause": false, "commits": []}, {"cfgs": [], "code": "this.aggMeta.setMaxminAggAlias(aggMeta.getMaxminAggAlias())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggCombinerExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 142, "lineEnd": 142, "lineMapIndex": -1, "methodParents": [94], "nodeIndex": 40, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (!relation.isSupportedAggregate())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_query_AggQueryRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 76, "lineEnd": 76, "lineMapIndex": 9, "methodParents": [44], "nodeIndex": 41, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return rewrittenOuter", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_query_AggQueryRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 785, "lineEnd": 785, "lineMapIndex": 10, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (this.getOpType().equals(\"avg\") ||this.getOpType().equals(\"sum\") ||this.getOpType().equals(\"count\") ||this.getOpType().equals(\"max\") ||this.getOpType().equals(\"min\"))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_sqlobject_ColumnOp.java", "fieldParents": [], "isDel": false, "lineBeg": 290, "lineEnd": 294, "lineMapIndex": 11, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public boolean isSupportedAggregate() ", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_sqlobject_AbstractRelation.java", "fieldParents": [], "isDel": false, "lineBeg": 43, "lineEnd": 43, "lineMapIndex": 12, "methodParents": [], "nodeIndex": 44, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void maxAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 298, "lineEnd": 298, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 45, "rootcause": false, "commits": []}, {"cfgs": [47], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 299, "lineEnd": 299, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 46, "rootcause": false, "commits": []}, {"cfgs": [48], "code": "String sql = \"select max(value) from originalTable\"", "dfgs": [49], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 300, "lineEnd": 300, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 47, "rootcause": false, "commits": []}, {"cfgs": [49], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [49], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 301, "lineEnd": 301, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 48, "rootcause": false, "commits": []}, {"cfgs": [50], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [51], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 302, "lineEnd": 302, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 49, "rootcause": false, "commits": []}, {"cfgs": [51], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [51], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 303, "lineEnd": 303, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 50, "rootcause": false, "commits": []}, {"cfgs": [52], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [52], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 304, "lineEnd": 304, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 51, "rootcause": false, "commits": []}, {"cfgs": [53], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [53, 57], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 306, "lineEnd": 306, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 52, "rootcause": false, "commits": []}, {"cfgs": [54], "code": "queryExecutionPlan.cleanUp()", "dfgs": [54], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 307, "lineEnd": 307, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 53, "rootcause": false, "commits": []}, {"cfgs": [55], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [56], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 308, "lineEnd": 308, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 54, "rootcause": false, "commits": []}, {"cfgs": [56], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable\", 0, 0)", "dfgs": [56], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 309, "lineEnd": 309, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 55, "rootcause": false, "commits": []}, {"cfgs": [57], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [66, 65, 57], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 310, "lineEnd": 312, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 56, "rootcause": false, "commits": []}, {"cfgs": [58], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [59], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 313, "lineEnd": 313, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 57, "rootcause": false, "commits": []}, {"cfgs": [59], "code": "JdbcConnection jdbcConnection = new JdbcConnection(conn, new H2Syntax())", "dfgs": [59], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 316, "lineEnd": 316, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 58, "rootcause": false, "commits": []}, {"cfgs": [60], "code": "ExecutionResultReader reader = ExecutablePlanRunner.getResultReader(jdbcConnection, queryExecutionPlan)", "dfgs": [61], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 319, "lineEnd": 319, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 59, "rootcause": false, "commits": []}, {"cfgs": [61], "code": "int resultReturnedCnt = 0", "dfgs": [66, 64], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 320, "lineEnd": 320, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 60, "rootcause": false, "commits": []}, {"cfgs": [62, 66], "code": "while (reader.hasNext())", "dfgs": [62], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 321, "lineEnd": 321, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 61, "rootcause": false, "commits": []}, {"cfgs": [63], "code": "DbmsQueryResult dbmsQueryResult = reader.next()", "dfgs": [63], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 322, "lineEnd": 322, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 62, "rootcause": false, "commits": []}, {"cfgs": [64], "code": "dbmsQueryResult.next()", "dfgs": [65], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 323, "lineEnd": 323, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 63, "rootcause": false, "commits": []}, {"cfgs": [65], "code": "resultReturnedCnt++", "dfgs": [66], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 324, "lineEnd": 324, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 64, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(1.0, (double)dbmsQueryResult.getValue(0), 1e-6)", "dfgs": [66], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 325, "lineEnd": 325, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 65, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(5, resultReturnedCnt)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 327, "lineEnd": 327, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 66, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void minAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 331, "lineEnd": 331, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 67, "rootcause": false, "commits": []}, {"cfgs": [69], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 332, "lineEnd": 332, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 68, "rootcause": false, "commits": []}, {"cfgs": [70], "code": "String sql = \"select min(value) from originalTable\"", "dfgs": [71], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 333, "lineEnd": 333, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 69, "rootcause": false, "commits": []}, {"cfgs": [71], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [71], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 334, "lineEnd": 334, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 70, "rootcause": false, "commits": []}, {"cfgs": [72], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [73], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 335, "lineEnd": 335, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 71, "rootcause": false, "commits": []}, {"cfgs": [73], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [73], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 336, "lineEnd": 336, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 72, "rootcause": false, "commits": []}, {"cfgs": [74], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [74], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 337, "lineEnd": 337, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 73, "rootcause": false, "commits": []}, {"cfgs": [75], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [75, 79], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 339, "lineEnd": 339, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 74, "rootcause": false, "commits": []}, {"cfgs": [76], "code": "queryExecutionPlan.cleanUp()", "dfgs": [76], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 340, "lineEnd": 340, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 75, "rootcause": false, "commits": []}, {"cfgs": [77], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [78], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 341, "lineEnd": 341, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 76, "rootcause": false, "commits": []}, {"cfgs": [78], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable\", 0, 0)", "dfgs": [78], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 342, "lineEnd": 342, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 77, "rootcause": false, "commits": []}, {"cfgs": [79], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [88, 87, 79], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 343, "lineEnd": 345, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 78, "rootcause": false, "commits": []}, {"cfgs": [80], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [81], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 346, "lineEnd": 346, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 79, "rootcause": false, "commits": []}, {"cfgs": [81], "code": "JdbcConnection jdbcConnection = new JdbcConnection(conn, new H2Syntax())", "dfgs": [81], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 349, "lineEnd": 349, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 80, "rootcause": false, "commits": []}, {"cfgs": [82], "code": "ExecutionResultReader reader = ExecutablePlanRunner.getResultReader(jdbcConnection, queryExecutionPlan)", "dfgs": [83], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 352, "lineEnd": 352, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 81, "rootcause": false, "commits": []}, {"cfgs": [83], "code": "int resultReturnedCnt = 0", "dfgs": [88, 86], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 353, "lineEnd": 353, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 82, "rootcause": false, "commits": []}, {"cfgs": [84, 88], "code": "while (reader.hasNext())", "dfgs": [84], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 354, "lineEnd": 354, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 83, "rootcause": false, "commits": []}, {"cfgs": [85], "code": "DbmsQueryResult dbmsQueryResult = reader.next()", "dfgs": [85], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 355, "lineEnd": 355, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 84, "rootcause": false, "commits": []}, {"cfgs": [86], "code": "dbmsQueryResult.next()", "dfgs": [87], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 356, "lineEnd": 356, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 85, "rootcause": false, "commits": []}, {"cfgs": [87], "code": "resultReturnedCnt++", "dfgs": [88], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 357, "lineEnd": 357, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 86, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(1.0, (double)dbmsQueryResult.getValue(0), 1e-6)", "dfgs": [88], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 358, "lineEnd": 358, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 87, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(5, resultReturnedCnt)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultMultiTierTest.java", "fieldParents": [], "isDel": false, "lineBeg": 360, "lineEnd": 360, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 88, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (!query.isSupportedAggregate())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_QueryExecutionPlan.java", "fieldParents": [], "isDel": false, "lineBeg": 96, "lineEnd": 96, "lineMapIndex": 13, "methodParents": [44], "nodeIndex": 89, "rootcause": false, "commits": []}, {"cfgs": [91], "code": "HashMap<String, String> maxminAggAlias = new HashMap<>()", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 27, "lineEnd": 27, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 90, "rootcause": false, "commits": []}, {"cfgs": [], "code": "HashMap<Pair<String, UnnamedColumn>, String> aggColumnAggAliasPairOfMaxMin = new HashMap<>()", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 33, "lineEnd": 33, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 91, "rootcause": false, "commits": []}, {"cfgs": [93], "code": "public HashMap<String, String> getMaxminAggAlias() ", "dfgs": [93], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 61, "lineEnd": 61, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 92, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return maxminAggAlias", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [90], "isDel": false, "lineBeg": 62, "lineEnd": 62, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 93, "rootcause": false, "commits": []}, {"cfgs": [95], "code": "public void setMaxminAggAlias(HashMap<String, String> maxminAggAlias) ", "dfgs": [95], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 65, "lineEnd": 65, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 94, "rootcause": false, "commits": []}, {"cfgs": [], "code": "this.maxminAggAlias = maxminAggAlias", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [90], "isDel": false, "lineBeg": 66, "lineEnd": 66, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 95, "rootcause": false, "commits": []}, {"cfgs": [97], "code": "public HashMap<Pair<String, UnnamedColumn>, String> getAggColumnAggAliasPairOfMaxMin() ", "dfgs": [97], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 77, "lineEnd": 77, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 96, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return aggColumnAggAliasPairOfMaxMin", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [91], "isDel": false, "lineBeg": 78, "lineEnd": 78, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 97, "rootcause": false, "commits": []}, {"cfgs": [99], "code": "public void setAggColumnAggAliasPairOfMaxMin(HashMap<Pair<String, UnnamedColumn>, String> aggColumnAggAliasPairOfMaxMin) ", "dfgs": [99], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [], "isDel": false, "lineBeg": 89, "lineEnd": 89, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 98, "rootcause": false, "commits": []}, {"cfgs": [], "code": "this.aggColumnAggAliasPairOfMaxMin = aggColumnAggAliasPairOfMaxMin", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggMeta.java", "fieldParents": [91], "isDel": false, "lineBeg": 90, "lineEnd": 90, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 99, "rootcause": false, "commits": []}, {"cfgs": [101, 102], "code": "if (aggMeta.getMaxminAggAlias().keySet().contains(((AliasedColumn) selectItem).getAliasName()))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 210, "lineEnd": 210, "lineMapIndex": -1, "methodParents": [92], "nodeIndex": 100, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newSelectList.set(index, new AliasedColumn(new BaseColumn(\"verdictdbbeforescaling\", ((AliasedColumn) selectItem).getAliasName()),((AliasedColumn) selectItem).getAliasName()))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 211, "lineEnd": 212, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 101, "rootcause": false, "commits": []}, {"cfgs": [], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 214, "lineEnd": 214, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 102, "rootcause": false, "commits": []}, {"cfgs": [107, 108, 104, 105], "code": "HashMap<String, UnnamedColumn> aggContents = new HashMap<>()", "dfgs": [104, 106, 107, 110, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 349, "lineEnd": 349, "lineMapIndex": 15, "methodParents": [], "nodeIndex": 103, "rootcause": false, "commits": []}, {"cfgs": [107, 108, 105], "code": "aggContents.put(((AliasedColumn) sel).getAliasName(), ((AliasedColumn) sel).getColumn())", "dfgs": [106, 107, 110, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 353, "lineEnd": 353, "lineMapIndex": 16, "methodParents": [], "nodeIndex": 104, "rootcause": false, "commits": []}, {"cfgs": [107, 108, 106], "code": "if (sel instanceof AliasedColumn && aggMeta.getMaxminAggAlias().keySet().contains(((AliasedColumn) sel).getAliasName()))", "dfgs": [107, 109, 113, 118, 119, 106], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 355, "lineEnd": 355, "lineMapIndex": -1, "methodParents": [92], "nodeIndex": 105, "rootcause": false, "commits": []}, {"cfgs": [107, 108], "code": "aggContents.put(((AliasedColumn) sel).getAliasName(), ((AliasedColumn) sel).getColumn())", "dfgs": [107, 110, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 356, "lineEnd": 356, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 106, "rootcause": false, "commits": []}, {"cfgs": [108], "code": "ColumnOp aggContent = (ColumnOp) aggContents.get(aliasName)", "dfgs": [110, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 371, "lineEnd": 371, "lineMapIndex": 17, "methodParents": [], "nodeIndex": 107, "rootcause": false, "commits": []}, {"cfgs": [109, 118], "code": "if (col.getOpType().equals(\"max\") || col.getOpType().equals(\"min\"))", "dfgs": [113, 118, 109, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 375, "lineEnd": 375, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 108, "rootcause": false, "commits": []}, {"cfgs": [110], "code": "String aliasName = aggMeta.getAggColumnAggAliasPairOfMaxMin().get(new ImmutablePair<>(col.getOpType(), col.getOperand(0)))", "dfgs": [113, 118, 119, 110, 112, 116], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 376, "lineEnd": 376, "lineMapIndex": -1, "methodParents": [96], "nodeIndex": 109, "rootcause": false, "commits": []}, {"cfgs": [111, 114], "code": "if (aggContents.get(aliasName) instanceof BaseColumn)", "dfgs": [111, 115], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 377, "lineEnd": 377, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 110, "rootcause": false, "commits": []}, {"cfgs": [112], "code": "BaseColumn aggContent = (BaseColumn) aggContents.get(aliasName)", "dfgs": [113, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 378, "lineEnd": 378, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 111, "rootcause": false, "commits": []}, {"cfgs": [113], "code": "col.setOpType(\"multiply\")", "dfgs": [113], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 379, "lineEnd": 379, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 112, "rootcause": false, "commits": []}, {"cfgs": [], "code": "col.setOperand(Arrays.asList(ConstantColumn.valueOf(1), aggContent))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 380, "lineEnd": 380, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 113, "rootcause": false, "commits": []}, {"cfgs": [115], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 381, "lineEnd": 381, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 114, "rootcause": false, "commits": []}, {"cfgs": [116], "code": "ColumnOp aggContent = (ColumnOp) aggContents.get(aliasName)", "dfgs": [116, 118], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 382, "lineEnd": 382, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 115, "rootcause": false, "commits": []}, {"cfgs": [117], "code": "col.setOpType(aggContent.getOpType())", "dfgs": [117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 383, "lineEnd": 383, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 116, "rootcause": false, "commits": []}, {"cfgs": [], "code": "col.setOperand(aggContent.getOperands())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 384, "lineEnd": 384, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 117, "rootcause": false, "commits": []}, {"cfgs": [119], "code": "ColumnOp aggContentSum = (ColumnOp) aggContents.get(aliasNameSum)", "dfgs": [119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 390, "lineEnd": 390, "lineMapIndex": 18, "methodParents": [], "nodeIndex": 118, "rootcause": false, "commits": []}, {"cfgs": [], "code": "ColumnOp aggContentCount = (ColumnOp) aggContents.get(aliasNameCount)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 392, "lineEnd": 392, "lineMapIndex": 19, "methodParents": [], "nodeIndex": 119, "rootcause": false, "commits": []}, {"cfgs": [121], "code": "if (aggMeta.getMaxminAggAlias().keySet().contains(((AliasedColumn) sel).getAliasName()))", "dfgs": [121], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 425, "lineEnd": 425, "lineMapIndex": -1, "methodParents": [92], "nodeIndex": 120, "rootcause": false, "commits": []}, {"cfgs": [122], "code": "String opType = aggMeta.getMaxminAggAlias().get(((AliasedColumn) sel).getAliasName())", "dfgs": [122], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 426, "lineEnd": 426, "lineMapIndex": -1, "methodParents": [92], "nodeIndex": 121, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newSelectlist.add(new AliasedColumn(new ColumnOp(opType,new BaseColumn(\"verdictdbafterscaling\", ((AliasedColumn) sel).getAliasName())), ((AliasedColumn) sel).getAliasName()))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 427, "lineEnd": 428, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 122, "rootcause": false, "commits": []}, {"cfgs": [124], "code": "String expected = \"select sum(vt3.\\\"value\\\") as \\\"agg0\\\", \"+ \"count(*) as \\\"agg1\\\" \"+ \"from \\\"originalSchema\\\".\\\"originalTable_scrambled\\\" as vt3 \"+ \"where vt3.\\\"verdictdbaggblock\\\" = 0\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 203, "lineEnd": 206, "lineMapIndex": 20, "methodParents": [], "nodeIndex": 123, "rootcause": false, "commits": []}, {"cfgs": [], "code": "expected = \"select (1 + ((2.0 * verdictdbbeforescaling.\\\"agg0\\\") / (2.0 * verdictdbbeforescaling.\\\"agg1\\\"))) * (2.0 * verdictdbbeforescaling.\\\"agg0\\\") as \\\"vc4\\\" from \\\"verdictdb_temp\\\".\\\"alias\\\" as verdictdbbeforescaling\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 225, "lineEnd": 225, "lineMapIndex": 21, "methodParents": [], "nodeIndex": 124, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void maxAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 368, "lineEnd": 368, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 125, "rootcause": false, "commits": []}, {"cfgs": [127], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 369, "lineEnd": 369, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 126, "rootcause": false, "commits": []}, {"cfgs": [128], "code": "String sql = \"select (1+max(value))*avg(value) from originalTable_scrambled\"", "dfgs": [129], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 370, "lineEnd": 370, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 127, "rootcause": false, "commits": []}, {"cfgs": [129], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [129], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 371, "lineEnd": 371, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 128, "rootcause": false, "commits": []}, {"cfgs": [130], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [131], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 372, "lineEnd": 372, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 129, "rootcause": false, "commits": []}, {"cfgs": [131], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [131], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 373, "lineEnd": 373, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 130, "rootcause": false, "commits": []}, {"cfgs": [132], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [132], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 374, "lineEnd": 374, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 131, "rootcause": false, "commits": []}, {"cfgs": [133], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [133, 137], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 376, "lineEnd": 376, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 132, "rootcause": false, "commits": []}, {"cfgs": [134], "code": "queryExecutionPlan.cleanUp()", "dfgs": [134], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 377, "lineEnd": 377, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 133, "rootcause": false, "commits": []}, {"cfgs": [135], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [136], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 378, "lineEnd": 378, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 134, "rootcause": false, "commits": []}, {"cfgs": [136], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable_scrambled\", 0, 0)", "dfgs": [136], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 379, "lineEnd": 379, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 135, "rootcause": false, "commits": []}, {"cfgs": [137], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [137], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 380, "lineEnd": 382, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 136, "rootcause": false, "commits": []}, {"cfgs": [138], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [139], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 383, "lineEnd": 383, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 137, "rootcause": false, "commits": []}, {"cfgs": [139], "code": "stmt.execute(\"create schema if not exists \\\"verdictdb_temp\\\";\")", "dfgs": [140], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 385, "lineEnd": 385, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 138, "rootcause": false, "commits": []}, {"cfgs": [140], "code": "ExecutablePlanRunner.runTillEnd(new JdbcConnection(conn, new H2Syntax()), queryExecutionPlan)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 386, "lineEnd": 386, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 139, "rootcause": false, "commits": []}, {"cfgs": [], "code": "stmt.execute(\"drop schema \\\"verdictdb_temp\\\" cascade;\")", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 387, "lineEnd": 387, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 140, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void minAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 391, "lineEnd": 391, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 141, "rootcause": false, "commits": []}, {"cfgs": [143], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 392, "lineEnd": 392, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 142, "rootcause": false, "commits": []}, {"cfgs": [144], "code": "String sql = \"select (1+min(value))*avg(value) from originalTable_scrambled\"", "dfgs": [145], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 393, "lineEnd": 393, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 143, "rootcause": false, "commits": []}, {"cfgs": [145], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [145], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 394, "lineEnd": 394, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 144, "rootcause": false, "commits": []}, {"cfgs": [146], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [147], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 395, "lineEnd": 395, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 145, "rootcause": false, "commits": []}, {"cfgs": [147], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [147], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 396, "lineEnd": 396, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 146, "rootcause": false, "commits": []}, {"cfgs": [148], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [148], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 397, "lineEnd": 397, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 147, "rootcause": false, "commits": []}, {"cfgs": [149], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [149, 153], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 399, "lineEnd": 399, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 148, "rootcause": false, "commits": []}, {"cfgs": [150], "code": "queryExecutionPlan.cleanUp()", "dfgs": [150], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 400, "lineEnd": 400, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 149, "rootcause": false, "commits": []}, {"cfgs": [151], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [152], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 401, "lineEnd": 401, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 150, "rootcause": false, "commits": []}, {"cfgs": [152], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable_scrambled\", 0, 0)", "dfgs": [152], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 402, "lineEnd": 402, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 151, "rootcause": false, "commits": []}, {"cfgs": [153], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [153], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 403, "lineEnd": 405, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 152, "rootcause": false, "commits": []}, {"cfgs": [154], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [155], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 406, "lineEnd": 406, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 153, "rootcause": false, "commits": []}, {"cfgs": [155], "code": "stmt.execute(\"create schema if not exists \\\"verdictdb_temp\\\";\")", "dfgs": [156], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 408, "lineEnd": 408, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 154, "rootcause": false, "commits": []}, {"cfgs": [156], "code": "ExecutablePlanRunner.runTillEnd(new JdbcConnection(conn, new H2Syntax()), queryExecutionPlan)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 409, "lineEnd": 409, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 155, "rootcause": false, "commits": []}, {"cfgs": [], "code": "stmt.execute(\"drop schema \\\"verdictdb_temp\\\" cascade;\")", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 410, "lineEnd": 410, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 156, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void maxAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 639, "lineEnd": 639, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 157, "rootcause": false, "commits": []}, {"cfgs": [159], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 640, "lineEnd": 640, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 158, "rootcause": false, "commits": []}, {"cfgs": [160], "code": "String sql = \"select (1+max(value))*avg(value) from originalTable_scrambled\"", "dfgs": [161], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 641, "lineEnd": 641, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 159, "rootcause": false, "commits": []}, {"cfgs": [161], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [161], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 642, "lineEnd": 642, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 160, "rootcause": false, "commits": []}, {"cfgs": [162], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [163], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 643, "lineEnd": 643, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 161, "rootcause": false, "commits": []}, {"cfgs": [163], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [163], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 644, "lineEnd": 644, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 162, "rootcause": false, "commits": []}, {"cfgs": [164], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [164], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 645, "lineEnd": 645, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 163, "rootcause": false, "commits": []}, {"cfgs": [165], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [165, 169], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 647, "lineEnd": 647, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 164, "rootcause": false, "commits": []}, {"cfgs": [166], "code": "queryExecutionPlan.cleanUp()", "dfgs": [166], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 648, "lineEnd": 648, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 165, "rootcause": false, "commits": []}, {"cfgs": [167], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [168], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 649, "lineEnd": 649, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 166, "rootcause": false, "commits": []}, {"cfgs": [168], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable_scrambled\", 0, 0)", "dfgs": [168], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 650, "lineEnd": 650, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 167, "rootcause": false, "commits": []}, {"cfgs": [169], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [178, 174, 169], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 651, "lineEnd": 653, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 168, "rootcause": false, "commits": []}, {"cfgs": [170], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [171], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 654, "lineEnd": 654, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 169, "rootcause": false, "commits": []}, {"cfgs": [171], "code": "stmt.execute(\"create schema if not exists \\\"verdictdb_temp\\\";\")", "dfgs": [172], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 656, "lineEnd": 656, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 170, "rootcause": false, "commits": []}, {"cfgs": [172], "code": "ExecutablePlanRunner.runTillEnd(new JdbcConnection(conn, new H2Syntax()), queryExecutionPlan)", "dfgs": [174], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 657, "lineEnd": 657, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 171, "rootcause": false, "commits": []}, {"cfgs": [173], "code": "stmt.execute(\"drop schema \\\"verdictdb_temp\\\" cascade;\")", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 658, "lineEnd": 658, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 172, "rootcause": false, "commits": []}, {"cfgs": [174], "code": "ExecutionInfoToken token = new ExecutionInfoToken()", "dfgs": [174], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 660, "lineEnd": 660, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 173, "rootcause": false, "commits": []}, {"cfgs": [175], "code": "CreateTableAsSelectQuery query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).getSources().get(0).createQuery(Arrays.asList(token))", "dfgs": [176, 185], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 661, "lineEnd": 661, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 174, "rootcause": false, "commits": []}, {"cfgs": [176], "code": "SelectQueryToSql queryToSql = new SelectQueryToSql(new H2Syntax())", "dfgs": [176], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 662, "lineEnd": 662, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 175, "rootcause": false, "commits": []}, {"cfgs": [177], "code": "String actual = queryToSql.toSql(query.getSelect())", "dfgs": [178, 186], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 663, "lineEnd": 663, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 176, "rootcause": false, "commits": []}, {"cfgs": [178], "code": "String expected = \"select \" +\"sum(vt1.\\\"value\\\") as \\\"agg0\\\", \" +\"count(*) as \\\"agg1\\\", \" +\"max(vt1.\\\"value\\\") as \\\"agg2\\\", \" +\"vt1.\\\"verdictdbtier\\\" as \\\"verdictdbtier0\\\" \" +\"from \\\"originalSchema\\\".\\\"originalTable_scrambled\\\" as vt1 \" +\"where vt1.\\\"verdictdbaggblock\\\" = 0 group by \\\"verdictdbtier0\\\"\"", "dfgs": [178], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 664, "lineEnd": 670, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 177, "rootcause": false, "commits": []}, {"cfgs": [179], "code": "assertEquals(expected, actual)", "dfgs": [189], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 671, "lineEnd": 671, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 178, "rootcause": false, "commits": []}, {"cfgs": [180], "code": "ExecutionInfoToken token1 = new ExecutionInfoToken()", "dfgs": [180], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 673, "lineEnd": 673, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 179, "rootcause": false, "commits": []}, {"cfgs": [181], "code": "token1.setKeyValue(\"schemaName\", \"verdict_temp\")", "dfgs": [181], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 674, "lineEnd": 674, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 180, "rootcause": false, "commits": []}, {"cfgs": [182], "code": "token1.setKeyValue(\"tableName\", \"table1\")", "dfgs": [185], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 675, "lineEnd": 675, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 181, "rootcause": false, "commits": []}, {"cfgs": [183], "code": "ExecutionInfoToken token2 = new ExecutionInfoToken()", "dfgs": [183], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 676, "lineEnd": 676, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 182, "rootcause": false, "commits": []}, {"cfgs": [184], "code": "token2.setKeyValue(\"schemaName\", \"verdict_temp\")", "dfgs": [184], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 677, "lineEnd": 677, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 183, "rootcause": false, "commits": []}, {"cfgs": [185], "code": "token2.setKeyValue(\"tableName\", \"table2\")", "dfgs": [185], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 678, "lineEnd": 678, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 184, "rootcause": false, "commits": []}, {"cfgs": [186], "code": "query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).getSources().get(1).createQuery(Arrays.asList(token1, token2))", "dfgs": [186, 191, 190], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 679, "lineEnd": 679, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 185, "rootcause": false, "commits": []}, {"cfgs": [187], "code": "actual = queryToSql.toSql(query.getSelect())", "dfgs": [187, 192], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 680, "lineEnd": 680, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 186, "rootcause": false, "commits": []}, {"cfgs": [188], "code": "actual = actual.replaceAll(\"verdictdbalias_[0-9]*_[0-9]\", \"alias\")", "dfgs": [189], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 681, "lineEnd": 681, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 187, "rootcause": false, "commits": []}, {"cfgs": [189], "code": "expected = \"select \" +\"alias.\\\"verdictdbtier0\\\" as \\\"verdictdbtier0\\\", \" +\"alias.\\\"agg0\\\" + alias.\\\"agg0\\\" as \\\"agg0\\\", \" +\"alias.\\\"agg1\\\" + alias.\\\"agg1\\\" as \\\"agg1\\\", \" +\"case when (alias.\\\"agg2\\\" > alias.\\\"agg2\\\") then alias.\\\"agg2\\\" \" +\"else alias.\\\"agg2\\\" end as \\\"agg2\\\" \" +\"from \\\"verdict_temp\\\".\\\"table1\\\" as alias, \" +\"\\\"verdict_temp\\\".\\\"table2\\\" as alias \" +\"where alias.\\\"verdictdbtier0\\\" = alias.\\\"verdictdbtier0\\\"\"", "dfgs": [189], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 682, "lineEnd": 690, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 188, "rootcause": false, "commits": []}, {"cfgs": [190], "code": "assertEquals(expected, actual)", "dfgs": [195], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 691, "lineEnd": 691, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 189, "rootcause": false, "commits": []}, {"cfgs": [191], "code": "ExecutionInfoToken token3 = queryExecutionPlan.getRoot().getSources().get(0).getSources().get(0).createToken(null)", "dfgs": [191], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 693, "lineEnd": 693, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 190, "rootcause": false, "commits": []}, {"cfgs": [192], "code": "query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).createQuery(Arrays.asList(token3))", "dfgs": [192], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 694, "lineEnd": 694, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 191, "rootcause": false, "commits": []}, {"cfgs": [193], "code": "actual = queryToSql.toSql(query.getSelect())", "dfgs": [193], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 695, "lineEnd": 695, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 192, "rootcause": false, "commits": []}, {"cfgs": [194], "code": "actual = actual.replaceAll(\"verdictdbtemptable_[0-9]*_[0-9]\", \"alias\")", "dfgs": [195], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 696, "lineEnd": 696, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 193, "rootcause": false, "commits": []}, {"cfgs": [195], "code": "expected = \"select \" +\"verdictdbbeforescaling.\\\"vc2\\\" as \\\"vc2\\\" \" +\"from (\" +\"select \" +\"case \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 1) then (5.0 * verdictdbbeforescaling.\\\"agg0\\\") \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 0) then (2.0 * verdictdbbeforescaling.\\\"agg0\\\") \" +\"else 0 end as \\\"agg0\\\", \" +\"case \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 1) then (5.0 * verdictdbbeforescaling.\\\"agg1\\\") \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 0) then (2.0 * verdictdbbeforescaling.\\\"agg1\\\") \" +\"else 0 end as \\\"agg1\\\", \" +\"verdictdbbeforescaling.\\\"agg2\\\" as \\\"agg2\\\", \" +\"verdictdbbeforescaling.\\\"verdictdbtier0\\\" as \\\"verdictdbtier0\\\" \" +\"from \\\"verdictdb_temp\\\".\\\"alias\\\" as verdictdbbeforescaling) \" +\"as verdictdbafterscaling\"", "dfgs": [195], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 697, "lineEnd": 712, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 194, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(actual, expected)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 713, "lineEnd": 713, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 195, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void minAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 717, "lineEnd": 717, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 196, "rootcause": false, "commits": []}, {"cfgs": [198], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 718, "lineEnd": 718, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 197, "rootcause": false, "commits": []}, {"cfgs": [199], "code": "String sql = \"select (1+min(value))*avg(value) from originalTable_scrambled\"", "dfgs": [200], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 719, "lineEnd": 719, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 198, "rootcause": false, "commits": []}, {"cfgs": [200], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [200], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 720, "lineEnd": 720, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 199, "rootcause": false, "commits": []}, {"cfgs": [201], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [202], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 721, "lineEnd": 721, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 200, "rootcause": false, "commits": []}, {"cfgs": [202], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [202], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 722, "lineEnd": 722, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 201, "rootcause": false, "commits": []}, {"cfgs": [203], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [203], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 723, "lineEnd": 723, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 202, "rootcause": false, "commits": []}, {"cfgs": [204], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [204, 208], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 725, "lineEnd": 725, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 203, "rootcause": false, "commits": []}, {"cfgs": [205], "code": "queryExecutionPlan.cleanUp()", "dfgs": [205], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 726, "lineEnd": 726, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 204, "rootcause": false, "commits": []}, {"cfgs": [206], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [207], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 727, "lineEnd": 727, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 205, "rootcause": false, "commits": []}, {"cfgs": [207], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable_scrambled\", 0, 0)", "dfgs": [207], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 728, "lineEnd": 728, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 206, "rootcause": false, "commits": []}, {"cfgs": [208], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [217, 213, 208], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 729, "lineEnd": 731, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 207, "rootcause": false, "commits": []}, {"cfgs": [209], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [210], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 732, "lineEnd": 732, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 208, "rootcause": false, "commits": []}, {"cfgs": [210], "code": "stmt.execute(\"create schema if not exists \\\"verdictdb_temp\\\";\")", "dfgs": [211], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 734, "lineEnd": 734, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 209, "rootcause": false, "commits": []}, {"cfgs": [211], "code": "ExecutablePlanRunner.runTillEnd(new JdbcConnection(conn, new H2Syntax()), queryExecutionPlan)", "dfgs": [213], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 735, "lineEnd": 735, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 210, "rootcause": false, "commits": []}, {"cfgs": [212], "code": "stmt.execute(\"drop schema \\\"verdictdb_temp\\\" cascade;\")", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 736, "lineEnd": 736, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 211, "rootcause": false, "commits": []}, {"cfgs": [213], "code": "ExecutionInfoToken token = new ExecutionInfoToken()", "dfgs": [213], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 738, "lineEnd": 738, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 212, "rootcause": false, "commits": []}, {"cfgs": [214], "code": "CreateTableAsSelectQuery query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).getSources().get(0).createQuery(Arrays.asList(token))", "dfgs": [215, 224], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 739, "lineEnd": 739, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 213, "rootcause": false, "commits": []}, {"cfgs": [215], "code": "SelectQueryToSql queryToSql = new SelectQueryToSql(new H2Syntax())", "dfgs": [215], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 740, "lineEnd": 740, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 214, "rootcause": false, "commits": []}, {"cfgs": [216], "code": "String actual = queryToSql.toSql(query.getSelect())", "dfgs": [217, 225], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 741, "lineEnd": 741, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 215, "rootcause": false, "commits": []}, {"cfgs": [217], "code": "String expected = \"select \" +\"sum(vt1.\\\"value\\\") as \\\"agg0\\\", \" +\"count(*) as \\\"agg1\\\", \" +\"min(vt1.\\\"value\\\") as \\\"agg2\\\", \" +\"vt1.\\\"verdictdbtier\\\" as \\\"verdictdbtier0\\\" \" +\"from \\\"originalSchema\\\".\\\"originalTable_scrambled\\\" as vt1 \" +\"where vt1.\\\"verdictdbaggblock\\\" = 0 group by \\\"verdictdbtier0\\\"\"", "dfgs": [217], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 742, "lineEnd": 748, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 216, "rootcause": false, "commits": []}, {"cfgs": [218], "code": "assertEquals(expected, actual)", "dfgs": [228], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 749, "lineEnd": 749, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 217, "rootcause": false, "commits": []}, {"cfgs": [219], "code": "ExecutionInfoToken token1 = new ExecutionInfoToken()", "dfgs": [219], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 751, "lineEnd": 751, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 218, "rootcause": false, "commits": []}, {"cfgs": [220], "code": "token1.setKeyValue(\"schemaName\", \"verdict_temp\")", "dfgs": [220], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 752, "lineEnd": 752, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 219, "rootcause": false, "commits": []}, {"cfgs": [221], "code": "token1.setKeyValue(\"tableName\", \"table1\")", "dfgs": [224], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 753, "lineEnd": 753, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 220, "rootcause": false, "commits": []}, {"cfgs": [222], "code": "ExecutionInfoToken token2 = new ExecutionInfoToken()", "dfgs": [222], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 754, "lineEnd": 754, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 221, "rootcause": false, "commits": []}, {"cfgs": [223], "code": "token2.setKeyValue(\"schemaName\", \"verdict_temp\")", "dfgs": [223], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 755, "lineEnd": 755, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 222, "rootcause": false, "commits": []}, {"cfgs": [224], "code": "token2.setKeyValue(\"tableName\", \"table2\")", "dfgs": [224], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 756, "lineEnd": 756, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 223, "rootcause": false, "commits": []}, {"cfgs": [225], "code": "query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).getSources().get(1).createQuery(Arrays.asList(token1, token2))", "dfgs": [225, 230, 229], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 757, "lineEnd": 757, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 224, "rootcause": false, "commits": []}, {"cfgs": [226], "code": "actual = queryToSql.toSql(query.getSelect())", "dfgs": [226, 231], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 758, "lineEnd": 758, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 225, "rootcause": false, "commits": []}, {"cfgs": [227], "code": "actual = actual.replaceAll(\"verdictdbalias_[0-9]*_[0-9]\", \"alias\")", "dfgs": [228], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 759, "lineEnd": 759, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 226, "rootcause": false, "commits": []}, {"cfgs": [228], "code": "expected = \"select \" +\"alias.\\\"verdictdbtier0\\\" as \\\"verdictdbtier0\\\", \" +\"alias.\\\"agg0\\\" + alias.\\\"agg0\\\" as \\\"agg0\\\", \" +\"alias.\\\"agg1\\\" + alias.\\\"agg1\\\" as \\\"agg1\\\", \" +\"case when (alias.\\\"agg2\\\" < alias.\\\"agg2\\\") then alias.\\\"agg2\\\" \" +\"else alias.\\\"agg2\\\" end as \\\"agg2\\\" \" +\"from \\\"verdict_temp\\\".\\\"table1\\\" as alias, \" +\"\\\"verdict_temp\\\".\\\"table2\\\" as alias \" +\"where alias.\\\"verdictdbtier0\\\" = alias.\\\"verdictdbtier0\\\"\"", "dfgs": [228], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 760, "lineEnd": 768, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 227, "rootcause": false, "commits": []}, {"cfgs": [229], "code": "assertEquals(expected, actual)", "dfgs": [234], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 769, "lineEnd": 769, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 228, "rootcause": false, "commits": []}, {"cfgs": [230], "code": "ExecutionInfoToken token3 = queryExecutionPlan.getRoot().getSources().get(0).getSources().get(0).createToken(null)", "dfgs": [230], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 771, "lineEnd": 771, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 229, "rootcause": false, "commits": []}, {"cfgs": [231], "code": "query = (CreateTableAsSelectQuery) queryExecutionPlan.getRoot().getSources().get(0).createQuery(Arrays.asList(token3))", "dfgs": [231], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 772, "lineEnd": 772, "lineMapIndex": -1, "methodParents": [39], "nodeIndex": 230, "rootcause": false, "commits": []}, {"cfgs": [232], "code": "actual = queryToSql.toSql(query.getSelect())", "dfgs": [232], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 773, "lineEnd": 773, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 231, "rootcause": false, "commits": []}, {"cfgs": [233], "code": "actual = actual.replaceAll(\"verdictdbtemptable_[0-9]*_[0-9]\", \"alias\")", "dfgs": [234], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 774, "lineEnd": 774, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 232, "rootcause": false, "commits": []}, {"cfgs": [234], "code": "expected = \"select \" +\"verdictdbbeforescaling.\\\"vc2\\\" as \\\"vc2\\\" \" +\"from (\" +\"select \" +\"case \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 1) then (5.0 * verdictdbbeforescaling.\\\"agg0\\\") \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 0) then (2.0 * verdictdbbeforescaling.\\\"agg0\\\") \" +\"else 0 end as \\\"agg0\\\", \" +\"case \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 1) then (5.0 * verdictdbbeforescaling.\\\"agg1\\\") \" +\"when (verdictdbbeforescaling.\\\"verdictdbtier0\\\" = 0) then (2.0 * verdictdbbeforescaling.\\\"agg1\\\") \" +\"else 0 end as \\\"agg1\\\", \" +\"verdictdbbeforescaling.\\\"agg2\\\" as \\\"agg2\\\", \" +\"verdictdbbeforescaling.\\\"verdictdbtier0\\\" as \\\"verdictdbtier0\\\" \" +\"from \\\"verdictdb_temp\\\".\\\"alias\\\" as verdictdbbeforescaling) \" +\"as verdictdbafterscaling\"", "dfgs": [234], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 775, "lineEnd": 790, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 233, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(actual, expected)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 791, "lineEnd": 791, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 234, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (query.isSupportedAggregate())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_SelectAllExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 36, "lineEnd": 36, "lineMapIndex": 22, "methodParents": [44], "nodeIndex": 235, "rootcause": false, "commits": []}, {"cfgs": [238, 237], "code": "if (source.isSupportedAggregate())", "dfgs": [238, 237], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": false, "lineBeg": 41, "lineEnd": 41, "lineMapIndex": 23, "methodParents": [44], "nodeIndex": 236, "rootcause": false, "commits": []}, {"cfgs": [238], "code": "if (s.isSupportedAggregate())", "dfgs": [238], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": false, "lineBeg": 61, "lineEnd": 61, "lineMapIndex": 24, "methodParents": [44], "nodeIndex": 237, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (subquery.isSupportedAggregate())", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_SubqueriesToDependentNodes.java", "fieldParents": [], "isDel": false, "lineBeg": 101, "lineEnd": 101, "lineMapIndex": 25, "methodParents": [44], "nodeIndex": 238, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.HashMap", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 5, "lineEnd": 5, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 239, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if (((ColumnOp) s).getOpType().equals(\"count\") || ((ColumnOp) s).getOpType().equals(\"sum\") || ((ColumnOp) s).getOpType().equals(\"avg\")||((ColumnOp) s).getOpType().equals(\"max\")||((ColumnOp) s).getOpType().equals(\"min\"))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 312, "lineEnd": 313, "lineMapIndex": 26, "methodParents": [], "nodeIndex": 240, "rootcause": false, "commits": []}, {"cfgs": [248, 242], "code": "HashMap<String, String> maxminAlias = new HashMap<>()", "dfgs": [248, 247], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 325, "lineEnd": 325, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 241, "rootcause": false, "commits": []}, {"cfgs": [248, 243], "code": "if (col.getOpType().equals(\"count\") || col.getOpType().equals(\"sum\"))", "dfgs": [245, 248, 246, 243], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 352, "lineEnd": 352, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 242, "rootcause": false, "commits": []}, {"cfgs": [248, 244], "code": "if (col.getOpType().equals(\"max\") || col.getOpType().equals(\"min\"))", "dfgs": [244], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 369, "lineEnd": 369, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 243, "rootcause": false, "commits": []}, {"cfgs": [245], "code": "ColumnOp col1 = new ColumnOp(col.getOpType(), col.getOperand(0))", "dfgs": [245, 246], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 370, "lineEnd": 370, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 244, "rootcause": false, "commits": []}, {"cfgs": [246], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [248, 246], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 371, "lineEnd": 371, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 245, "rootcause": false, "commits": []}, {"cfgs": [247], "code": "meta.getAggColumnAggAliasPairOfMaxMin().put(new ImmutablePair<>(col.getOpType(), col1.getOperand(0)), \"agg\"+aggColumnIdentiferNum)", "dfgs": [248, 247], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 372, "lineEnd": 373, "lineMapIndex": -1, "methodParents": [96], "nodeIndex": 246, "rootcause": false, "commits": []}, {"cfgs": [248], "code": "maxminAlias.put(\"agg\"+aggColumnIdentiferNum++, col.getOpType())", "dfgs": [248], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 374, "lineEnd": 374, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 247, "rootcause": false, "commits": []}, {"cfgs": [], "code": "meta.setMaxminAggAlias(maxminAlias)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 386, "lineEnd": 386, "lineMapIndex": -1, "methodParents": [94], "nodeIndex": 248, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void maxAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 282, "lineEnd": 282, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 249, "rootcause": false, "commits": []}, {"cfgs": [251], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 283, "lineEnd": 283, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 250, "rootcause": false, "commits": []}, {"cfgs": [252], "code": "String sql = \"select max(value) from originalTable\"", "dfgs": [253], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 284, "lineEnd": 284, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 251, "rootcause": false, "commits": []}, {"cfgs": [253], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [253], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 285, "lineEnd": 285, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 252, "rootcause": false, "commits": []}, {"cfgs": [254], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [255], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 286, "lineEnd": 286, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 253, "rootcause": false, "commits": []}, {"cfgs": [255], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [255], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 287, "lineEnd": 287, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 254, "rootcause": false, "commits": []}, {"cfgs": [256], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [256], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 288, "lineEnd": 288, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 255, "rootcause": false, "commits": []}, {"cfgs": [257], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [257, 261], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 290, "lineEnd": 290, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 256, "rootcause": false, "commits": []}, {"cfgs": [258], "code": "queryExecutionPlan.cleanUp()", "dfgs": [258], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 291, "lineEnd": 291, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 257, "rootcause": false, "commits": []}, {"cfgs": [259], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [260], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 292, "lineEnd": 292, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 258, "rootcause": false, "commits": []}, {"cfgs": [260], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable\", 0, 0)", "dfgs": [260], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 293, "lineEnd": 293, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 259, "rootcause": false, "commits": []}, {"cfgs": [261], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [267, 261], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 294, "lineEnd": 296, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 260, "rootcause": false, "commits": []}, {"cfgs": [262], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [263], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 297, "lineEnd": 297, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 261, "rootcause": false, "commits": []}, {"cfgs": [263], "code": "JdbcConnection jdbcConnection = new JdbcConnection(conn, new H2Syntax())", "dfgs": [263], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 300, "lineEnd": 300, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 262, "rootcause": false, "commits": []}, {"cfgs": [264], "code": "ExecutionResultReader reader = ExecutablePlanRunner.getResultReader(jdbcConnection, queryExecutionPlan)", "dfgs": [264], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 303, "lineEnd": 303, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 263, "rootcause": false, "commits": []}, {"cfgs": [265], "code": "while (reader.hasNext())", "dfgs": [265], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 304, "lineEnd": 304, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 264, "rootcause": false, "commits": []}, {"cfgs": [266], "code": "DbmsQueryResult dbmsQueryResult = reader.next()", "dfgs": [266], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 305, "lineEnd": 305, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 265, "rootcause": false, "commits": []}, {"cfgs": [267], "code": "dbmsQueryResult.next()", "dfgs": [267], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 306, "lineEnd": 306, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 266, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(1.0, (double)dbmsQueryResult.getValue(0), 1e-6)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 307, "lineEnd": 307, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 267, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void minAggTest() throws VerdictDBException,SQLException ", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 312, "lineEnd": 312, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 268, "rootcause": false, "commits": []}, {"cfgs": [270], "code": "RelationStandardizer.resetItemID()", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 313, "lineEnd": 313, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 269, "rootcause": false, "commits": []}, {"cfgs": [271], "code": "String sql = \"select min(value) from originalTable\"", "dfgs": [272], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 314, "lineEnd": 314, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 270, "rootcause": false, "commits": []}, {"cfgs": [272], "code": "NonValidatingSQLParser sqlToRelation = new NonValidatingSQLParser()", "dfgs": [272], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 315, "lineEnd": 315, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 271, "rootcause": false, "commits": []}, {"cfgs": [273], "code": "AbstractRelation relation = sqlToRelation.toRelation(sql)", "dfgs": [274], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 316, "lineEnd": 316, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 272, "rootcause": false, "commits": []}, {"cfgs": [274], "code": "RelationStandardizer gen = new RelationStandardizer(staticMetaData)", "dfgs": [274], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 317, "lineEnd": 317, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 273, "rootcause": false, "commits": []}, {"cfgs": [275], "code": "relation = gen.standardize((SelectQuery) relation)", "dfgs": [275], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 318, "lineEnd": 318, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 274, "rootcause": false, "commits": []}, {"cfgs": [276], "code": "QueryExecutionPlan queryExecutionPlan = new QueryExecutionPlan(\"verdictdb_temp\", meta, (SelectQuery) relation)", "dfgs": [276, 280], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 320, "lineEnd": 320, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 275, "rootcause": false, "commits": []}, {"cfgs": [277], "code": "queryExecutionPlan.cleanUp()", "dfgs": [277], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 321, "lineEnd": 321, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 276, "rootcause": false, "commits": []}, {"cfgs": [278], "code": "queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)", "dfgs": [279], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 322, "lineEnd": 322, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 277, "rootcause": false, "commits": []}, {"cfgs": [279], "code": "Dimension d1 = new Dimension(\"originalSchema\", \"originalTable\", 0, 0)", "dfgs": [279], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 323, "lineEnd": 323, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 278, "rootcause": false, "commits": []}, {"cfgs": [280], "code": "assertEquals(new HyperTableCube(Arrays.asList(d1)),((AggExecutionNode) queryExecutionPlan.getRootNode().getExecutableNodeBaseDependents().get(0).getExecutableNodeBaseDependents().get(0)).getMeta().getCubes().get(0))", "dfgs": [286, 280], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 324, "lineEnd": 326, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 279, "rootcause": false, "commits": []}, {"cfgs": [281], "code": "((AsyncAggExecutionNode)queryExecutionPlan.getRoot().getExecutableNodeBaseDependents().get(0)).setScrambleMeta(meta)", "dfgs": [282], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 327, "lineEnd": 327, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 280, "rootcause": false, "commits": []}, {"cfgs": [282], "code": "JdbcConnection jdbcConnection = new JdbcConnection(conn, new H2Syntax())", "dfgs": [282], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 330, "lineEnd": 330, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 281, "rootcause": false, "commits": []}, {"cfgs": [283], "code": "ExecutionResultReader reader = ExecutablePlanRunner.getResultReader(jdbcConnection, queryExecutionPlan)", "dfgs": [283], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 333, "lineEnd": 333, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 282, "rootcause": false, "commits": []}, {"cfgs": [284], "code": "while (reader.hasNext())", "dfgs": [284], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 334, "lineEnd": 334, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 283, "rootcause": false, "commits": []}, {"cfgs": [285], "code": "DbmsQueryResult dbmsQueryResult = reader.next()", "dfgs": [285], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 335, "lineEnd": 335, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 284, "rootcause": false, "commits": []}, {"cfgs": [286], "code": "dbmsQueryResult.next()", "dfgs": [286], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 336, "lineEnd": 336, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 285, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals(1.0, (double)dbmsQueryResult.getValue(0), 1e-6)", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggScaleResultTest.java", "fieldParents": [], "isDel": false, "lineBeg": 337, "lineEnd": 337, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 286, "rootcause": false, "commits": []}]