[{"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"sum(verdictdbalias4.`verdictdbalias6`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias6` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias6` * verdictdbalias4.`verdictdbalias6`) * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias6`, \"+ \"sum(case when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias7` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 62, "lineEnd": 80, "lineMapIndex": 53, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["31dfc0a5eb1beed5fe5e322740740cbac1b831ca", "bea2254c27d44a6432662f1aeee558b0c923ff90", "035c17b0d2dd1f331664414ceac1c44c867decc9"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"sum(verdictdbalias4.`verdictdbalias6`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForCountEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias6` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias6` * verdictdbalias4.`verdictdbalias6`) * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubcount) + \", \"+ \"sum(pow(verdictdbalias4.`verdictdbalias7`, 3)) as \" + quoteAlias(aliasForSumSquaredScaledSubcount) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (select \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias6`, \"    // subsum+ \"sum(case when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias7` \"    // subsample size+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 148, "lineEnd": 170, "lineMapIndex": 54, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": ["035c17b0d2dd1f331664414ceac1c44c867decc9", "31dfc0a5eb1beed5fe5e322740740cbac1b831ca", "bea2254c27d44a6432662f1aeee558b0c923ff90"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `mygroup`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"+ \"sum(case when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `mygroup`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 198, "lineEnd": 218, "lineMapIndex": 55, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": ["035c17b0d2dd1f331664414ceac1c44c867decc9", "31dfc0a5eb1beed5fe5e322740740cbac1b831ca", "bea2254c27d44a6432662f1aeee558b0c923ff90"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `myalias`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"+ \"sum(case when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `myalias`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 246, "lineEnd": 266, "lineMapIndex": 56, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": ["035c17b0d2dd1f331664414ceac1c44c867decc9", "bea2254c27d44a6432662f1aeee558b0c923ff90", "31dfc0a5eb1beed5fe5e322740740cbac1b831ca"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `mygroup`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForCountEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubcount) + \", \"+ \"sum(pow(verdictdbalias4.`verdictdbalias8`, 3)) as \" + quoteAlias(aliasForSumSquaredScaledSubcount) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (select \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"    // subsum+ \"sum(case when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"    // subsample size+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `mygroup`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 342, "lineEnd": 366, "lineMapIndex": 57, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": ["035c17b0d2dd1f331664414ceac1c44c867decc9", "bea2254c27d44a6432662f1aeee558b0c923ff90", "31dfc0a5eb1beed5fe5e322740740cbac1b831ca"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias6.`verdictdbalias7` as `verdictdb:tier`, \"+ \"sum(verdictdbalias6.`verdictdbalias8`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias6.`verdictdbalias8` * \"+ \"verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias6.`verdictdbalias8` * verdictdbalias6.`verdictdbalias8`) * \"+ \"verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select s.`verdictdbalias5` as `verdictdbalias7`, \"+ \"sum(s.`discounted_price`) as `verdictdbalias8`, \"+ \"sum(case when s.`discounted_price` is not null then 1 else 0 end) as `verdictdbalias9` \"+ \"from (select verdictdbalias1.`price` * verdictdbalias1.`discount` as `discounted_price`, \"+ \"verdictdbalias1.`verdictdbalias2` as `verdictdbalias4`, \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1) as s \"+ \"group by s.`verdictdbalias4`, `verdictdbalias7`) as verdictdbalias6 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": true, "lineBeg": 399, "lineEnd": 420, "lineMapIndex": 58, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": ["035c17b0d2dd1f331664414ceac1c44c867decc9", "3c5189b1884d3b4507f3c45360d2e9e960befed0", "bea2254c27d44a6432662f1aeee558b0c923ff90", "31dfc0a5eb1beed5fe5e322740740cbac1b831ca"]}, {"cfgs": [], "code": "sql = sql + \"when \" + withParentheses(columnOp.getOperand(i)) + \" then \" + withParentheses(columnOp.getOperand(i+1))", "dfgs": [], "fName": "src_main_java_org_verdictdb_sqlreader_SelectQueryToSql.java", "fieldParents": [], "isDel": true, "lineBeg": 120, "lineEnd": 120, "lineMapIndex": 59, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [], "code": "HashMap<String, ColumnOp> aggColumnForReplacement = new HashMap<>()", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 69, "lineEnd": 69, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [9, 12], "code": "if (Initiated)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 132, "lineEnd": 132, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [10], "code": "ColumnOp aggCol = aggColumnForReplacement.get(alias)", "dfgs": [12, 11, 10], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [7], "isDel": true, "lineBeg": 133, "lineEnd": 133, "lineMapIndex": 60, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [11, 12], "code": "for (int i = 1; i < aggCol.getOperands().size(); i = i + 2)", "dfgs": [11], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 134, "lineEnd": 134, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "((ColumnOp) aggCol.getOperand(i)).setOperand(0, ((ColumnOp) col.getOperand(i)).getOperand(0))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 135, "lineEnd": 135, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [13], "code": "SelectQuery query = replaceWithOriginalSelectList((SelectQuery) aggColumnsAndQuery.getRight(), ((AggMeta) savedToken.getValue(\"aggMeta\")))", "dfgs": [13], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 143, "lineEnd": 143, "lineMapIndex": 64, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "CreateTableAsSelectQuery createQuery = new CreateTableAsSelectQuery(newTableSchemaName, newTableName, query)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": true, "lineBeg": 144, "lineEnd": 144, "lineMapIndex": 65, "methodParents": [], "nodeIndex": 13, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "String sql = \"select a.verdictdbtier, b.verdictdbtier, \" +\"sum(a_value+b_value) from originalTable1_scrambled as a inner join originalTable2_scrambled as b on a_id=b_id  group by  a.verdictdbtier, b.verdictdbtier\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggJoinMultiTierScaleTest.java", "fieldParents": [], "isDel": true, "lineBeg": 122, "lineEnd": 123, "lineMapIndex": 84, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": ["b5a133a53fc74f40f7c3e09df687a8b3720f5a26"]}, {"cfgs": [], "code": "String sql = \"select verdictdbtier, sum(value) from originalTable_scrambled group by verdictdbtier\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": true, "lineBeg": 112, "lineEnd": 112, "lineMapIndex": 85, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": ["bd849b8eaea2ba64ba1164b0f2191dbab809a2c9"]}, {"cfgs": [17], "code": "List<SelectItem> selectList = ((AggExecutionNode)aggroot).getSelectQuery().getSelectList()", "dfgs": [19], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 113, "lineEnd": 113, "lineMapIndex": 87, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [18], "code": "List<String> aggColumnAlias = new ArrayList<>()", "dfgs": [52, 31, 36, 42, 47], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 114, "lineEnd": 114, "lineMapIndex": 91, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [19], "code": "List<SelectItem> newSelectlist = new ArrayList<>()", "dfgs": [51, 49, 29, 34, 40, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 115, "lineEnd": 115, "lineMapIndex": 92, "methodParents": [], "nodeIndex": 18, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [20], "code": "((AggExecutionNode)aggroot).getMeta().setOriginalSelectList(selectList)", "dfgs": [20], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 116, "lineEnd": 116, "lineMapIndex": 93, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [52, 21], "code": "for (SelectItem selectItem : selectList)", "dfgs": [21], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 117, "lineEnd": 117, "lineMapIndex": 94, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [22, 50], "code": "if (selectItem instanceof AliasedColumn)", "dfgs": [51, 22, 24, 49], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 118, "lineEnd": 118, "lineMapIndex": 95, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [23], "code": "List<ColumnOp> columnOps = getAggregateColumn(((AliasedColumn) selectItem).getColumn())", "dfgs": [52, 24, 23, 30, 35, 41, 29, 31, 34, 36, 40, 42, 46, 45, 47], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 119, "lineEnd": 119, "lineMapIndex": 96, "methodParents": [], "nodeIndex": 22, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [24, 48], "code": "if (!columnOps.isEmpty())", "dfgs": [24], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 121, "lineEnd": 121, "lineMapIndex": 97, "methodParents": [], "nodeIndex": 23, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [25], "code": "((AggExecutionNode)aggroot).getMeta().getAggColumn().put(selectItem, columnOps)", "dfgs": [25], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 122, "lineEnd": 122, "lineMapIndex": 98, "methodParents": [], "nodeIndex": 24, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [26], "code": "for (ColumnOp col:columnOps)", "dfgs": [26], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 123, "lineEnd": 123, "lineMapIndex": 99, "methodParents": [], "nodeIndex": 25, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [27, 37], "code": "if (col.getOpType().equals(\"avg\"))", "dfgs": [38, 27], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 124, "lineEnd": 124, "lineMapIndex": 100, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [32, 28], "code": "if (!((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"sum\", col.getOperand(0))))", "dfgs": [28], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 125, "lineEnd": 126, "lineMapIndex": 101, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [29], "code": "ColumnOp col1 = new ColumnOp(\"sum\", col.getOperand(0))", "dfgs": [29], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 127, "lineEnd": 127, "lineMapIndex": 102, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [30], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [51, 49, 34, 40, 30, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 128, "lineEnd": 128, "lineMapIndex": 103, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [31], "code": "((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().put(new ImmutablePair<>(\"sum\", col1.getOperand(0)), \"agg\"+aggColumnIdentiferNum)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 129, "lineEnd": 130, "lineMapIndex": 104, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [32], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [52, 35, 36, 41, 42, 34, 40, 46, 47, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 131, "lineEnd": 131, "lineMapIndex": 105, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [33], "code": "if (!((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"count\", (UnnamedColumn) new AsteriskColumn())))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 133, "lineEnd": 134, "lineMapIndex": 106, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [34], "code": "ColumnOp col2 = new ColumnOp(\"count\", new AsteriskColumn())", "dfgs": [34], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 135, "lineEnd": 135, "lineMapIndex": 107, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [35], "code": "newSelectlist.add(new AliasedColumn(col2, \"agg\"+aggColumnIdentiferNum))", "dfgs": [51, 49, 40, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 136, "lineEnd": 136, "lineMapIndex": 108, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [36], "code": "((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().put(new ImmutablePair<>(\"count\", (UnnamedColumn) new AsteriskColumn()), \"agg\"+aggColumnIdentiferNum)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 137, "lineEnd": 138, "lineMapIndex": 109, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [52, 41, 42, 40, 46, 47, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 139, "lineEnd": 139, "lineMapIndex": 110, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [38], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 141, "lineEnd": 141, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [43, 39], "code": "if (col.getOpType().equals(\"count\") && !((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"count\", (UnnamedColumn)(new AsteriskColumn()))))", "dfgs": [39, 43], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 142, "lineEnd": 143, "lineMapIndex": 112, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": ["9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [40], "code": "ColumnOp col1 = new ColumnOp(col.getOpType())", "dfgs": [40, 41], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 144, "lineEnd": 144, "lineMapIndex": 113, "methodParents": [], "nodeIndex": 39, "rootcause": false, "commits": ["9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [41], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [51, 49, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 145, "lineEnd": 145, "lineMapIndex": 114, "methodParents": [], "nodeIndex": 40, "rootcause": false, "commits": ["9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [42], "code": "((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().put(new ImmutablePair<>(col.getOpType(), (UnnamedColumn)new AsteriskColumn()), \"agg\"+aggColumnIdentiferNum)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 146, "lineEnd": 147, "lineMapIndex": 115, "methodParents": [], "nodeIndex": 41, "rootcause": false, "commits": ["9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [52, 46, 47, 45], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 148, "lineEnd": 148, "lineMapIndex": 116, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": ["9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [44], "code": "if (!((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(col.getOpType(), col.getOperand(0))))", "dfgs": [44], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 150, "lineEnd": 151, "lineMapIndex": 117, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706", "9eb6ac510b6590b182807ef1d4080f9f12ffb755"]}, {"cfgs": [45], "code": "ColumnOp col1 = new ColumnOp(col.getOpType(), col.getOperand(0))", "dfgs": [45, 46], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 152, "lineEnd": 152, "lineMapIndex": 118, "methodParents": [], "nodeIndex": 44, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [46], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [51, 49, 46], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 153, "lineEnd": 153, "lineMapIndex": 119, "methodParents": [], "nodeIndex": 45, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [47], "code": "((AggExecutionNode)aggroot).getMeta().getAggColumnAggAliasPair().put(new ImmutablePair<>(col.getOpType(), col1.getOperand(0)), \"agg\"+aggColumnIdentiferNum)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 154, "lineEnd": 155, "lineMapIndex": 120, "methodParents": [], "nodeIndex": 46, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [52], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 156, "lineEnd": 156, "lineMapIndex": 121, "methodParents": [], "nodeIndex": 47, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [49], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 161, "lineEnd": 161, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 48, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "newSelectlist.add(selectItem)", "dfgs": [51], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 162, "lineEnd": 162, "lineMapIndex": 123, "methodParents": [], "nodeIndex": 49, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [51], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 164, "lineEnd": 164, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 50, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "newSelectlist.add(selectItem)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 165, "lineEnd": 165, "lineMapIndex": 125, "methodParents": [], "nodeIndex": 51, "rootcause": false, "commits": ["ac4f1806546eb2e7a4631e2eb2e7eb094c4d9706"]}, {"cfgs": [], "code": "((AggExecutionNode)aggroot).getMeta().setAggAlias(aggColumnAlias)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": true, "lineBeg": 170, "lineEnd": 170, "lineMapIndex": 126, "methodParents": [], "nodeIndex": 52, "rootcause": false, "commits": ["cc6b6502733b24c97581382e195e5c3311070c94"]}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"sum(verdictdbalias4.`verdictdbalias6`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias6` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias6` * verdictdbalias4.`verdictdbalias6`) * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias6`, \"+ \"sum(case  when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias7` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 62, "lineEnd": 80, "lineMapIndex": 0, "methodParents": [], "nodeIndex": 53, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"sum(verdictdbalias4.`verdictdbalias6`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForCountEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias6` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias6` * verdictdbalias4.`verdictdbalias6`) * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumScaledSubcount) + \", \"+ \"sum(pow(verdictdbalias4.`verdictdbalias7`, 3)) as \" + quoteAlias(aliasForSumSquaredScaledSubcount) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (select \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias6`, \"    // subsum+ \"sum(case  when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias7` \"    // subsample size+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 148, "lineEnd": 170, "lineMapIndex": 1, "methodParents": [], "nodeIndex": 54, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `mygroup`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"+ \"sum(case  when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `mygroup`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 198, "lineEnd": 218, "lineMapIndex": 2, "methodParents": [], "nodeIndex": 55, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `myalias`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"+ \"sum(case  when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `myalias`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 246, "lineEnd": 266, "lineMapIndex": 3, "methodParents": [], "nodeIndex": 56, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select verdictdbalias4.`verdictdbalias5` as `verdictdb:tier`, \"+ \"verdictdbalias4.`verdictdbalias6` as `mygroup`, \"+ \"sum(verdictdbalias4.`verdictdbalias7`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForCountEstimate) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias7` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias4.`verdictdbalias7` * verdictdbalias4.`verdictdbalias7`) * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8` * \"+ \"verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumScaledSubcount) + \", \"+ \"sum(pow(verdictdbalias4.`verdictdbalias8`, 3)) as \" + quoteAlias(aliasForSumSquaredScaledSubcount) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias4.`verdictdbalias8`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (select \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5`, \"+ \"verdictdbalias1.`mygroup` as `verdictdbalias6`, \"+ \"sum(verdictdbalias1.`mycolumn1`) as `verdictdbalias7`, \"    // subsum+ \"sum(case  when verdictdbalias1.`mycolumn1` is not null then 1 else 0 end) as `verdictdbalias8` \"    // subsample size+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1 \"+ \"group by verdictdbalias1.`verdictdbalias2`, `verdictdbalias5`, `verdictdbalias6`) as verdictdbalias4 \"+ \"group by `verdictdb:tier`, `mygroup`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 342, "lineEnd": 366, "lineMapIndex": 4, "methodParents": [], "nodeIndex": 57, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select verdictdbalias6.`verdictdbalias7` as `verdictdb:tier`, \"+ \"sum(verdictdbalias6.`verdictdbalias8`) as \" + quoteAlias(aliasForSumEstimate) + \", \"+ \"sum(verdictdbalias6.`verdictdbalias8` * \"+ \"verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumScaledSubsum) + \", \"+ \"sum((verdictdbalias6.`verdictdbalias8` * verdictdbalias6.`verdictdbalias8`) * \"+ \"verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumSquaredScaledSubsum) + \", \"+ \"count(*) as \" + quoteAlias(aliasForCountSubsample) + \", \"+ \"sum(verdictdbalias6.`verdictdbalias9`) as \" + quoteAlias(aliasForSumSubsampleSize) + \" \"+ \"from (\"+ \"select s.`verdictdbalias5` as `verdictdbalias7`, \"+ \"sum(s.`discounted_price`) as `verdictdbalias8`, \"+ \"sum(case  when s.`discounted_price` is not null then 1 else 0 end) as `verdictdbalias9` \"+ \"from (select verdictdbalias1.`price` * verdictdbalias1.`discount` as `discounted_price`, \"+ \"verdictdbalias1.`verdictdbalias2` as `verdictdbalias4`, \"+ \"verdictdbalias1.`verdictdbalias3` as `verdictdbalias5` \"+ \"from (select *, \"+ \"t.`verdictdbsid` as `verdictdbalias2`, \"+ \"t.`verdictdbtier` as `verdictdbalias3` \"+ \"from `myschema`.`mytable` as t \"+ \"where t.`verdictdbaggblock` = \" + k + \") as verdictdbalias1) as s \"+ \"group by s.`verdictdbalias4`, `verdictdbalias7`) as verdictdbalias6 \"+ \"group by `verdictdb:tier`\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_query_AggQueryRewriterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 399, "lineEnd": 420, "lineMapIndex": 5, "methodParents": [], "nodeIndex": 58, "rootcause": false, "commits": []}, {"cfgs": [], "code": "sql = sql + \" when \" + withParentheses(columnOp.getOperand(i)) + \" then \" + withParentheses(columnOp.getOperand(i+1))", "dfgs": [], "fName": "src_main_java_org_verdictdb_sqlreader_SelectQueryToSql.java", "fieldParents": [], "isDel": false, "lineBeg": 120, "lineEnd": 120, "lineMapIndex": 6, "methodParents": [], "nodeIndex": 59, "rootcause": false, "commits": []}, {"cfgs": [], "code": "SelectQuery query", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 133, "lineEnd": 133, "lineMapIndex": 9, "methodParents": [], "nodeIndex": 60, "rootcause": false, "commits": []}, {"cfgs": [62, 63], "code": "if (multipleTierTableTierInfo.size()>0)", "dfgs": [64, 62], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 134, "lineEnd": 134, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 61, "rootcause": false, "commits": []}, {"cfgs": [64], "code": "query = sumUpTierGroup((SelectQuery) aggColumnsAndQuery.getRight(), ((AggMeta) savedToken.getValue(\"aggMeta\")))", "dfgs": [64], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 135, "lineEnd": 135, "lineMapIndex": -1, "methodParents": [67], "nodeIndex": 62, "rootcause": false, "commits": []}, {"cfgs": [64], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 137, "lineEnd": 137, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 63, "rootcause": false, "commits": []}, {"cfgs": [65], "code": "SelectQuery createTableQuery = replaceWithOriginalSelectList(query, ((AggMeta) savedToken.getValue(\"aggMeta\")))", "dfgs": [65], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 141, "lineEnd": 141, "lineMapIndex": 12, "methodParents": [], "nodeIndex": 64, "rootcause": false, "commits": []}, {"cfgs": [], "code": "CreateTableAsSelectQuery createQuery = new CreateTableAsSelectQuery(newTableSchemaName, newTableName, createTableQuery)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 143, "lineEnd": 143, "lineMapIndex": 13, "methodParents": [], "nodeIndex": 65, "rootcause": false, "commits": []}, {"cfgs": [], "code": "Initiated = true", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 216, "lineEnd": 216, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 66, "rootcause": false, "commits": []}, {"cfgs": [68], "code": "SelectQuery sumUpTierGroup(SelectQuery subquery, AggMeta aggMeta) ", "dfgs": [69, 70, 79, 83, 68, 71, 80, 81, 82, 72, 73, 74, 77, 78, 76], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 380, "lineEnd": 380, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 67, "rootcause": false, "commits": []}, {"cfgs": [69], "code": "List<String> aggAlias = aggMeta.getAggAlias()", "dfgs": [73], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 381, "lineEnd": 381, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 68, "rootcause": false, "commits": []}, {"cfgs": [70], "code": "List<String> groupby = new ArrayList<>()", "dfgs": [81, 78], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 382, "lineEnd": 382, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 69, "rootcause": false, "commits": []}, {"cfgs": [71], "code": "List<SelectItem> newSelectlist = new ArrayList<>()", "dfgs": [80, 74, 77], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 383, "lineEnd": 383, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 70, "rootcause": false, "commits": []}, {"cfgs": [79, 72], "code": "for (SelectItem sel:subquery.getSelectList())", "dfgs": [79, 72], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 384, "lineEnd": 384, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 71, "rootcause": false, "commits": []}, {"cfgs": [73], "code": "if (sel instanceof AliasedColumn)", "dfgs": [73, 74, 76, 78, 77], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 385, "lineEnd": 385, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 72, "rootcause": false, "commits": []}, {"cfgs": [74, 75], "code": "if (aggAlias.contains(((AliasedColumn) sel).getAliasName()))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 387, "lineEnd": 387, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 73, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newSelectlist.add(new AliasedColumn(new ColumnOp(\"sum\",new BaseColumn(\"to_scale_query\", ((AliasedColumn) sel).getAliasName())), ((AliasedColumn) sel).getAliasName()))", "dfgs": [80, 77], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 388, "lineEnd": 389, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 74, "rootcause": false, "commits": []}, {"cfgs": [76], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 391, "lineEnd": 391, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 75, "rootcause": false, "commits": []}, {"cfgs": [77], "code": "if (!multipleTierTableTierInfo.values().contains(((AliasedColumn) sel).getAliasName()))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 393, "lineEnd": 393, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 76, "rootcause": false, "commits": []}, {"cfgs": [78], "code": "newSelectlist.add(new AliasedColumn(new BaseColumn(\"to_scale_query\", ((AliasedColumn) sel).getAliasName()),((AliasedColumn) sel).getAliasName()))", "dfgs": [80], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 394, "lineEnd": 395, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 77, "rootcause": false, "commits": []}, {"cfgs": [], "code": "groupby.add(((AliasedColumn) sel).getAliasName())", "dfgs": [81], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 396, "lineEnd": 396, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 78, "rootcause": false, "commits": []}, {"cfgs": [80], "code": "subquery.setAliasName(\"to_scale_query\")", "dfgs": [80], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 401, "lineEnd": 401, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 79, "rootcause": false, "commits": []}, {"cfgs": [81], "code": "SelectQuery query = SelectQuery.create(newSelectlist, subquery)", "dfgs": [83, 82], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 402, "lineEnd": 402, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 80, "rootcause": false, "commits": []}, {"cfgs": [83, 82], "code": "for (String group:groupby)", "dfgs": [82], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 403, "lineEnd": 403, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 81, "rootcause": false, "commits": []}, {"cfgs": [], "code": "query.addGroupby(new AliasReference(group))", "dfgs": [83], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 404, "lineEnd": 404, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 82, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return query", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AsyncAggExecutionNode.java", "fieldParents": [], "isDel": false, "lineBeg": 406, "lineEnd": 406, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 83, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String sql = \"select \" +\"sum(a_value+b_value) from originalTable1_scrambled as a inner join originalTable2_scrambled as b on a_id=b_id\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggJoinMultiTierScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 122, "lineEnd": 123, "lineMapIndex": 14, "methodParents": [], "nodeIndex": 84, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String sql = \"select avg(value) from originalTable_scrambled\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_querying_ola_AsyncAggMultipleTiersScaleTest.java", "fieldParents": [], "isDel": false, "lineBeg": 112, "lineEnd": 112, "lineMapIndex": 15, "methodParents": [], "nodeIndex": 85, "rootcause": false, "commits": []}, {"cfgs": [], "code": "int verdictdbTierIndentiferNum = 0", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 35, "lineEnd": 35, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 86, "rootcause": false, "commits": []}, {"cfgs": [88], "code": "List<SelectItem> newSelectlist = rewriteSelectlistWithBasicAgg(((AggExecutionNode)aggroot).getSelectQuery(),  ((AggExecutionNode)aggroot).getMeta())", "dfgs": [88], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 115, "lineEnd": 115, "lineMapIndex": 16, "methodParents": [89], "nodeIndex": 87, "rootcause": false, "commits": []}, {"cfgs": [], "code": "addTierColumn(((AggExecutionNode)aggroot).getSelectQuery(), newSelectlist, scrambleMeta)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 118, "lineEnd": 118, "lineMapIndex": -1, "methodParents": [128], "nodeIndex": 88, "rootcause": false, "commits": []}, {"cfgs": [90], "code": "List<SelectItem> rewriteSelectlistWithBasicAgg(SelectQuery query, AggMeta meta) ", "dfgs": [91, 92, 93, 126, 127, 90, 94, 95, 96, 125, 97, 98, 99, 123, 100, 102, 107, 101, 103, 104, 105, 106, 108, 109, 110, 113, 112, 114, 115, 116, 118, 117, 119, 120, 121], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 309, "lineEnd": 309, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 89, "rootcause": false, "commits": []}, {"cfgs": [91], "code": "List<SelectItem> selectList = query.getSelectList()", "dfgs": [93], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 310, "lineEnd": 310, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 90, "rootcause": false, "commits": []}, {"cfgs": [92], "code": "List<String> aggColumnAlias = new ArrayList<>()", "dfgs": [126, 105, 110, 116, 121], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 311, "lineEnd": 311, "lineMapIndex": 17, "methodParents": [], "nodeIndex": 91, "rootcause": false, "commits": []}, {"cfgs": [93], "code": "List<SelectItem> newSelectlist = new ArrayList<>()", "dfgs": [127, 125, 123, 103, 108, 114, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 312, "lineEnd": 312, "lineMapIndex": 18, "methodParents": [], "nodeIndex": 92, "rootcause": false, "commits": []}, {"cfgs": [94], "code": "meta.setOriginalSelectList(selectList)", "dfgs": [126, 94, 98], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 313, "lineEnd": 313, "lineMapIndex": 19, "methodParents": [], "nodeIndex": 93, "rootcause": false, "commits": []}, {"cfgs": [126, 95], "code": "for (SelectItem selectItem : selectList)", "dfgs": [95], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 314, "lineEnd": 314, "lineMapIndex": 20, "methodParents": [], "nodeIndex": 94, "rootcause": false, "commits": []}, {"cfgs": [96, 124], "code": "if (selectItem instanceof AliasedColumn)", "dfgs": [125, 96, 98, 123], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 315, "lineEnd": 315, "lineMapIndex": 21, "methodParents": [], "nodeIndex": 95, "rootcause": false, "commits": []}, {"cfgs": [97], "code": "List<ColumnOp> columnOps = getAggregateColumn(((AliasedColumn) selectItem).getColumn())", "dfgs": [97, 104, 109, 115, 103, 105, 108, 110, 114, 116, 120, 119, 121], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 316, "lineEnd": 316, "lineMapIndex": 22, "methodParents": [], "nodeIndex": 96, "rootcause": false, "commits": []}, {"cfgs": [98, 122], "code": "if (!columnOps.isEmpty())", "dfgs": [98], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 318, "lineEnd": 318, "lineMapIndex": 23, "methodParents": [], "nodeIndex": 97, "rootcause": false, "commits": []}, {"cfgs": [99], "code": "meta.getAggColumn().put(selectItem, columnOps)", "dfgs": [126, 99, 101, 115, 112, 117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 319, "lineEnd": 319, "lineMapIndex": 24, "methodParents": [], "nodeIndex": 98, "rootcause": false, "commits": []}, {"cfgs": [100], "code": "for (ColumnOp col:columnOps)", "dfgs": [100], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 320, "lineEnd": 320, "lineMapIndex": 25, "methodParents": [], "nodeIndex": 99, "rootcause": false, "commits": []}, {"cfgs": [101, 111], "code": "if (col.getOpType().equals(\"avg\"))", "dfgs": [112, 101], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 321, "lineEnd": 321, "lineMapIndex": 26, "methodParents": [], "nodeIndex": 100, "rootcause": false, "commits": []}, {"cfgs": [102, 106], "code": "if (!meta.getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"sum\", col.getOperand(0))))", "dfgs": [102, 104, 106], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 322, "lineEnd": 323, "lineMapIndex": 27, "methodParents": [], "nodeIndex": 101, "rootcause": false, "commits": []}, {"cfgs": [103], "code": "ColumnOp col1 = new ColumnOp(\"sum\", col.getOperand(0))", "dfgs": [103], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 324, "lineEnd": 324, "lineMapIndex": 28, "methodParents": [], "nodeIndex": 102, "rootcause": false, "commits": []}, {"cfgs": [104], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [127, 125, 123, 108, 114, 104, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 325, "lineEnd": 325, "lineMapIndex": 29, "methodParents": [], "nodeIndex": 103, "rootcause": false, "commits": []}, {"cfgs": [105], "code": "meta.getAggColumnAggAliasPair().put(new ImmutablePair<>(\"sum\", col1.getOperand(0)), \"agg\"+aggColumnIdentiferNum)", "dfgs": [106], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 326, "lineEnd": 327, "lineMapIndex": 30, "methodParents": [], "nodeIndex": 104, "rootcause": false, "commits": []}, {"cfgs": [106], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [126, 109, 110, 115, 116, 108, 114, 120, 121, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 328, "lineEnd": 328, "lineMapIndex": 31, "methodParents": [], "nodeIndex": 105, "rootcause": false, "commits": []}, {"cfgs": [107], "code": "if (!meta.getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"count\", (UnnamedColumn) new AsteriskColumn())))", "dfgs": [126, 109, 115, 112, 117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 330, "lineEnd": 331, "lineMapIndex": 32, "methodParents": [], "nodeIndex": 106, "rootcause": false, "commits": []}, {"cfgs": [108], "code": "ColumnOp col2 = new ColumnOp(\"count\", new AsteriskColumn())", "dfgs": [108], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 332, "lineEnd": 332, "lineMapIndex": 33, "methodParents": [], "nodeIndex": 107, "rootcause": false, "commits": []}, {"cfgs": [109], "code": "newSelectlist.add(new AliasedColumn(col2, \"agg\"+aggColumnIdentiferNum))", "dfgs": [127, 125, 123, 114, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 333, "lineEnd": 333, "lineMapIndex": 34, "methodParents": [], "nodeIndex": 108, "rootcause": false, "commits": []}, {"cfgs": [110], "code": "meta.getAggColumnAggAliasPair().put(new ImmutablePair<>(\"count\", (UnnamedColumn) new AsteriskColumn()), \"agg\"+aggColumnIdentiferNum)", "dfgs": [126, 115, 112, 117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 334, "lineEnd": 335, "lineMapIndex": 35, "methodParents": [], "nodeIndex": 109, "rootcause": false, "commits": []}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [126, 115, 116, 114, 120, 121, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 336, "lineEnd": 336, "lineMapIndex": 36, "methodParents": [], "nodeIndex": 110, "rootcause": false, "commits": []}, {"cfgs": [112], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 338, "lineEnd": 338, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 111, "rootcause": false, "commits": []}, {"cfgs": [113, 117], "code": "if (col.getOpType().equals(\"count\") && !meta.getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(\"count\", (UnnamedColumn)(new AsteriskColumn()))))", "dfgs": [113, 115, 117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 339, "lineEnd": 340, "lineMapIndex": 38, "methodParents": [], "nodeIndex": 112, "rootcause": false, "commits": []}, {"cfgs": [114], "code": "ColumnOp col1 = new ColumnOp(col.getOpType())", "dfgs": [114, 115], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 341, "lineEnd": 341, "lineMapIndex": 39, "methodParents": [], "nodeIndex": 113, "rootcause": false, "commits": []}, {"cfgs": [115], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [127, 125, 123, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 342, "lineEnd": 342, "lineMapIndex": 40, "methodParents": [], "nodeIndex": 114, "rootcause": false, "commits": []}, {"cfgs": [116], "code": "meta.getAggColumnAggAliasPair().put(new ImmutablePair<>(col.getOpType(), (UnnamedColumn)new AsteriskColumn()), \"agg\"+aggColumnIdentiferNum)", "dfgs": [126, 117], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 343, "lineEnd": 344, "lineMapIndex": 41, "methodParents": [], "nodeIndex": 115, "rootcause": false, "commits": []}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [126, 120, 121, 119], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 345, "lineEnd": 345, "lineMapIndex": 42, "methodParents": [], "nodeIndex": 116, "rootcause": false, "commits": []}, {"cfgs": [118], "code": "if (!meta.getAggColumnAggAliasPair().containsKey(new ImmutablePair<>(col.getOpType(), col.getOperand(0))))", "dfgs": [126, 118, 120], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 347, "lineEnd": 348, "lineMapIndex": 43, "methodParents": [], "nodeIndex": 117, "rootcause": false, "commits": []}, {"cfgs": [119], "code": "ColumnOp col1 = new ColumnOp(col.getOpType(), col.getOperand(0))", "dfgs": [119, 120], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 349, "lineEnd": 349, "lineMapIndex": 44, "methodParents": [], "nodeIndex": 118, "rootcause": false, "commits": []}, {"cfgs": [120], "code": "newSelectlist.add(new AliasedColumn(col1, \"agg\"+aggColumnIdentiferNum))", "dfgs": [127, 125, 123, 120], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 350, "lineEnd": 350, "lineMapIndex": 45, "methodParents": [], "nodeIndex": 119, "rootcause": false, "commits": []}, {"cfgs": [121], "code": "meta.getAggColumnAggAliasPair().put(new ImmutablePair<>(col.getOpType(), col1.getOperand(0)), \"agg\"+aggColumnIdentiferNum)", "dfgs": [126], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 351, "lineEnd": 352, "lineMapIndex": 46, "methodParents": [], "nodeIndex": 120, "rootcause": false, "commits": []}, {"cfgs": [], "code": "aggColumnAlias.add(\"agg\"+aggColumnIdentiferNum++)", "dfgs": [126], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 353, "lineEnd": 353, "lineMapIndex": 47, "methodParents": [], "nodeIndex": 121, "rootcause": false, "commits": []}, {"cfgs": [123], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 358, "lineEnd": 358, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 122, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newSelectlist.add(selectItem)", "dfgs": [127, 125], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 359, "lineEnd": 359, "lineMapIndex": 49, "methodParents": [], "nodeIndex": 123, "rootcause": false, "commits": []}, {"cfgs": [125], "code": "else", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 361, "lineEnd": 361, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 124, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newSelectlist.add(selectItem)", "dfgs": [127], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 362, "lineEnd": 362, "lineMapIndex": 51, "methodParents": [], "nodeIndex": 125, "rootcause": false, "commits": []}, {"cfgs": [127], "code": "meta.setAggAlias(aggColumnAlias)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 365, "lineEnd": 365, "lineMapIndex": 52, "methodParents": [], "nodeIndex": 126, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return newSelectlist", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 366, "lineEnd": 366, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 127, "rootcause": false, "commits": []}, {"cfgs": [129], "code": "void addTierColumn(SelectQuery query, List<SelectItem> newSelectList, ScrambleMeta scrambleMeta) ", "dfgs": [144, 129, 130, 131, 132, 136, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 369, "lineEnd": 369, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 128, "rootcause": false, "commits": []}, {"cfgs": [144, 130], "code": "for (AbstractRelation table:query.getFromList())", "dfgs": [130, 135, 143], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 370, "lineEnd": 370, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 129, "rootcause": false, "commits": []}, {"cfgs": [131, 136], "code": "if (table instanceof BaseTable)", "dfgs": [131, 132, 136, 134], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 371, "lineEnd": 371, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 130, "rootcause": false, "commits": []}, {"cfgs": [132], "code": "String schemaName = ((BaseTable) table).getSchemaName()", "dfgs": [133], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 372, "lineEnd": 372, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 131, "rootcause": false, "commits": []}, {"cfgs": [133], "code": "String tableName = ((BaseTable) table).getTableName()", "dfgs": [133], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 373, "lineEnd": 373, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 132, "rootcause": false, "commits": []}, {"cfgs": [134], "code": "if (scrambleMeta.isScrambled(schemaName, tableName) && scrambleMeta.getMetaForTable(schemaName, tableName).getNumberOfTiers()>1)", "dfgs": [134, 141], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 374, "lineEnd": 374, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 133, "rootcause": false, "commits": []}, {"cfgs": [135], "code": "newSelectList.add(new AliasedColumn(new BaseColumn(schemaName, tableName, table.getAliasName().get(), scrambleMeta.getTierColumn(schemaName, tableName)),\"verdictdbtier\"+verdictdbTierIndentiferNum))", "dfgs": [141, 142], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [86], "isDel": false, "lineBeg": 375, "lineEnd": 376, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 134, "rootcause": false, "commits": []}, {"cfgs": [], "code": "query.addGroupby(new AliasReference(\"verdictdbtier\"+verdictdbTierIndentiferNum++))", "dfgs": [143, 142], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [86], "isDel": false, "lineBeg": 377, "lineEnd": 377, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 135, "rootcause": false, "commits": []}, {"cfgs": [137], "code": "if (table instanceof JoinTable)", "dfgs": [137], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 380, "lineEnd": 380, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 136, "rootcause": false, "commits": []}, {"cfgs": [138], "code": "for (AbstractRelation jointable:((JoinTable) table).getJoinList())", "dfgs": [138], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 381, "lineEnd": 381, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 137, "rootcause": false, "commits": []}, {"cfgs": [139], "code": "if (jointable instanceof BaseTable)", "dfgs": [139, 140, 142], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 382, "lineEnd": 382, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 138, "rootcause": false, "commits": []}, {"cfgs": [140], "code": "String schemaName = ((BaseTable) jointable).getSchemaName()", "dfgs": [141], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 383, "lineEnd": 383, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 139, "rootcause": false, "commits": []}, {"cfgs": [141], "code": "String tableName = ((BaseTable) jointable).getTableName()", "dfgs": [141], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 384, "lineEnd": 384, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 140, "rootcause": false, "commits": []}, {"cfgs": [142], "code": "if (scrambleMeta.isScrambled(schemaName, tableName) && scrambleMeta.getMetaForTable(schemaName, tableName).getNumberOfTiers()>1)", "dfgs": [142], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [], "isDel": false, "lineBeg": 385, "lineEnd": 385, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 141, "rootcause": false, "commits": []}, {"cfgs": [143], "code": "newSelectList.add(new AliasedColumn(new BaseColumn(schemaName, tableName, jointable.getAliasName().get(), scrambleMeta.getTierColumn(schemaName, tableName)),\"verdictdbtier\"+verdictdbTierIndentiferNum))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [86], "isDel": false, "lineBeg": 386, "lineEnd": 387, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 142, "rootcause": false, "commits": []}, {"cfgs": [], "code": "query.addGroupby(new AliasReference(\"verdictdbtier\"+verdictdbTierIndentiferNum++))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [86], "isDel": false, "lineBeg": 388, "lineEnd": 388, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 143, "rootcause": false, "commits": []}, {"cfgs": [], "code": "verdictdbTierIndentiferNum = 0", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_querying_ola_AggExecutionNodeBlock.java", "fieldParents": [86], "isDel": false, "lineBeg": 394, "lineEnd": 394, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 144, "rootcause": false, "commits": []}]