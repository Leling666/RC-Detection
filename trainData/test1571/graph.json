[{"cfgs":[],"code":"relativeUrl = relativeUrl.replace(\"{\" + name + \"}\", canonicalizeForPath(value, encoded))","dfgs":[],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":true,"lineBeg":94,"lineEnd":94,"lineMapIndex":55,"methodParents":[],"nodeIndex":0},{"cfgs":[3],"code":"public void pathParametersAndPathTraversal() ","dfgs":[7,8,9,10,11,12,13,5,6],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":881,"lineEnd":881,"lineMapIndex":-1,"methodParents":[],"nodeIndex":1},{"cfgs":[],"code":"class Example ","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":882,"lineEnd":882,"lineMapIndex":-1,"methodParents":[],"nodeIndex":2},{"cfgs":[5],"code":"class Example {@GET(\"/foo/bar/{ping}/\") //Call<ResponseBody> method(@Path(value = \"ping\") String ping) {return null","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":882,"lineEnd":885,"lineMapIndex":-1,"methodParents":[],"nodeIndex":3},{"cfgs":[],"code":"return null","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":885,"lineEnd":885,"lineMapIndex":-1,"methodParents":[],"nodeIndex":4},{"cfgs":[6],"code":"assertMalformedRequest(Example.class, \".\")","dfgs":[6],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":889,"lineEnd":889,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":5},{"cfgs":[7],"code":"assertMalformedRequest(Example.class, \"..\")","dfgs":[7],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":890,"lineEnd":890,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":6},{"cfgs":[8],"code":"assertThat(buildRequest(Example.class, \"./a\").url().encodedPath()).isEqualTo(\"/foo/bar/.%2Fa/\")","dfgs":[8],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":892,"lineEnd":893,"lineMapIndex":-1,"methodParents":[],"nodeIndex":7},{"cfgs":[9],"code":"assertThat(buildRequest(Example.class, \"a/.\").url().encodedPath()).isEqualTo(\"/foo/bar/a%2F./\")","dfgs":[9],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":894,"lineEnd":895,"lineMapIndex":-1,"methodParents":[],"nodeIndex":8},{"cfgs":[10],"code":"assertThat(buildRequest(Example.class, \"a/..\").url().encodedPath()).isEqualTo(\"/foo/bar/a%2F../\")","dfgs":[10],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":896,"lineEnd":897,"lineMapIndex":-1,"methodParents":[],"nodeIndex":9},{"cfgs":[11],"code":"assertThat(buildRequest(Example.class, \"../a\").url().encodedPath()).isEqualTo(\"/foo/bar/..%2Fa/\")","dfgs":[11],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":898,"lineEnd":899,"lineMapIndex":-1,"methodParents":[],"nodeIndex":10},{"cfgs":[12],"code":"assertThat(buildRequest(Example.class, \"..\\\\..\").url().encodedPath()).isEqualTo(\"/foo/bar/..%5C../\")","dfgs":[12],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":900,"lineEnd":901,"lineMapIndex":-1,"methodParents":[],"nodeIndex":11},{"cfgs":[13],"code":"assertThat(buildRequest(Example.class, \"%2E\").url().encodedPath()).isEqualTo(\"/foo/bar/%252E/\")","dfgs":[13],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":903,"lineEnd":904,"lineMapIndex":-1,"methodParents":[],"nodeIndex":12},{"cfgs":[],"code":"assertThat(buildRequest(Example.class, \"%2E%2E\").url().encodedPath()).isEqualTo(\"/foo/bar/%252E%252E/\")","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":905,"lineEnd":906,"lineMapIndex":-1,"methodParents":[],"nodeIndex":13},{"cfgs":[16],"code":"public void encodedPathParametersAndPathTraversal() ","dfgs":[34,35,36,37,38,39,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":909,"lineEnd":909,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[],"code":"class Example ","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":910,"lineEnd":910,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[18],"code":"class Example {@GET(\"/foo/bar/{ping}/\") //Call<ResponseBody> method(@Path(value = \"ping\", encoded = true) String ping) {return null","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":910,"lineEnd":913,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[],"code":"return null","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":913,"lineEnd":913,"lineMapIndex":-1,"methodParents":[],"nodeIndex":17},{"cfgs":[19],"code":"assertMalformedRequest(Example.class, \".\")","dfgs":[19],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":917,"lineEnd":917,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":18},{"cfgs":[20],"code":"assertMalformedRequest(Example.class, \"%2E\")","dfgs":[20],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":918,"lineEnd":918,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":19},{"cfgs":[21],"code":"assertMalformedRequest(Example.class, \"%2e\")","dfgs":[21],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":919,"lineEnd":919,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":20},{"cfgs":[22],"code":"assertMalformedRequest(Example.class, \"..\")","dfgs":[22],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":920,"lineEnd":920,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":21},{"cfgs":[23],"code":"assertMalformedRequest(Example.class, \"%2E.\")","dfgs":[23],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":921,"lineEnd":921,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":22},{"cfgs":[24],"code":"assertMalformedRequest(Example.class, \"%2e.\")","dfgs":[24],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":922,"lineEnd":922,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":23},{"cfgs":[25],"code":"assertMalformedRequest(Example.class, \".%2E\")","dfgs":[25],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":923,"lineEnd":923,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":24},{"cfgs":[26],"code":"assertMalformedRequest(Example.class, \".%2e\")","dfgs":[26],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":924,"lineEnd":924,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":25},{"cfgs":[27],"code":"assertMalformedRequest(Example.class, \"%2E%2e\")","dfgs":[27],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":925,"lineEnd":925,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":26},{"cfgs":[28],"code":"assertMalformedRequest(Example.class, \"%2e%2E\")","dfgs":[28],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":926,"lineEnd":926,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":27},{"cfgs":[29],"code":"assertMalformedRequest(Example.class, \"./a\")","dfgs":[29],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":927,"lineEnd":927,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":28},{"cfgs":[30],"code":"assertMalformedRequest(Example.class, \"a/.\")","dfgs":[30],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":928,"lineEnd":928,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":29},{"cfgs":[31],"code":"assertMalformedRequest(Example.class, \"../a\")","dfgs":[31],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":929,"lineEnd":929,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":30},{"cfgs":[32],"code":"assertMalformedRequest(Example.class, \"a/..\")","dfgs":[32],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":930,"lineEnd":930,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":31},{"cfgs":[33],"code":"assertMalformedRequest(Example.class, \"a/../b\")","dfgs":[33],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":931,"lineEnd":931,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":32},{"cfgs":[34],"code":"assertMalformedRequest(Example.class, \"a/%2e%2E/b\")","dfgs":[34],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":932,"lineEnd":932,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":33},{"cfgs":[35],"code":"assertThat(buildRequest(Example.class, \"...\").url().encodedPath()).isEqualTo(\"/foo/bar/.../\")","dfgs":[35],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":934,"lineEnd":935,"lineMapIndex":-1,"methodParents":[],"nodeIndex":34},{"cfgs":[36],"code":"assertThat(buildRequest(Example.class, \"a..b\").url().encodedPath()).isEqualTo(\"/foo/bar/a..b/\")","dfgs":[36],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":936,"lineEnd":937,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[37],"code":"assertThat(buildRequest(Example.class, \"a..\").url().encodedPath()).isEqualTo(\"/foo/bar/a../\")","dfgs":[37],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":938,"lineEnd":939,"lineMapIndex":-1,"methodParents":[],"nodeIndex":36},{"cfgs":[38],"code":"assertThat(buildRequest(Example.class, \"a..b\").url().encodedPath()).isEqualTo(\"/foo/bar/a..b/\")","dfgs":[38],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":940,"lineEnd":941,"lineMapIndex":-1,"methodParents":[],"nodeIndex":37},{"cfgs":[39],"code":"assertThat(buildRequest(Example.class, \"..b\").url().encodedPath()).isEqualTo(\"/foo/bar/..b/\")","dfgs":[39],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":942,"lineEnd":943,"lineMapIndex":-1,"methodParents":[],"nodeIndex":38},{"cfgs":[],"code":"assertThat(buildRequest(Example.class, \"..\\\\..\").url().encodedPath()).isEqualTo(\"/foo/bar/..%5C../\")","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":944,"lineEnd":945,"lineMapIndex":-1,"methodParents":[],"nodeIndex":39},{"cfgs":[42],"code":"public void dotDotsOkayWhenNotFullPathSegment() ","dfgs":[45,46,43,44],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":948,"lineEnd":948,"lineMapIndex":-1,"methodParents":[],"nodeIndex":40},{"cfgs":[],"code":"class Example ","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":949,"lineEnd":949,"lineMapIndex":-1,"methodParents":[],"nodeIndex":41},{"cfgs":[43],"code":"class Example {@GET(\"/foo{ping}bar/\") //Call<ResponseBody> method(@Path(value = \"ping\", encoded = true) String ping) {return null","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":949,"lineEnd":952,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"assertMalformedRequest(Example.class, \"/./\")","dfgs":[44],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":956,"lineEnd":956,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":43},{"cfgs":[45],"code":"assertMalformedRequest(Example.class, \"/../\")","dfgs":[45],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":957,"lineEnd":957,"lineMapIndex":-1,"methodParents":[47],"nodeIndex":44},{"cfgs":[46],"code":"assertThat(buildRequest(Example.class, \".\").url().encodedPath()).isEqualTo(\"/foo.bar/\")","dfgs":[46],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":959,"lineEnd":959,"lineMapIndex":-1,"methodParents":[],"nodeIndex":45},{"cfgs":[],"code":"assertThat(buildRequest(Example.class, \"..\").url().encodedPath()).isEqualTo(\"/foo..bar/\")","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":960,"lineEnd":960,"lineMapIndex":-1,"methodParents":[],"nodeIndex":46},{"cfgs":[48],"code":"static void assertMalformedRequest(Class<?> cls, Object... args) ","dfgs":[51,50,49],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":2869,"lineEnd":2869,"lineMapIndex":-1,"methodParents":[],"nodeIndex":47},{"cfgs":[49],"code":"try ","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":2870,"lineEnd":2870,"lineMapIndex":-1,"methodParents":[],"nodeIndex":48},{"cfgs":[50],"code":"Request request = buildRequest(cls, args)","dfgs":[50],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":2871,"lineEnd":2871,"lineMapIndex":-1,"methodParents":[],"nodeIndex":49},{"cfgs":[],"code":"fail(\"expected a malformed request but was \" + request)","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":2872,"lineEnd":2872,"lineMapIndex":-1,"methodParents":[],"nodeIndex":50},{"cfgs":[],"code":"catch (IllegalArgumentException expected)","dfgs":[],"fName":"retrofit_src_test_java_retrofit2_RequestFactoryTest.java","fieldParents":[],"isDel":false,"lineBeg":2873,"lineEnd":2873,"lineMapIndex":-1,"methodParents":[],"nodeIndex":51},{"cfgs":[],"code":"import java.util.regex.Pattern","dfgs":[],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":19,"lineEnd":19,"lineMapIndex":-1,"methodParents":[],"nodeIndex":52},{"cfgs":[],"code":"private static final Pattern PATH_TRAVERSAL = Pattern.compile(\"(.*/)?(\\\\.|%2e|%2E){1,2}(/.*)?\")","dfgs":[],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":49,"lineEnd":49,"lineMapIndex":-1,"methodParents":[],"nodeIndex":53},{"cfgs":[55],"code":"String replacement = canonicalizeForPath(value, encoded)","dfgs":[55,57],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":110,"lineEnd":110,"lineMapIndex":-1,"methodParents":[],"nodeIndex":54},{"cfgs":[56],"code":"String newRelativeUrl = relativeUrl.replace(\"{\" + name + \"}\", replacement)","dfgs":[56],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":111,"lineEnd":111,"lineMapIndex":0,"methodParents":[],"nodeIndex":55},{"cfgs":[57,58],"code":"if (PATH_TRAVERSAL.matcher(newRelativeUrl).matches())","dfgs":[58],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[53],"isDel":false,"lineBeg":112,"lineEnd":112,"lineMapIndex":-1,"methodParents":[],"nodeIndex":56},{"cfgs":[58],"code":"throw new IllegalArgumentException(\"@Path parameters shouldn't perform path traversal ('.' or '..'): \" + value)","dfgs":[],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":113,"lineEnd":114,"lineMapIndex":-1,"methodParents":[],"nodeIndex":57},{"cfgs":[],"code":"relativeUrl = newRelativeUrl","dfgs":[],"fName":"retrofit_src_main_java_retrofit2_RequestBuilder.java","fieldParents":[],"isDel":false,"lineBeg":116,"lineEnd":116,"lineMapIndex":-1,"methodParents":[],"nodeIndex":58}]