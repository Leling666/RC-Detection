[{"cfgs": [1], "code": "ColumnOp newCol = new ColumnOp(\"sum\",new ColumnOp(\"divide\", Arrays.asList(ConstantColumn.valueOf(1), probCol)))", "dfgs": [2, 4, 1, 6, 3], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 249, "lineEnd": 250, "lineMapIndex": 16, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["b592fa8d6d9d062908ef590657d9a99c29993db2", "76400fa175aff476475bc1c20c44f7638b61da9a"]}, {"cfgs": [2], "code": "newInnerSelectList.add(new AliasedColumn(newCol, aliasName))", "dfgs": [6, 4, 2], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 251, "lineEnd": 251, "lineMapIndex": 17, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": ["29a469d70e79ca492f1ccfa4742ea15fc04229d0"]}, {"cfgs": [3], "code": "UnnamedColumn op = col.getOperand()", "dfgs": [3], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 254, "lineEnd": 254, "lineMapIndex": 30, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": ["b592fa8d6d9d062908ef590657d9a99c29993db2"]}, {"cfgs": [4], "code": "ColumnOp newCol1 = new ColumnOp(\"sum\",new ColumnOp(\"divide\", Arrays.asList(op, probCol)))", "dfgs": [4, 6, 5], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 257, "lineEnd": 258, "lineMapIndex": 31, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": ["a7c94c92f51eb390b7e92141680fa2e6874a1bc3"]}, {"cfgs": [5], "code": "ColumnOp oneIfNotNull = ColumnOp.casewhenelse(ConstantColumn.valueOf(1),ColumnOp.notnull(op),ConstantColumn.valueOf(0))", "dfgs": [6, 5], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 260, "lineEnd": 263, "lineMapIndex": 33, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": ["a7c94c92f51eb390b7e92141680fa2e6874a1bc3"]}, {"cfgs": [6], "code": "ColumnOp newCol2 = new ColumnOp(\"sum\",new ColumnOp(\"divide\", Arrays.asList(oneIfNotNull, probCol)))", "dfgs": [7], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 264, "lineEnd": 265, "lineMapIndex": 34, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": ["a7c94c92f51eb390b7e92141680fa2e6874a1bc3"]}, {"cfgs": [7], "code": "newInnerSelectList.add(new AliasedColumn(newCol1, aliasName + \"_sum\"))", "dfgs": [7], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 266, "lineEnd": 266, "lineMapIndex": 35, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": ["29a469d70e79ca492f1ccfa4742ea15fc04229d0"]}, {"cfgs": [], "code": "newInnerSelectList.add(new AliasedColumn(newCol2, aliasName + \"_count\"))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": true, "lineBeg": 267, "lineEnd": 267, "lineMapIndex": 36, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": ["29a469d70e79ca492f1ccfa4742ea15fc04229d0"]}, {"cfgs": [], "code": "String expected = \"select sum(1 / `t`.`verdictincprob`) as a \"+ \"from `myschema`.`mytable` \"+ \"where `t`.`verdictpartition` = part\" + k", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_ScrambleRewriterFlatQueryTest.java", "fieldParents": [], "isDel": true, "lineBeg": 70, "lineEnd": 72, "lineMapIndex": 42, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": ["44215b111d42bfb34f9b609cf3af4fc03d0ff9ec", "b592fa8d6d9d062908ef590657d9a99c29993db2", "76400fa175aff476475bc1c20c44f7638b61da9a"]}, {"cfgs": [], "code": "String expected = \"select sum(`t`.`mycolumn1` / `t`.`verdictincprob`) as a_sum, \"+ \"sum(case 1 when `t`.`mycolumn1` is not null else 0 end / `t`.`verdictincprob`) as a_count \"+ \"from `myschema`.`mytable` \"+ \"where `t`.`verdictpartition` = part\" + k", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_ScrambleRewriterFlatQueryTest.java", "fieldParents": [], "isDel": true, "lineBeg": 90, "lineEnd": 93, "lineMapIndex": 43, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": ["a7c94c92f51eb390b7e92141680fa2e6874a1bc3", "b592fa8d6d9d062908ef590657d9a99c29993db2", "44215b111d42bfb34f9b609cf3af4fc03d0ff9ec"]}, {"cfgs": [11], "code": "public static UnnamedColumn count() ", "dfgs": [11], "fName": "src_main_java_org_verdictdb_core_logical_query_ColumnOp.java", "fieldParents": [], "isDel": false, "lineBeg": 109, "lineEnd": 109, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return new ColumnOp(\"count\")", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_logical_query_ColumnOp.java", "fieldParents": [], "isDel": false, "lineBeg": 110, "lineEnd": 110, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": []}, {"cfgs": [13], "code": "String aliasForSubCountEst = generateNextAliasName()", "dfgs": [13, 17], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 248, "lineEnd": 248, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": []}, {"cfgs": [14], "code": "String aliasForSubsampleSize = generateNextAliasName()", "dfgs": [14, 18], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 249, "lineEnd": 249, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 13, "rootcause": false, "commits": []}, {"cfgs": [15], "code": "String aliasForMeanEstimate = generateMeanEstimateAliasName(aliasName)", "dfgs": [15, 19], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 250, "lineEnd": 250, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": []}, {"cfgs": [16], "code": "String aliasForStdEstimate = generateStdEstimateAliasName(aliasName)", "dfgs": [17, 32, 16, 33, 30, 19, 36, 31, 25, 20], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 251, "lineEnd": 251, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": []}, {"cfgs": [17], "code": "ColumnOp newCol = ColumnOp.sum(ColumnOp.divide(ConstantColumn.valueOf(1), probCol))", "dfgs": [30, 19, 36, 31, 17, 32, 33, 18], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 255, "lineEnd": 255, "lineMapIndex": 0, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": []}, {"cfgs": [18], "code": "newInnerSelectList.add(new AliasedColumn(newCol, aliasForSubCountEst))", "dfgs": [18, 19], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 256, "lineEnd": 256, "lineMapIndex": 1, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": []}, {"cfgs": [19], "code": "newInnerSelectList.add(new AliasedColumn(ColumnOp.count(),aliasForSubsampleSize))", "dfgs": [32, 33, 30, 19, 36, 31, 20], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 257, "lineEnd": 260, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 18, "rootcause": false, "commits": []}, {"cfgs": [20], "code": "newOuterSelectList.add(new AliasedColumn(ColumnOp.sum(new BaseColumn(innerTableAliasName, aliasForSubCountEst)),aliasForMeanEstimate))", "dfgs": [20], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 262, "lineEnd": 264, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": []}, {"cfgs": [21], "code": "newOuterSelectList.add(new AliasedColumn(ColumnOp.divide(ColumnOp.std(ColumnOp.multiply(new BaseColumn(innerTableAliasName, aliasForSubCountEst),ColumnOp.sqrt(new BaseColumn(innerTableAliasName, aliasForSubsampleSize)))),ColumnOp.sqrt(ColumnOp.sum(new BaseColumn(innerTableAliasName, aliasForSubsampleSize)))),aliasForStdEstimate))", "dfgs": [32, 33, 30, 36, 31], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 265, "lineEnd": 274, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": []}, {"cfgs": [24, 22], "code": "for (GroupingAttribute a : groupbyList)", "dfgs": [24, 22, 41, 39, 23, 40, 38], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 275, "lineEnd": 275, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": []}, {"cfgs": [23], "code": "newInnerGroupbyList.add(a)", "dfgs": [24, 23], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 276, "lineEnd": 276, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 22, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newOuterGroupbyList.add(a)", "dfgs": [40], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 277, "lineEnd": 277, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 23, "rootcause": false, "commits": []}, {"cfgs": [25], "code": "newInnerGroupbyList.add(subsampleId)", "dfgs": [40, 41, 39], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 279, "lineEnd": 279, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 24, "rootcause": false, "commits": []}, {"cfgs": [26], "code": "String aliasForSubSumEst = generateNextAliasName()", "dfgs": [26, 32], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 282, "lineEnd": 282, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 25, "rootcause": false, "commits": []}, {"cfgs": [27], "code": "String aliasForSubCountEst = generateNextAliasName()", "dfgs": [27, 34], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 283, "lineEnd": 283, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": []}, {"cfgs": [28], "code": "String aliasForSubsampleSize = generateNextAliasName()", "dfgs": [28, 35], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 284, "lineEnd": 284, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": []}, {"cfgs": [29], "code": "String aliasForMeanEstimate = generateMeanEstimateAliasName(aliasName)", "dfgs": [29, 36], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 285, "lineEnd": 285, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": []}, {"cfgs": [30], "code": "String aliasForStdEstimate = generateStdEstimateAliasName(aliasName)", "dfgs": [32, 33, 30, 36, 31, 37], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 286, "lineEnd": 286, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": []}, {"cfgs": [31], "code": "UnnamedColumn op = col.getOperand()", "dfgs": [31], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 289, "lineEnd": 289, "lineMapIndex": 2, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": []}, {"cfgs": [32], "code": "ColumnOp newCol = ColumnOp.sum(ColumnOp.divide(op, probCol))", "dfgs": [32, 33, 34], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 291, "lineEnd": 291, "lineMapIndex": 3, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": []}, {"cfgs": [33], "code": "newInnerSelectList.add(new AliasedColumn(newCol, aliasForSubSumEst))", "dfgs": [34, 36], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 292, "lineEnd": 292, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": []}, {"cfgs": [34], "code": "ColumnOp oneIfNotNull = ColumnOp.casewhenelse(ConstantColumn.valueOf(1),ColumnOp.notnull(op),ConstantColumn.valueOf(0))", "dfgs": [36, 34], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 293, "lineEnd": 296, "lineMapIndex": 4, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": []}, {"cfgs": [35], "code": "newInnerSelectList.add(new AliasedColumn(ColumnOp.sum(ColumnOp.divide(oneIfNotNull, probCol)),aliasForSubCountEst))", "dfgs": [35, 36], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 297, "lineEnd": 300, "lineMapIndex": 5, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": []}, {"cfgs": [36], "code": "newInnerSelectList.add(new AliasedColumn(ColumnOp.sum(oneIfNotNull),aliasForSubsampleSize))", "dfgs": [36, 37], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 301, "lineEnd": 304, "lineMapIndex": 6, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": []}, {"cfgs": [37], "code": "newOuterSelectList.add(new AliasedColumn(ColumnOp.divide(ColumnOp.sum(new BaseColumn(innerTableAliasName, aliasForSubSumEst)),ColumnOp.sum(new BaseColumn(innerTableAliasName, aliasForSubCountEst))),aliasForMeanEstimate))", "dfgs": [37], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 306, "lineEnd": 311, "lineMapIndex": 7, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": []}, {"cfgs": [38], "code": "newOuterSelectList.add(new AliasedColumn(ColumnOp.divide(ColumnOp.std(ColumnOp.multiply(ColumnOp.divide(new BaseColumn(innerTableAliasName, aliasForSubSumEst),new BaseColumn(innerTableAliasName, aliasForSubCountEst)),ColumnOp.sqrt(new BaseColumn(innerTableAliasName, aliasForSubsampleSize)))),ColumnOp.sqrt(ColumnOp.sum(new BaseColumn(innerTableAliasName, aliasForSubsampleSize)))),aliasForStdEstimate))", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 312, "lineEnd": 323, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": []}, {"cfgs": [41, 39], "code": "for (GroupingAttribute a : groupbyList)", "dfgs": [41, 39, 40], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 324, "lineEnd": 324, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": []}, {"cfgs": [40], "code": "newInnerGroupbyList.add(a)", "dfgs": [41, 40], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 325, "lineEnd": 325, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 39, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newOuterGroupbyList.add(a)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 326, "lineEnd": 326, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 40, "rootcause": false, "commits": []}, {"cfgs": [], "code": "newInnerGroupbyList.add(subsampleId)", "dfgs": [], "fName": "src_main_java_org_verdictdb_core_rewriter_ScrambleRewriter.java", "fieldParents": [], "isDel": false, "lineBeg": 328, "lineEnd": 328, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 41, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select sum(`verdictalias1`.`verdictalias2`) as a, \"+ \"std(`verdictalias1`.`verdictalias2` * sqrt(`verdictalias1`.`verdictalias3`)) / \"+ \"sqrt(sum(`verdictalias1`.`verdictalias3`)) as std_a \"+ \"from (\"+ \"select sum(1 / (`t`.`verdictincprob` + (`t`.`verdictincprobblockdiff` * \" + k + \"))) as verdictalias2, \"+ \"count(*) as verdictalias3 \"+ \"from `myschema`.`mytable` as t \"+ \"where `t`.`verdictpartition` = \" + k + \" \"+ \"group by `t`.`verdictsid`) as verdictalias1\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_ScrambleRewriterFlatQueryTest.java", "fieldParents": [], "isDel": false, "lineBeg": 70, "lineEnd": 78, "lineMapIndex": 8, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": []}, {"cfgs": [], "code": "String expected = \"select sum(`verdictalias1`.`verdictalias2`) / sum(`verdictalias1`.`verdictalias3`) as a, \"+ \"std((`verdictalias1`.`verdictalias2` / `verdictalias1`.`verdictalias3`)\"+ \" * sqrt(`verdictalias1`.`verdictalias4`)) / \"+ \"sqrt(sum(`verdictalias1`.`verdictalias4`)) as std_a \"+ \"from (\"+ \"select sum(`t`.`mycolumn1` / (`t`.`verdictincprob` + (`t`.`verdictincprobblockdiff` * \" + k + \"))) as verdictalias2, \"+ \"sum((case 1 when `t`.`mycolumn1` is not null else 0 end) / \"+ \"(`t`.`verdictincprob` + (`t`.`verdictincprobblockdiff` * \" + k + \"))) as verdictalias3, \"+ \"sum(case 1 when `t`.`mycolumn1` is not null else 0 end) as verdictalias4 \"+ \"from `myschema`.`mytable` as t \"+ \"where `t`.`verdictpartition` = \" + k + \" \"+ \"group by `t`.`verdictsid`) as verdictalias1\"", "dfgs": [], "fName": "src_test_java_org_verdictdb_core_rewriter_ScrambleRewriterFlatQueryTest.java", "fieldParents": [], "isDel": false, "lineBeg": 96, "lineEnd": 107, "lineMapIndex": 9, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": []}]