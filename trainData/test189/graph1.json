[{"cfgs": [], "code": "tstream = TokenSources.getTokenStream(searcher.getReader(), docId, fieldName)", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": true, "lineBeg": 278, "lineEnd": 278, "lineMapIndex": 3, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["cacf6ae29560f4c6e4c908616ae6654f442766b5"]}, {"cfgs": [2], "code": "TermOffsetsTokenStream tots = null", "dfgs": [2], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 274, "lineEnd": 274, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": []}, {"cfgs": [3], "code": "if( tots == null )", "dfgs": [3], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 279, "lineEnd": 279, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": []}, {"cfgs": [4], "code": "tots = new TermOffsetsTokenStream( TokenSources.getTokenStream(searcher.getReader(), docId, fieldName) )", "dfgs": [4], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 280, "lineEnd": 280, "lineMapIndex": 0, "methodParents": [10], "nodeIndex": 3, "rootcause": false, "commits": []}, {"cfgs": [], "code": "tstream = tots.getMultiValuedTokenStream( docTexts[j].length() )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 281, "lineEnd": 281, "lineMapIndex": -1, "methodParents": [14], "nodeIndex": 4, "rootcause": false, "commits": []}, {"cfgs": [], "code": "class TermOffsetsTokenStream ", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 417, "lineEnd": 417, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": []}, {"cfgs": [], "code": "TokenStream bufferedTokenStream = null", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 419, "lineEnd": 419, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": []}, {"cfgs": [], "code": "Token bufferedToken", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 420, "lineEnd": 420, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": []}, {"cfgs": [], "code": "int startOffset", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 421, "lineEnd": 421, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": []}, {"cfgs": [], "code": "int endOffset", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 422, "lineEnd": 422, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public TermOffsetsTokenStream( TokenStream tstream )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 424, "lineEnd": 424, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": []}, {"cfgs": [], "code": "bufferedTokenStream = tstream", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [6], "isDel": false, "lineBeg": 425, "lineEnd": 425, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": []}, {"cfgs": [], "code": "startOffset = 0", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [8], "isDel": false, "lineBeg": 426, "lineEnd": 426, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": []}, {"cfgs": [], "code": "bufferedToken = null", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 427, "lineEnd": 427, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 13, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public TokenStream getMultiValuedTokenStream( final int length )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 430, "lineEnd": 430, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": []}, {"cfgs": [], "code": "endOffset = startOffset + length", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [8], "isDel": false, "lineBeg": 431, "lineEnd": 431, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return new TokenStream(){Token token;public Token next() throws IOException {while( true ){if( bufferedToken == null )bufferedToken = bufferedTokenStream.next();if( bufferedToken == null ) return null;if( startOffset <= bufferedToken.startOffset() &&bufferedToken.endOffset() <= endOffset ){token = bufferedToken;bufferedToken = null;token.setStartOffset( token.startOffset() - startOffset );token.setEndOffset( token.endOffset() - startOffset );return token;}else if( bufferedToken.endOffset() > endOffset ){startOffset += length + 1;return null;}bufferedToken = null;}}}", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [6], "isDel": false, "lineBeg": 432, "lineEnd": 454, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if( bufferedToken == null )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 436, "lineEnd": 436, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": []}, {"cfgs": [], "code": "bufferedToken = bufferedTokenStream.next()", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [6], "isDel": false, "lineBeg": 437, "lineEnd": 437, "lineMapIndex": -1, "methodParents": [17], "nodeIndex": 18, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if( bufferedToken == null )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 438, "lineEnd": 438, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if( startOffset <= bufferedToken.startOffset() &&bufferedToken.endOffset() <= endOffset )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 439, "lineEnd": 440, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": []}, {"cfgs": [], "code": "token = bufferedToken", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 441, "lineEnd": 441, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": []}, {"cfgs": [], "code": "bufferedToken = null", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 442, "lineEnd": 442, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 22, "rootcause": false, "commits": []}, {"cfgs": [], "code": "token.setStartOffset( token.startOffset() - startOffset )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [8], "isDel": false, "lineBeg": 443, "lineEnd": 443, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 23, "rootcause": false, "commits": []}, {"cfgs": [], "code": "token.setEndOffset( token.endOffset() - startOffset )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [8], "isDel": false, "lineBeg": 444, "lineEnd": 444, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 24, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return token", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 445, "lineEnd": 445, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 25, "rootcause": false, "commits": []}, {"cfgs": [], "code": "if( bufferedToken.endOffset() > endOffset )", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 447, "lineEnd": 447, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": []}, {"cfgs": [], "code": "startOffset += length + 1", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [8], "isDel": false, "lineBeg": 448, "lineEnd": 448, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return null", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [], "isDel": false, "lineBeg": 449, "lineEnd": 449, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": []}, {"cfgs": [], "code": "bufferedToken = null", "dfgs": [], "fName": "src_java_org_apache_solr_highlight_DefaultSolrHighlighter.java", "fieldParents": [7], "isDel": false, "lineBeg": 451, "lineEnd": 451, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.lucene.analysis.Analyzer", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 20, "lineEnd": 20, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.lucene.analysis.Token", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 21, "lineEnd": 21, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.lucene.analysis.TokenStream", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 22, "lineEnd": 22, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.lucene.analysis.WhitespaceAnalyzer", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 23, "lineEnd": 23, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.io.IOException", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 28, "lineEnd": 28, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.io.StringReader", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 29, "lineEnd": 29, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": []}, {"cfgs": [37], "code": "public void testTermOffsetsTokenStream() throws Exception ", "dfgs": [38, 39, 40, 37, 42, 44, 45, 41, 43, 46, 48, 47], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 150, "lineEnd": 150, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": []}, {"cfgs": [38], "code": "String[] multivalued = { \"a b c d\", \"e f g\", \"h\", \"i j k l m n\" }", "dfgs": [40], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 151, "lineEnd": 151, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": []}, {"cfgs": [39], "code": "Analyzer a1 = new WhitespaceAnalyzer()", "dfgs": [39], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 152, "lineEnd": 152, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": []}, {"cfgs": [40], "code": "TermOffsetsTokenStream tots = new TermOffsetsTokenStream(a1.tokenStream( \"\", new StringReader( \"a b c d e f g h i j k l m n\" ) ) )", "dfgs": [41], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 153, "lineEnd": 154, "lineMapIndex": -1, "methodParents": [10], "nodeIndex": 39, "rootcause": false, "commits": []}, {"cfgs": [41], "code": "for( String v : multivalued )", "dfgs": [41], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 155, "lineEnd": 155, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 40, "rootcause": false, "commits": []}, {"cfgs": [42], "code": "TokenStream ts1 = tots.getMultiValuedTokenStream( v.length() )", "dfgs": [46, 43], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 156, "lineEnd": 156, "lineMapIndex": -1, "methodParents": [14], "nodeIndex": 41, "rootcause": false, "commits": []}, {"cfgs": [43], "code": "Analyzer a2 = new WhitespaceAnalyzer()", "dfgs": [43], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 157, "lineEnd": 157, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": []}, {"cfgs": [44], "code": "TokenStream ts2 = a2.tokenStream( \"\", new StringReader( v ) )", "dfgs": [47], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 158, "lineEnd": 158, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": []}, {"cfgs": [45], "code": "Token t1 = new Token()", "dfgs": [46], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 159, "lineEnd": 159, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 44, "rootcause": false, "commits": []}, {"cfgs": [46], "code": "Token t2 = new Token()", "dfgs": [47], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 160, "lineEnd": 160, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 45, "rootcause": false, "commits": []}, {"cfgs": [47], "code": "for( t1 = ts1.next( t1 ); t1 != null; t1 = ts1.next( t1 ) )", "dfgs": [48], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 161, "lineEnd": 161, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 46, "rootcause": false, "commits": []}, {"cfgs": [48], "code": "t2 = ts2.next( t2 )", "dfgs": [48], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 162, "lineEnd": 162, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 47, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertEquals( t2, t1 )", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 163, "lineEnd": 163, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 48, "rootcause": false, "commits": []}, {"cfgs": [50], "code": "public void testTermVecMultiValuedHighlight() throws Exception ", "dfgs": [50, 51, 52, 53, 55, 56, 57, 58, 54], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 168, "lineEnd": 168, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 49, "rootcause": false, "commits": []}, {"cfgs": [51], "code": "HashMap<String,String> args = new HashMap<String,String>()", "dfgs": [51], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 171, "lineEnd": 171, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 50, "rootcause": false, "commits": []}, {"cfgs": [52], "code": "args.put(\"hl\", \"true\")", "dfgs": [52], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 172, "lineEnd": 172, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 51, "rootcause": false, "commits": []}, {"cfgs": [53], "code": "args.put(\"hl.fl\", \"tv_mv_text\")", "dfgs": [53], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 173, "lineEnd": 173, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 52, "rootcause": false, "commits": []}, {"cfgs": [54], "code": "args.put(\"hl.snippets\", \"2\")", "dfgs": [54], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 174, "lineEnd": 174, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 53, "rootcause": false, "commits": []}, {"cfgs": [55], "code": "TestHarness.LocalRequestFactory sumLRF = h.getRequestFactory(\"standard\",0,200,args)", "dfgs": [58], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 175, "lineEnd": 176, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 54, "rootcause": false, "commits": []}, {"cfgs": [56], "code": "assertU(adoc(\"tv_mv_text\", LONG_TEXT, \"tv_mv_text\", LONG_TEXT,\"id\", \"1\"))", "dfgs": [56], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 178, "lineEnd": 180, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 55, "rootcause": false, "commits": []}, {"cfgs": [57], "code": "assertU(commit())", "dfgs": [57], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 181, "lineEnd": 181, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 56, "rootcause": false, "commits": []}, {"cfgs": [58], "code": "assertU(optimize())", "dfgs": [58], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 182, "lineEnd": 182, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 57, "rootcause": false, "commits": []}, {"cfgs": [], "code": "assertQ(\"Basic summarization\",sumLRF.makeRequest(\"tv_mv_text:long\"),\"//lst[@name='highlighting']/lst[@name='1']\",\"//lst[@name='1']/arr[@name='tv_mv_text']/str[.='a <em>long</em> days night this should be a piece of text which']\",\"//arr[@name='tv_mv_text']/str[.=' <em>long</em> fragments.']\")", "dfgs": [], "fName": "src_test_org_apache_solr_highlight_HighlighterTest.java", "fieldParents": [], "isDel": false, "lineBeg": 183, "lineEnd": 188, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 58, "rootcause": false, "commits": []}]