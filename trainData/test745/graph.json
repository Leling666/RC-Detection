[{"cfgs":[1],"code":"String sql = \"select \" +\"o_year, \" +\"sum(case \" +\"when nation = 'PERU' then volume \" +\"else 0 \" +\"end) as numerator, sum(volume) as denominator \" +\"from \" +\"( \" +\"select \" +\"year(o_orderdate) as o_year, \" +\"l_extendedprice * (1 - l_discount) as volume, \" +\"n2.n_name as nation \" +\"from \" +\"part, \" +\"supplier, \" +\"lineitem, \" +\"orders, \" +\"customer, \" +\"nation n1, \" +\"nation n2, \" +\"region \" +\"where \" +\"p_partkey = l_partkey \" +\"and s_suppkey = l_suppkey \" +\"and l_orderkey = o_orderkey \" +\"and o_custkey = c_custkey \" +\"and c_nationkey = n1.n_nationkey \" +\"and n1.n_regionkey = r_regionkey \" +\"and r_name = 'AMERICA' \" +\"and s_nationkey = n2.n_nationkey \" +\"and o_orderdate between '1995-01-01' and '1996-12-31' \" +\"and p_type = 'ECONOMY BURNISHED NICKEL' \" +\") as all_nations \" +\"group by \" +\"o_year \" +\"order by \" +\"o_year \" +\"Limit 1\"","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":835,"lineEnd":872,"lineMapIndex":29,"methodParents":[],"nodeIndex":0},{"cfgs":[2],"code":"assertEquals(1, queryExecutionPlan.root.dependents.get(0).dependents.size())","dfgs":[6,4,5,7],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":882,"lineEnd":882,"lineMapIndex":32,"methodParents":[],"nodeIndex":1},{"cfgs":[3],"code":"AbstractRelation lineitem = new BaseTable(\"tpch\", \"lineitem\", \"vt3\")","dfgs":[7,4,6,5],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":886,"lineEnd":886,"lineMapIndex":33,"methodParents":[],"nodeIndex":2},{"cfgs":[4],"code":"AbstractRelation orders = new BaseTable(\"tpch\", \"orders\", \"vt4\")","dfgs":[7,4,6,5],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":887,"lineEnd":887,"lineMapIndex":34,"methodParents":[],"nodeIndex":3},{"cfgs":[5],"code":"expected.addOrderby(new OrderbyAttribute(\"vc7\"))","dfgs":[5],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":961,"lineEnd":961,"lineMapIndex":36,"methodParents":[],"nodeIndex":4},{"cfgs":[6],"code":"expected.addLimit(ConstantColumn.valueOf(1))","dfgs":[6],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":962,"lineEnd":962,"lineMapIndex":37,"methodParents":[],"nodeIndex":5},{"cfgs":[7],"code":"assertEquals(expected, ((CreateTableAsSelectExecutionNode) queryExecutionPlan.root.dependents.get(0)).selectQuery)","dfgs":[7],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":963,"lineEnd":963,"lineMapIndex":39,"methodParents":[],"nodeIndex":6},{"cfgs":[],"code":"assertEquals(subquery, ((CreateTableAsSelectExecutionNode) queryExecutionPlan.root.dependents.get(0).dependents.get(0)).selectQuery)","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":true,"lineBeg":964,"lineEnd":964,"lineMapIndex":38,"methodParents":[],"nodeIndex":7},{"cfgs":[],"code":"public synchronized String getStatus() ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":84,"lineEnd":84,"lineMapIndex":40,"methodParents":[],"nodeIndex":8},{"cfgs":[],"code":"public synchronized void setStatus(String status) ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":88,"lineEnd":88,"lineMapIndex":41,"methodParents":[],"nodeIndex":9},{"cfgs":[],"code":"System.out.println(\"Starts the exec of \" + this)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":134,"lineEnd":134,"lineMapIndex":-1,"methodParents":[],"nodeIndex":10},{"cfgs":[],"code":"try ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":167,"lineEnd":167,"lineMapIndex":-1,"methodParents":[],"nodeIndex":11},{"cfgs":[],"code":"TimeUnit.SECONDS.sleep(1)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":168,"lineEnd":168,"lineMapIndex":-1,"methodParents":[],"nodeIndex":12},{"cfgs":[],"code":"System.out.println(QueryExecutionNode.this)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":169,"lineEnd":169,"lineMapIndex":-1,"methodParents":[],"nodeIndex":13},{"cfgs":[],"code":"System.out.println(successDependentCount)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":170,"lineEnd":170,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[],"code":"System.out.println(failedDependentCount)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":171,"lineEnd":171,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[],"code":"catch (InterruptedException e)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":173,"lineEnd":173,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[],"code":"e.printStackTrace()","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":175,"lineEnd":175,"lineMapIndex":-1,"methodParents":[],"nodeIndex":17},{"cfgs":[],"code":"System.out.println(QueryExecutionNode.this.latestResults)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":193,"lineEnd":193,"lineMapIndex":-1,"methodParents":[],"nodeIndex":18},{"cfgs":[],"code":"System.out.println(latestResults)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":194,"lineEnd":194,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21],"code":"try ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":64,"lineEnd":64,"lineMapIndex":-1,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"String sql = QueryToSql.convert(conn.getSyntax(), createQuery)","dfgs":[22],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":65,"lineEnd":65,"lineMapIndex":48,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"conn.executeUpdate(sql)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":66,"lineEnd":66,"lineMapIndex":49,"methodParents":[],"nodeIndex":22},{"cfgs":[24],"code":"catch (VerdictDBException e)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":67,"lineEnd":67,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[],"code":"e.printStackTrace()","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":true,"lineBeg":68,"lineEnd":68,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[],"code":"String generateUniqueIdentifier() ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionPlan.java","fieldParents":[],"isDel":true,"lineBeg":112,"lineEnd":112,"lineMapIndex":53,"methodParents":[],"nodeIndex":25},{"cfgs":[27],"code":"ExecutionTokenQueue newQueue = newNode.generateListeningQueue()","dfgs":[27],"fName":"src_main_java_org_verdictdb_core_execution_ola_AggExecutionNodeBlock.java","fieldParents":[],"isDel":true,"lineBeg":310,"lineEnd":310,"lineMapIndex":54,"methodParents":[],"nodeIndex":26},{"cfgs":[28],"code":"newNode.getListeningQueues().set(listeningQueueIdx, newQueue)","dfgs":[28],"fName":"src_main_java_org_verdictdb_core_execution_ola_AggExecutionNodeBlock.java","fieldParents":[],"isDel":true,"lineBeg":311,"lineEnd":311,"lineMapIndex":-1,"methodParents":[],"nodeIndex":27},{"cfgs":[],"code":"newNode.getListeningQueues().remove(newNode.getListeningQueues().size()-1)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_ola_AggExecutionNodeBlock.java","fieldParents":[],"isDel":true,"lineBeg":312,"lineEnd":312,"lineMapIndex":-1,"methodParents":[],"nodeIndex":28},{"cfgs":[30],"code":"String sql = \"select \" +\"o_year, \" +\"sum(case \" +\"when nation = 'PERU' then volume \" +\"else 0 \" +\"end) as numerator, sum(volume) as denominator \" +\"from \" +\"( \" +\"select \" +\"year(o_orderdate) as o_year, \" +\"l_extendedprice * (1 - l_discount) as volume, \" +\"n2.n_name as nation \" +\"from \" +\"part, \" +\"supplier, \" +\"lineitem_scrambled, \" +\"orders_scrambled, \" +\"customer, \" +\"nation n1, \" +\"nation n2, \" +\"region \" +\"where \" +\"p_partkey = l_partkey \" +\"and s_suppkey = l_suppkey \" +\"and l_orderkey = o_orderkey \" +\"and o_custkey = c_custkey \" +\"and c_nationkey = n1.n_nationkey \" +\"and n1.n_regionkey = r_regionkey \" +\"and r_name = 'AMERICA' \" +\"and s_nationkey = n2.n_nationkey \" +\"and o_orderdate between '1995-01-01' and '1996-12-31' \" +\"and p_type = 'ECONOMY BURNISHED NICKEL' \" +\") as all_nations \" +\"group by \" +\"o_year \" +\"order by \" +\"o_year \" +\"Limit 1\"","dfgs":[30],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":835,"lineEnd":872,"lineMapIndex":0,"methodParents":[],"nodeIndex":29},{"cfgs":[31],"code":"queryExecutionPlan = AsyncQueryExecutionPlan.create(queryExecutionPlan)","dfgs":[31],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":882,"lineEnd":882,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[32],"code":"queryExecutionPlan.getRootNode().print()","dfgs":[38,39],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":883,"lineEnd":883,"lineMapIndex":-1,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"assertEquals(5, queryExecutionPlan.root.dependents.get(0).dependents.size())","dfgs":[38,35,39],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":885,"lineEnd":885,"lineMapIndex":1,"methodParents":[],"nodeIndex":32},{"cfgs":[34],"code":"AbstractRelation lineitem = new BaseTable(\"tpch\", \"lineitem_scrambled\", \"vt3\")","dfgs":[35,38],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":889,"lineEnd":889,"lineMapIndex":2,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"AbstractRelation orders = new BaseTable(\"tpch\", \"orders_scrambled\", \"vt4\")","dfgs":[35,38],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":890,"lineEnd":890,"lineMapIndex":3,"methodParents":[],"nodeIndex":34},{"cfgs":[36],"code":"subquery.addFilterByAnd(ColumnOp.greaterequal(new BaseColumn(\"vt3\", \"verdictdbaggblock\"), ConstantColumn.valueOf(0)))","dfgs":[36],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":965,"lineEnd":966,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[37],"code":"subquery.addFilterByAnd(ColumnOp.lessequal(new BaseColumn(\"vt3\", \"verdictdbaggblock\"), ConstantColumn.valueOf(2)))","dfgs":[37],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":967,"lineEnd":968,"lineMapIndex":4,"methodParents":[],"nodeIndex":36},{"cfgs":[38],"code":"subquery.addFilterByAnd(ColumnOp.equal(new BaseColumn(\"vt4\", \"verdictdbaggblock\"), ConstantColumn.valueOf(0)))","dfgs":[39],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":969,"lineEnd":970,"lineMapIndex":5,"methodParents":[],"nodeIndex":37},{"cfgs":[39],"code":"assertEquals(expected, ((CreateTableAsSelectExecutionNode) queryExecutionPlan.root.getDependent(0).getDependent(0)).selectQuery)","dfgs":[39],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":975,"lineEnd":975,"lineMapIndex":7,"methodParents":[],"nodeIndex":38},{"cfgs":[],"code":"assertEquals(subquery, ((CreateTableAsSelectExecutionNode) queryExecutionPlan.root.getDependent(0).getDependent(0).getDependent(0)).selectQuery)","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_TpchAyncExecutionPlanTest.java","fieldParents":[],"isDel":false,"lineBeg":976,"lineEnd":976,"lineMapIndex":6,"methodParents":[],"nodeIndex":39},{"cfgs":[],"code":"public String getStatus() ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":84,"lineEnd":84,"lineMapIndex":8,"methodParents":[],"nodeIndex":40},{"cfgs":[],"code":"public void setStatus(String status) ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":88,"lineEnd":88,"lineMapIndex":9,"methodParents":[],"nodeIndex":41},{"cfgs":[43],"code":"public ExecutionTokenQueue generateReplacementListeningQueue(int index) throws VerdictDBValueException ","dfgs":[43,44,47,45,46],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":248,"lineEnd":248,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"ExecutionTokenQueue queue = new ExecutionTokenQueue()","dfgs":[44],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":249,"lineEnd":249,"lineMapIndex":-1,"methodParents":[],"nodeIndex":43},{"cfgs":[45],"code":"listeningQueues.set(index, queue)","dfgs":[47,45],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":250,"lineEnd":250,"lineMapIndex":-1,"methodParents":[],"nodeIndex":44},{"cfgs":[46,47],"code":"if (listeningQueues.size() != latestResults.size())","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":251,"lineEnd":251,"lineMapIndex":-1,"methodParents":[],"nodeIndex":45},{"cfgs":[47],"code":"throw new VerdictDBValueException(\"Invalid field constraint.\")","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":252,"lineEnd":252,"lineMapIndex":-1,"methodParents":[],"nodeIndex":46},{"cfgs":[],"code":"return queue","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":254,"lineEnd":254,"lineMapIndex":-1,"methodParents":[],"nodeIndex":47},{"cfgs":[49],"code":"String sql = QueryToSql.convert(conn.getSyntax(), createQuery)","dfgs":[49],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":64,"lineEnd":64,"lineMapIndex":21,"methodParents":[],"nodeIndex":48},{"cfgs":[],"code":"conn.executeUpdate(sql)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_CreateTableAsSelectExecutionNode.java","fieldParents":[],"isDel":false,"lineBeg":65,"lineEnd":65,"lineMapIndex":22,"methodParents":[],"nodeIndex":49},{"cfgs":[51],"code":"void copyFields(QueryExecutionNodeWithPlaceHolders from, QueryExecutionNodeWithPlaceHolders to) ","dfgs":[51],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNodeWithPlaceHolders.java","fieldParents":[],"isDel":false,"lineBeg":54,"lineEnd":54,"lineMapIndex":-1,"methodParents":[],"nodeIndex":50},{"cfgs":[52],"code":"super.copyFields(from, to)","dfgs":[52],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNodeWithPlaceHolders.java","fieldParents":[],"isDel":false,"lineBeg":55,"lineEnd":55,"lineMapIndex":-1,"methodParents":[50],"nodeIndex":51},{"cfgs":[],"code":"to.placeholderTables = from.placeholderTables","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionNodeWithPlaceHolders.java","fieldParents":[],"isDel":false,"lineBeg":56,"lineEnd":56,"lineMapIndex":-1,"methodParents":[],"nodeIndex":52},{"cfgs":[],"code":"synchronized String generateUniqueIdentifier() ","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_QueryExecutionPlan.java","fieldParents":[],"isDel":false,"lineBeg":112,"lineEnd":112,"lineMapIndex":25,"methodParents":[],"nodeIndex":53},{"cfgs":[],"code":"ExecutionTokenQueue newQueue = newNode.generateReplacementListeningQueue(listeningQueueIdx)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_ola_AggExecutionNodeBlock.java","fieldParents":[],"isDel":false,"lineBeg":310,"lineEnd":310,"lineMapIndex":26,"methodParents":[42],"nodeIndex":54}]