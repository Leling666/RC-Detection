[{"cfgs":[1],"code":"admin.addCluster(clusterName, false)","dfgs":[3],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":126,"lineEnd":126,"lineMapIndex":11,"methodParents":[],"nodeIndex":0},{"cfgs":[2],"code":"List<String> nodes = Collections.EMPTY_LIST","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":129,"lineEnd":129,"lineMapIndex":-1,"methodParents":[],"nodeIndex":1},{"cfgs":[3],"code":"try ","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":130,"lineEnd":130,"lineMapIndex":-1,"methodParents":[],"nodeIndex":2},{"cfgs":[7,4],"code":"nodes =  admin.getInstancesInCluster(clusterName)","dfgs":[7,9,6],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":131,"lineEnd":131,"lineMapIndex":18,"methodParents":[],"nodeIndex":3},{"cfgs":[5],"code":"catch (ZkNoNodeException ex)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":132,"lineEnd":132,"lineMapIndex":-1,"methodParents":[],"nodeIndex":4},{"cfgs":[6],"code":"LOG.warn(\"Child znode under /\" + CLUSTER_NAME + \" not found.Recreating the cluster.\")","dfgs":[8],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":133,"lineEnd":133,"lineMapIndex":31,"methodParents":[],"nodeIndex":5},{"cfgs":[7],"code":"admin.addCluster(clusterName, true)","dfgs":[9],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":134,"lineEnd":134,"lineMapIndex":32,"methodParents":[],"nodeIndex":6},{"cfgs":[8],"code":"if (CollectionUtils.isEmpty(nodes) || !nodes.contains(instanceConfig.getInstanceName()))","dfgs":[8,9],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":137,"lineEnd":137,"lineMapIndex":34,"methodParents":[],"nodeIndex":7},{"cfgs":[9],"code":"LOG.info(\"Adding participant instance \" + instanceConfig)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":138,"lineEnd":138,"lineMapIndex":35,"methodParents":[],"nodeIndex":8},{"cfgs":[],"code":"admin.addInstance(clusterName, instanceConfig)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":true,"lineBeg":139,"lineEnd":139,"lineMapIndex":36,"methodParents":[],"nodeIndex":9},{"cfgs":[],"code":"import org.apache.helix.HelixException","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":29,"lineEnd":29,"lineMapIndex":-1,"methodParents":[],"nodeIndex":10},{"cfgs":[12],"code":"boolean clusterAdded = admin.addCluster(clusterName, false)","dfgs":[12,31,32,18],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":127,"lineEnd":127,"lineMapIndex":0,"methodParents":[],"nodeIndex":11},{"cfgs":[13],"code":"LOG.info(\"Was cluster added successfully? \" + clusterAdded)","dfgs":[31,24,20],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":128,"lineEnd":128,"lineMapIndex":-1,"methodParents":[],"nodeIndex":12},{"cfgs":[14],"code":"boolean success = false","dfgs":[30,16],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":131,"lineEnd":131,"lineMapIndex":-1,"methodParents":[],"nodeIndex":13},{"cfgs":[15],"code":"int tries = 5","dfgs":[16],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":132,"lineEnd":132,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[16],"code":"int sleepTimeInSeconds = 5","dfgs":[26,27],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":133,"lineEnd":133,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[30,17],"code":"for (int i = 0; i < tries && !success; i++)","dfgs":[30,25],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":135,"lineEnd":135,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[18],"code":"try ","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":136,"lineEnd":136,"lineMapIndex":-1,"methodParents":[],"nodeIndex":17},{"cfgs":[19],"code":"List<String> nodes = admin.getInstancesInCluster(clusterName)","dfgs":[31,32,19,21],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":137,"lineEnd":137,"lineMapIndex":3,"methodParents":[],"nodeIndex":18},{"cfgs":[20,23],"code":"if (CollectionUtils.isEmpty(nodes) || !nodes.contains(instanceConfig.getInstanceName()))","dfgs":[34,35,36,20,21],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":138,"lineEnd":138,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21],"code":"LOG.info(\"Adding participant instance \" + instanceConfig)","dfgs":[31,24],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":139,"lineEnd":139,"lineMapIndex":-1,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"admin.addInstance(clusterName, instanceConfig)","dfgs":[31,32,35,36,34],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":140,"lineEnd":140,"lineMapIndex":-1,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"success = true","dfgs":[30],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":141,"lineEnd":141,"lineMapIndex":-1,"methodParents":[],"nodeIndex":22},{"cfgs":[24],"code":"catch (HelixException | ZkNoNodeException ex)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":143,"lineEnd":143,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[25],"code":"LOG.warn(\"Helix Cluster not yet setup fully.\")","dfgs":[26,29],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":144,"lineEnd":144,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[26,28],"code":"if (i < tries - 1)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":145,"lineEnd":145,"lineMapIndex":-1,"methodParents":[],"nodeIndex":25},{"cfgs":[27],"code":"LOG.info(\"Waiting for \" + sleepTimeInSeconds + \" seconds and retrying.\")","dfgs":[31],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":146,"lineEnd":146,"lineMapIndex":-1,"methodParents":[],"nodeIndex":26},{"cfgs":[],"code":"TimeUnit.SECONDS.sleep(sleepTimeInSeconds)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":147,"lineEnd":147,"lineMapIndex":-1,"methodParents":[],"nodeIndex":27},{"cfgs":[29],"code":"else","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":148,"lineEnd":148,"lineMapIndex":-1,"methodParents":[],"nodeIndex":28},{"cfgs":[],"code":"LOG.error(ex)","dfgs":[31],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":149,"lineEnd":149,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[31],"code":"if (!success)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":154,"lineEnd":154,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[32],"code":"LOG.info(\"Trying to create \" + clusterName + \" again since waiting for the creation did not help.\")","dfgs":[35],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":155,"lineEnd":155,"lineMapIndex":5,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"admin.addCluster(clusterName, true)","dfgs":[33],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":156,"lineEnd":156,"lineMapIndex":6,"methodParents":[],"nodeIndex":32},{"cfgs":[34],"code":"List<String> nodes = admin.getInstancesInCluster(clusterName)","dfgs":[34,36],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":157,"lineEnd":157,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"if (CollectionUtils.isEmpty(nodes) || !nodes.contains(instanceConfig.getInstanceName()))","dfgs":[35,36],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":158,"lineEnd":158,"lineMapIndex":7,"methodParents":[],"nodeIndex":34},{"cfgs":[36],"code":"LOG.info(\"Adding participant instance \" + instanceConfig)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":159,"lineEnd":159,"lineMapIndex":8,"methodParents":[],"nodeIndex":35},{"cfgs":[],"code":"admin.addInstance(clusterName, instanceConfig)","dfgs":[],"fName":"ambari-metrics_ambari-metrics-timelineservice_src_main_java_org_apache_hadoop_yarn_server_applicationhistoryservice_metrics_timeline_availability_MetricCollectorHAController.java","fieldParents":[],"isDel":false,"lineBeg":160,"lineEnd":160,"lineMapIndex":9,"methodParents":[],"nodeIndex":36}]