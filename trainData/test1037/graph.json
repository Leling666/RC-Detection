[{"cfgs":[1],"code":"private static final String URL_REGEX =\"^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?\"","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":110,"lineEnd":111,"lineMapIndex":-1,"methodParents":[],"nodeIndex":0},{"cfgs":[2],"code":"private static final Pattern URL_PATTERN = Pattern.compile(URL_REGEX)","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":113,"lineEnd":113,"lineMapIndex":-1,"methodParents":[],"nodeIndex":1},{"cfgs":[3],"code":"private static final int PARSE_URL_SCHEME = 2","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":118,"lineEnd":118,"lineMapIndex":-1,"methodParents":[],"nodeIndex":2},{"cfgs":[4],"code":"private static final int PARSE_URL_AUTHORITY = 4","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":123,"lineEnd":123,"lineMapIndex":-1,"methodParents":[],"nodeIndex":3},{"cfgs":[5],"code":"private static final int PARSE_URL_PATH = 5","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":125,"lineEnd":125,"lineMapIndex":-1,"methodParents":[],"nodeIndex":4},{"cfgs":[6],"code":"private static final int PARSE_URL_QUERY = 7","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":127,"lineEnd":127,"lineMapIndex":-1,"methodParents":[],"nodeIndex":5},{"cfgs":[],"code":"private static final int PARSE_URL_FRAGMENT = 9","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":129,"lineEnd":129,"lineMapIndex":-1,"methodParents":[],"nodeIndex":6},{"cfgs":[8],"code":"Matcher urlMatcher = URL_PATTERN.matcher(value)","dfgs":[8],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[1],"isDel":true,"lineBeg":305,"lineEnd":305,"lineMapIndex":-1,"methodParents":[],"nodeIndex":7},{"cfgs":[9],"code":"if (!urlMatcher.matches())","dfgs":[9],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":306,"lineEnd":306,"lineMapIndex":-1,"methodParents":[],"nodeIndex":8},{"cfgs":[10],"code":"String scheme = urlMatcher.group(PARSE_URL_SCHEME)","dfgs":[10,11],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[2],"isDel":true,"lineBeg":310,"lineEnd":310,"lineMapIndex":43,"methodParents":[],"nodeIndex":9},{"cfgs":[11],"code":"String authority = urlMatcher.group(PARSE_URL_AUTHORITY)","dfgs":[11],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[3],"isDel":true,"lineBeg":315,"lineEnd":315,"lineMapIndex":44,"methodParents":[],"nodeIndex":10},{"cfgs":[12],"code":"if (!isValidPath(urlMatcher.group(PARSE_URL_PATH)))","dfgs":[12],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[4],"isDel":true,"lineBeg":327,"lineEnd":327,"lineMapIndex":45,"methodParents":[],"nodeIndex":11},{"cfgs":[13],"code":"if (!isValidQuery(urlMatcher.group(PARSE_URL_QUERY)))","dfgs":[13],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[5],"isDel":true,"lineBeg":331,"lineEnd":331,"lineMapIndex":46,"methodParents":[],"nodeIndex":12},{"cfgs":[],"code":"if (!isValidFragment(urlMatcher.group(PARSE_URL_FRAGMENT)))","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[6],"isDel":true,"lineBeg":335,"lineEnd":335,"lineMapIndex":47,"methodParents":[],"nodeIndex":13},{"cfgs":[15],"code":"Matcher matchURL(String value) ","dfgs":[15],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":540,"lineEnd":540,"lineMapIndex":-1,"methodParents":[],"nodeIndex":14},{"cfgs":[],"code":"return URL_PATTERN.matcher(value)","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[1],"isDel":true,"lineBeg":541,"lineEnd":541,"lineMapIndex":-1,"methodParents":[],"nodeIndex":15},{"cfgs":[17],"code":"UrlValidator val = new UrlValidator(new String[] { \"file\", \"http\", \"https\" }, UrlValidator.ALLOW_LOCAL_URLS)","dfgs":[17],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":549,"lineEnd":549,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[18],"code":"Matcher m = val.matchURL(arg)","dfgs":[18,19,28,35],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":570,"lineEnd":570,"lineMapIndex":-1,"methodParents":[14],"nodeIndex":17},{"cfgs":[19,34],"code":"if (m.matches())","dfgs":[19],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":571,"lineEnd":571,"lineMapIndex":-1,"methodParents":[],"nodeIndex":18},{"cfgs":[20],"code":"System.out.printf(\"%s has %d parts%n\",arg,m.groupCount())","dfgs":[28,20,32,23],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":572,"lineEnd":572,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21,24],"code":"for(int i=1;i <m.groupCount(); i++)","dfgs":[24,21],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":573,"lineEnd":573,"lineMapIndex":-1,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"String grp = m.group(i)","dfgs":[22,23],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":574,"lineEnd":574,"lineMapIndex":-1,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"if (grp != null)","dfgs":[23],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":575,"lineEnd":575,"lineMapIndex":-1,"methodParents":[],"nodeIndex":22},{"cfgs":[],"code":"System.out.printf(\"%d: %s%n\",i, grp)","dfgs":[28],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":576,"lineEnd":576,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[25],"code":"String authority = m.group(PARSE_URL_AUTHORITY)","dfgs":[25,28],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[3],"isDel":true,"lineBeg":579,"lineEnd":579,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[26],"code":"String path = m.group(PARSE_URL_PATH)","dfgs":[26,29],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[4],"isDel":true,"lineBeg":580,"lineEnd":580,"lineMapIndex":-1,"methodParents":[],"nodeIndex":25},{"cfgs":[27],"code":"String query = m.group(PARSE_URL_QUERY)","dfgs":[27,30],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[5],"isDel":true,"lineBeg":581,"lineEnd":581,"lineMapIndex":-1,"methodParents":[],"nodeIndex":26},{"cfgs":[28],"code":"String frag = m.group(PARSE_URL_FRAGMENT)","dfgs":[31],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[6],"isDel":true,"lineBeg":582,"lineEnd":582,"lineMapIndex":-1,"methodParents":[],"nodeIndex":27},{"cfgs":[29],"code":"System.out.printf(\"auth: %s %s%n\", authority,val.isValidAuthority(authority))","dfgs":[29],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":583,"lineEnd":583,"lineMapIndex":-1,"methodParents":[],"nodeIndex":28},{"cfgs":[30],"code":"System.out.printf(\"path: %s %s%n\", path,val.isValidPath(path))","dfgs":[30],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":584,"lineEnd":584,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[31],"code":"System.out.printf(\"query: %s %s%n\", query,val.isValidQuery(query))","dfgs":[31],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":585,"lineEnd":585,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[32],"code":"System.out.printf(\"frag: %s %s%n\", frag,val.isValidFragment(frag))","dfgs":[32],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":586,"lineEnd":586,"lineMapIndex":-1,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"System.out.printf(\"valid: %s %s%n\", arg,val.isValid(arg))","dfgs":[33],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":587,"lineEnd":587,"lineMapIndex":-1,"methodParents":[7],"nodeIndex":32},{"cfgs":[],"code":"System.out.println()","dfgs":[35],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":588,"lineEnd":588,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"else","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":589,"lineEnd":589,"lineMapIndex":-1,"methodParents":[],"nodeIndex":34},{"cfgs":[],"code":"System.out.printf(\"%s is not valid%n\",arg)","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":true,"lineBeg":590,"lineEnd":590,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[],"code":"assertTrue(\"file:///c:\\\\ should be allowed\",validator.isValid(\"file:///C:\\\\some.file\"))","dfgs":[],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":true,"lineBeg":257,"lineEnd":258,"lineMapIndex":48,"methodParents":[],"nodeIndex":36},{"cfgs":[38],"code":"String fileOK = \"file:///bad ^ domain.com/label/test\"","dfgs":[38],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":true,"lineBeg":336,"lineEnd":336,"lineMapIndex":-1,"methodParents":[],"nodeIndex":37},{"cfgs":[],"code":"assertTrue(fileOK, urlValidator.isValid(fileOK))","dfgs":[],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":true,"lineBeg":338,"lineEnd":338,"lineMapIndex":-1,"methodParents":[7],"nodeIndex":38},{"cfgs":[],"code":"URI uri","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":280,"lineEnd":280,"lineMapIndex":-1,"methodParents":[],"nodeIndex":39},{"cfgs":[41],"code":"try ","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":281,"lineEnd":281,"lineMapIndex":-1,"methodParents":[],"nodeIndex":40},{"cfgs":[43,42],"code":"uri = new URI(value)","dfgs":[43],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":282,"lineEnd":282,"lineMapIndex":-1,"methodParents":[],"nodeIndex":41},{"cfgs":[],"code":"catch (URISyntaxException e)","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":283,"lineEnd":283,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"String scheme = uri.getScheme()","dfgs":[44,45],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":288,"lineEnd":288,"lineMapIndex":9,"methodParents":[],"nodeIndex":43},{"cfgs":[45],"code":"String authority = uri.getRawAuthority()","dfgs":[45],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":293,"lineEnd":293,"lineMapIndex":10,"methodParents":[],"nodeIndex":44},{"cfgs":[46],"code":"if (!isValidPath(uri.getRawPath()))","dfgs":[46],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":305,"lineEnd":305,"lineMapIndex":11,"methodParents":[],"nodeIndex":45},{"cfgs":[47],"code":"if (!isValidQuery(uri.getRawQuery()))","dfgs":[47],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":309,"lineEnd":309,"lineMapIndex":12,"methodParents":[],"nodeIndex":46},{"cfgs":[],"code":"if (!isValidFragment(uri.getRawFragment()))","dfgs":[],"fName":"src_main_java_org_apache_commons_validator_routines_UrlValidator.java","fieldParents":[],"isDel":false,"lineBeg":313,"lineEnd":313,"lineMapIndex":13,"methodParents":[],"nodeIndex":47},{"cfgs":[],"code":"assertFalse(\"file:///c:\\\\ should not be allowed\", // Only allow forward slashesvalidator.isValid(\"file:///C:\\\\some.file\"))","dfgs":[],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":257,"lineEnd":258,"lineMapIndex":36,"methodParents":[],"nodeIndex":48},{"cfgs":[50],"code":"public void testValidator283() ","dfgs":[50,51,52],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":520,"lineEnd":520,"lineMapIndex":-1,"methodParents":[],"nodeIndex":49},{"cfgs":[51],"code":"UrlValidator validator = new UrlValidator()","dfgs":[51],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":521,"lineEnd":521,"lineMapIndex":-1,"methodParents":[],"nodeIndex":50},{"cfgs":[52],"code":"assertFalse(validator.isValid(\"http://finance.yahoo.com/news/Owners-54B-NY-housing-apf-2493139299.html?x=0&ap=%fr\"))","dfgs":[52],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":522,"lineEnd":522,"lineMapIndex":-1,"methodParents":[39],"nodeIndex":51},{"cfgs":[],"code":"assertTrue(validator.isValid(\"http://finance.yahoo.com/news/Owners-54B-NY-housing-apf-2493139299.html?x=0&ap=%22\"))","dfgs":[],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":523,"lineEnd":523,"lineMapIndex":-1,"methodParents":[39],"nodeIndex":52},{"cfgs":[54],"code":"public void testFragments() ","dfgs":[55,57,56,58,54],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":526,"lineEnd":526,"lineMapIndex":-1,"methodParents":[],"nodeIndex":53},{"cfgs":[55],"code":"String[] schemes = {\"http\",\"https\"}","dfgs":[55],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":527,"lineEnd":527,"lineMapIndex":-1,"methodParents":[],"nodeIndex":54},{"cfgs":[56],"code":"UrlValidator urlValidator = new UrlValidator(schemes, UrlValidator.NO_FRAGMENTS)","dfgs":[57,56],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":528,"lineEnd":528,"lineMapIndex":-1,"methodParents":[],"nodeIndex":55},{"cfgs":[57],"code":"assertFalse(urlValidator.isValid(\"http://apache.org/a/b/c#frag\"))","dfgs":[58],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":529,"lineEnd":529,"lineMapIndex":-1,"methodParents":[39],"nodeIndex":56},{"cfgs":[58],"code":"urlValidator = new UrlValidator(schemes)","dfgs":[58],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":530,"lineEnd":530,"lineMapIndex":-1,"methodParents":[],"nodeIndex":57},{"cfgs":[],"code":"assertTrue(urlValidator.isValid(\"http://apache.org/a/b/c#frag\"))","dfgs":[],"fName":"src_test_java_org_apache_commons_validator_routines_UrlValidatorTest.java","fieldParents":[],"isDel":false,"lineBeg":531,"lineEnd":531,"lineMapIndex":-1,"methodParents":[39],"nodeIndex":58}]