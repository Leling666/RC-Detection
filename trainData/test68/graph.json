[{"cfgs":[],"code":"import static org.apache.ambari.server.orm.DBAccessor.DbType.ORACLE","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":63,"lineEnd":63,"lineMapIndex":71,"methodParents":[],"nodeIndex":0},{"cfgs":[],"code":"import static org.apache.ambari.server.orm.dao.DaoUtils.ORACLE_LIST_LIMIT","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":64,"lineEnd":64,"lineMapIndex":72,"methodParents":[],"nodeIndex":1},{"cfgs":[],"code":"if (!hostRoleCommandStatusSummaryCacheEnabled )","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":133,"lineEnd":133,"lineMapIndex":80,"methodParents":[],"nodeIndex":2},{"cfgs":[4,5],"code":"if ( !hostRoleCommandStatusSummaryCacheEnabled )","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":147,"lineEnd":147,"lineMapIndex":79,"methodParents":[],"nodeIndex":3},{"cfgs":[5],"code":"if (stageEntity != null)","dfgs":[5],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":154,"lineEnd":154,"lineMapIndex":81,"methodParents":[],"nodeIndex":4},{"cfgs":[],"code":"if (requestId != null)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":158,"lineEnd":158,"lineMapIndex":82,"methodParents":[],"nodeIndex":5},{"cfgs":[7],"code":"TypedQuery<HostRoleCommandStatusSummaryDTO> query = entityManagerProvider.get().createQuery(SUMMARY_DTO, HostRoleCommandStatusSummaryDTO.class)","dfgs":[7],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":174,"lineEnd":175,"lineMapIndex":86,"methodParents":[],"nodeIndex":6},{"cfgs":[8],"code":"query.setParameter(\"requestId\", requestId)","dfgs":[8],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":177,"lineEnd":177,"lineMapIndex":87,"methodParents":[],"nodeIndex":7},{"cfgs":[9],"code":"query.setParameter(\"aborted\", HostRoleStatus.ABORTED)","dfgs":[9],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":178,"lineEnd":178,"lineMapIndex":88,"methodParents":[],"nodeIndex":8},{"cfgs":[10],"code":"query.setParameter(\"completed\", HostRoleStatus.COMPLETED)","dfgs":[10],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":179,"lineEnd":179,"lineMapIndex":89,"methodParents":[],"nodeIndex":9},{"cfgs":[11],"code":"query.setParameter(\"failed\", HostRoleStatus.FAILED)","dfgs":[11],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":180,"lineEnd":180,"lineMapIndex":90,"methodParents":[],"nodeIndex":10},{"cfgs":[12],"code":"query.setParameter(\"holding\", HostRoleStatus.HOLDING)","dfgs":[12],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":181,"lineEnd":181,"lineMapIndex":91,"methodParents":[],"nodeIndex":11},{"cfgs":[13],"code":"query.setParameter(\"holding_failed\", HostRoleStatus.HOLDING_FAILED)","dfgs":[13],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":182,"lineEnd":182,"lineMapIndex":92,"methodParents":[],"nodeIndex":12},{"cfgs":[14],"code":"query.setParameter(\"holding_timedout\", HostRoleStatus.HOLDING_TIMEDOUT)","dfgs":[14],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":183,"lineEnd":183,"lineMapIndex":93,"methodParents":[],"nodeIndex":13},{"cfgs":[15],"code":"query.setParameter(\"in_progress\", HostRoleStatus.IN_PROGRESS)","dfgs":[15],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":184,"lineEnd":184,"lineMapIndex":94,"methodParents":[],"nodeIndex":14},{"cfgs":[16],"code":"query.setParameter(\"pending\", HostRoleStatus.PENDING)","dfgs":[16],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":185,"lineEnd":185,"lineMapIndex":95,"methodParents":[],"nodeIndex":15},{"cfgs":[17],"code":"query.setParameter(\"queued\", HostRoleStatus.QUEUED)","dfgs":[17],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":186,"lineEnd":186,"lineMapIndex":96,"methodParents":[],"nodeIndex":16},{"cfgs":[18],"code":"query.setParameter(\"timedout\", HostRoleStatus.TIMEDOUT)","dfgs":[18],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":187,"lineEnd":187,"lineMapIndex":97,"methodParents":[],"nodeIndex":17},{"cfgs":[19],"code":"query.setParameter(\"skipped_failed\", HostRoleStatus.SKIPPED_FAILED)","dfgs":[19],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":188,"lineEnd":188,"lineMapIndex":98,"methodParents":[],"nodeIndex":18},{"cfgs":[20],"code":"for (HostRoleCommandStatusSummaryDTO dto : daoUtils.selectList(query))","dfgs":[20],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":192,"lineEnd":192,"lineMapIndex":99,"methodParents":[],"nodeIndex":19},{"cfgs":[],"code":"map.put(dto.getStageId(), dto)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":193,"lineEnd":193,"lineMapIndex":100,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"@Injectpublic HostRoleCommandDAO(@Named(HRC_STATUS_SUMMARY_CACHE_ENABLED) boolean hostRoleCommandStatusSummaryCacheEnabled, @Named(HRC_STATUS_SUMMARY_CACHE_SIZE) long hostRoleCommandStatusSummaryCacheLimit, @Named(HRC_STATUS_SUMMARY_CACHE_EXPIRY_DURATION_MINUTES) long hostRoleCommandStatusSummaryCacheExpiryDurationMins)","dfgs":[22],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":199,"lineEnd":200,"lineMapIndex":103,"methodParents":[],"nodeIndex":21},{"cfgs":[],"code":"hrcStatusSummaryCache = CacheBuilder.newBuilder().maximumSize(hostRoleCommandStatusSummaryCacheLimit).expireAfterAccess(hostRoleCommandStatusSummaryCacheExpiryDurationMins, TimeUnit.MINUTES).build(new CacheLoader<Long, Map<Long, HostRoleCommandStatusSummaryDTO>>() {@Overridepublic Map<Long, HostRoleCommandStatusSummaryDTO> load(Long requestId) throws Exception {LOG.debug(\"Cache miss for host role command status summary object for request {}, fetching from JPA\", requestId);Map<Long, HostRoleCommandStatusSummaryDTO> hrcCommandStatusByStageId = loadAggregateCounts(requestId);return hrcCommandStatusByStageId;}})","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":206,"lineEnd":217,"lineMapIndex":104,"methodParents":[],"nodeIndex":22},{"cfgs":[],"code":"public void create(HostRoleCommandEntity stageEntity) ","dfgs":[24],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":545,"lineEnd":545,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[25],"code":"entityManagerProvider.get().persist(stageEntity)","dfgs":[25],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":546,"lineEnd":546,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[],"code":"invalidateHostRoleCommandStatusCache(stageEntity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":548,"lineEnd":548,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":25},{"cfgs":[27],"code":"public HostRoleCommandEntity merge(HostRoleCommandEntity stageEntity) ","dfgs":[27],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":552,"lineEnd":552,"lineMapIndex":-1,"methodParents":[],"nodeIndex":26},{"cfgs":[],"code":"HostRoleCommandEntity entity = entityManagerProvider.get().merge(stageEntity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":553,"lineEnd":553,"lineMapIndex":-1,"methodParents":[26],"nodeIndex":27},{"cfgs":[],"code":"managedList.add(entityManagerProvider.get().merge(entity))","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":572,"lineEnd":572,"lineMapIndex":113,"methodParents":[26],"nodeIndex":28},{"cfgs":[],"code":"public void remove(HostRoleCommandEntity stageEntity) ","dfgs":[30],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":580,"lineEnd":580,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[31],"code":"entityManagerProvider.get().remove(merge(stageEntity))","dfgs":[31],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":581,"lineEnd":581,"lineMapIndex":-1,"methodParents":[29],"nodeIndex":30},{"cfgs":[],"code":"invalidateHostRoleCommandStatusCache(stageEntity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":583,"lineEnd":583,"lineMapIndex":-1,"methodParents":[3],"nodeIndex":31},{"cfgs":[33],"code":"if (hostRoleCommandStatusSummaryCacheEnabled)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":598,"lineEnd":598,"lineMapIndex":118,"methodParents":[],"nodeIndex":32},{"cfgs":[],"code":"else","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":true,"lineBeg":600,"lineEnd":600,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[],"code":"import com.google.inject.Inject","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":21,"lineEnd":21,"lineMapIndex":125,"methodParents":[],"nodeIndex":34},{"cfgs":[],"code":"import com.google.inject.persist.Transactional","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":22,"lineEnd":22,"lineMapIndex":126,"methodParents":[],"nodeIndex":35},{"cfgs":[],"code":"import com.google.inject.persist.UnitOfWork","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":23,"lineEnd":23,"lineMapIndex":127,"methodParents":[],"nodeIndex":36},{"cfgs":[],"code":"import com.google.inject.persist.jpa.AmbariJpaPersistService","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":24,"lineEnd":24,"lineMapIndex":128,"methodParents":[],"nodeIndex":37},{"cfgs":[],"code":"import javax.persistence.EntityManager","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":31,"lineEnd":31,"lineMapIndex":122,"methodParents":[],"nodeIndex":38},{"cfgs":[],"code":"import javax.persistence.EntityTransaction","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":32,"lineEnd":32,"lineMapIndex":123,"methodParents":[],"nodeIndex":39},{"cfgs":[],"code":"import javax.persistence.PersistenceException","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":33,"lineEnd":33,"lineMapIndex":124,"methodParents":[],"nodeIndex":40},{"cfgs":[],"code":"import java.lang.reflect.Method","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":34,"lineEnd":34,"lineMapIndex":120,"methodParents":[],"nodeIndex":41},{"cfgs":[],"code":"import java.sql.SQLException","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":35,"lineEnd":35,"lineMapIndex":121,"methodParents":[],"nodeIndex":42},{"cfgs":[],"code":"EntityManager em = this.emProvider.get()","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":56,"lineEnd":56,"lineMapIndex":129,"methodParents":[],"nodeIndex":43},{"cfgs":[],"code":"Object result","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":true,"lineBeg":66,"lineEnd":66,"lineMapIndex":130,"methodParents":[],"nodeIndex":44},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":true,"lineBeg":201,"lineEnd":201,"lineMapIndex":132,"methodParents":[28],"nodeIndex":45},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":true,"lineBeg":217,"lineEnd":217,"lineMapIndex":134,"methodParents":[28],"nodeIndex":46},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commandEntities)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":true,"lineBeg":478,"lineEnd":478,"lineMapIndex":136,"methodParents":[28],"nodeIndex":47},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":true,"lineBeg":529,"lineEnd":529,"lineMapIndex":138,"methodParents":[28],"nodeIndex":48},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(tasks)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":true,"lineBeg":726,"lineEnd":726,"lineMapIndex":140,"methodParents":[28],"nodeIndex":49},{"cfgs":[],"code":"import com.google.common.collect.Lists","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":20,"lineEnd":20,"lineMapIndex":150,"methodParents":[],"nodeIndex":50},{"cfgs":[],"code":"import com.google.inject.Inject","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":21,"lineEnd":21,"lineMapIndex":151,"methodParents":[],"nodeIndex":51},{"cfgs":[],"code":"import com.google.inject.Singleton","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":22,"lineEnd":22,"lineMapIndex":152,"methodParents":[],"nodeIndex":52},{"cfgs":[],"code":"import com.google.inject.persist.PersistModule","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":23,"lineEnd":23,"lineMapIndex":153,"methodParents":[],"nodeIndex":53},{"cfgs":[],"code":"import com.google.inject.persist.PersistService","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":24,"lineEnd":24,"lineMapIndex":154,"methodParents":[],"nodeIndex":54},{"cfgs":[],"code":"import com.google.inject.persist.UnitOfWork","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":25,"lineEnd":25,"lineMapIndex":155,"methodParents":[],"nodeIndex":55},{"cfgs":[],"code":"import com.google.inject.persist.finder.DynamicFinder","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":26,"lineEnd":26,"lineMapIndex":156,"methodParents":[],"nodeIndex":56},{"cfgs":[],"code":"import com.google.inject.persist.finder.Finder","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":27,"lineEnd":27,"lineMapIndex":157,"methodParents":[],"nodeIndex":57},{"cfgs":[],"code":"import com.google.inject.util.Providers","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":28,"lineEnd":28,"lineMapIndex":158,"methodParents":[],"nodeIndex":58},{"cfgs":[],"code":"import org.aopalliance.intercept.MethodInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":29,"lineEnd":29,"lineMapIndex":143,"methodParents":[],"nodeIndex":59},{"cfgs":[],"code":"import org.aopalliance.intercept.MethodInvocation","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":30,"lineEnd":30,"lineMapIndex":144,"methodParents":[],"nodeIndex":60},{"cfgs":[],"code":"import org.apache.ambari.server.orm.AmbariJpaLocalTxnInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":31,"lineEnd":31,"lineMapIndex":146,"methodParents":[],"nodeIndex":61},{"cfgs":[],"code":"import org.apache.ambari.server.orm.AmbariLocalSessionInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":32,"lineEnd":32,"lineMapIndex":147,"methodParents":[],"nodeIndex":62},{"cfgs":[],"code":"import org.apache.ambari.server.orm.RequiresSession","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":33,"lineEnd":33,"lineMapIndex":149,"methodParents":[],"nodeIndex":63},{"cfgs":[],"code":"import javax.persistence.EntityManager","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":38,"lineEnd":38,"lineMapIndex":141,"methodParents":[],"nodeIndex":64},{"cfgs":[],"code":"import javax.persistence.EntityManagerFactory","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":39,"lineEnd":39,"lineMapIndex":142,"methodParents":[],"nodeIndex":65},{"cfgs":[],"code":"private MethodInterceptor sessionInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":63,"lineEnd":63,"lineMapIndex":-1,"methodParents":[],"nodeIndex":66},{"cfgs":[68],"code":"bind(Properties.class).annotatedWith(Jpa.class).toProvider(Providers.<Properties>of(null))","dfgs":[68],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":71,"lineEnd":72,"lineMapIndex":159,"methodParents":[],"nodeIndex":67},{"cfgs":[69],"code":"bind(EntityManagerFactory.class).toProvider(JpaPersistService.EntityManagerFactoryProvider.class)","dfgs":[70],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":true,"lineBeg":80,"lineEnd":81,"lineMapIndex":160,"methodParents":[],"nodeIndex":68},{"cfgs":[70],"code":"sessionInterceptor = new AmbariLocalSessionInterceptor()","dfgs":[70],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[66],"isDel":true,"lineBeg":87,"lineEnd":87,"lineMapIndex":161,"methodParents":[],"nodeIndex":69},{"cfgs":[],"code":"requestInjection(sessionInterceptor)","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[66],"isDel":true,"lineBeg":88,"lineEnd":88,"lineMapIndex":162,"methodParents":[],"nodeIndex":70},{"cfgs":[],"code":"import static org.apache.ambari.server.orm.DBAccessor.DbType.ORACLE","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":21,"lineEnd":21,"lineMapIndex":0,"methodParents":[],"nodeIndex":71},{"cfgs":[],"code":"import static org.apache.ambari.server.orm.dao.DaoUtils.ORACLE_LIST_LIMIT","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":22,"lineEnd":22,"lineMapIndex":1,"methodParents":[],"nodeIndex":72},{"cfgs":[],"code":"import java.util.concurrent.locks.ReadWriteLock","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":32,"lineEnd":32,"lineMapIndex":-1,"methodParents":[],"nodeIndex":73},{"cfgs":[],"code":"import org.apache.ambari.annotations.TransactionalLock","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":40,"lineEnd":40,"lineMapIndex":-1,"methodParents":[],"nodeIndex":74},{"cfgs":[],"code":"import org.apache.ambari.annotations.TransactionalLock.LockArea","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":41,"lineEnd":41,"lineMapIndex":-1,"methodParents":[],"nodeIndex":75},{"cfgs":[],"code":"import org.apache.ambari.annotations.TransactionalLock.LockType","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":42,"lineEnd":42,"lineMapIndex":-1,"methodParents":[],"nodeIndex":76},{"cfgs":[],"code":"import org.apache.ambari.server.orm.TransactionalLocks","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":53,"lineEnd":53,"lineMapIndex":-1,"methodParents":[],"nodeIndex":77},{"cfgs":[],"code":"private final TransactionalLocks transactionLocks = null","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":144,"lineEnd":144,"lineMapIndex":-1,"methodParents":[],"nodeIndex":78},{"cfgs":[],"code":"if (!hostRoleCommandStatusSummaryCacheEnabled )","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":155,"lineEnd":155,"lineMapIndex":3,"methodParents":[],"nodeIndex":79},{"cfgs":[81,82],"code":"if ( !hostRoleCommandStatusSummaryCacheEnabled )","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":169,"lineEnd":169,"lineMapIndex":2,"methodParents":[],"nodeIndex":80},{"cfgs":[82],"code":"if (stageEntity != null)","dfgs":[82],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":177,"lineEnd":177,"lineMapIndex":4,"methodParents":[],"nodeIndex":81},{"cfgs":[],"code":"if (requestId != null)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":182,"lineEnd":182,"lineMapIndex":5,"methodParents":[],"nodeIndex":82},{"cfgs":[84],"code":"ReadWriteLock lock = transactionLocks.getLock(LockArea.HRC_STATUS_CACHE)","dfgs":[84],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[78],"isDel":false,"lineBeg":201,"lineEnd":201,"lineMapIndex":-1,"methodParents":[],"nodeIndex":83},{"cfgs":[85],"code":"lock.readLock().lock()","dfgs":[102],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":202,"lineEnd":202,"lineMapIndex":-1,"methodParents":[],"nodeIndex":84},{"cfgs":[86],"code":"try ","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":204,"lineEnd":204,"lineMapIndex":-1,"methodParents":[],"nodeIndex":85},{"cfgs":[87],"code":"TypedQuery<HostRoleCommandStatusSummaryDTO> query = entityManagerProvider.get().createQuery(SUMMARY_DTO, HostRoleCommandStatusSummaryDTO.class)","dfgs":[87],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":205,"lineEnd":206,"lineMapIndex":6,"methodParents":[],"nodeIndex":86},{"cfgs":[88],"code":"query.setParameter(\"requestId\", requestId)","dfgs":[88],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":208,"lineEnd":208,"lineMapIndex":7,"methodParents":[],"nodeIndex":87},{"cfgs":[89],"code":"query.setParameter(\"aborted\", HostRoleStatus.ABORTED)","dfgs":[89],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":209,"lineEnd":209,"lineMapIndex":8,"methodParents":[],"nodeIndex":88},{"cfgs":[90],"code":"query.setParameter(\"completed\", HostRoleStatus.COMPLETED)","dfgs":[90],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":210,"lineEnd":210,"lineMapIndex":9,"methodParents":[],"nodeIndex":89},{"cfgs":[91],"code":"query.setParameter(\"failed\", HostRoleStatus.FAILED)","dfgs":[91],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":211,"lineEnd":211,"lineMapIndex":10,"methodParents":[],"nodeIndex":90},{"cfgs":[92],"code":"query.setParameter(\"holding\", HostRoleStatus.HOLDING)","dfgs":[92],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":212,"lineEnd":212,"lineMapIndex":11,"methodParents":[],"nodeIndex":91},{"cfgs":[93],"code":"query.setParameter(\"holding_failed\", HostRoleStatus.HOLDING_FAILED)","dfgs":[93],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":213,"lineEnd":213,"lineMapIndex":12,"methodParents":[],"nodeIndex":92},{"cfgs":[94],"code":"query.setParameter(\"holding_timedout\", HostRoleStatus.HOLDING_TIMEDOUT)","dfgs":[94],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":214,"lineEnd":214,"lineMapIndex":13,"methodParents":[],"nodeIndex":93},{"cfgs":[95],"code":"query.setParameter(\"in_progress\", HostRoleStatus.IN_PROGRESS)","dfgs":[95],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":215,"lineEnd":215,"lineMapIndex":14,"methodParents":[],"nodeIndex":94},{"cfgs":[96],"code":"query.setParameter(\"pending\", HostRoleStatus.PENDING)","dfgs":[96],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":216,"lineEnd":216,"lineMapIndex":15,"methodParents":[],"nodeIndex":95},{"cfgs":[97],"code":"query.setParameter(\"queued\", HostRoleStatus.QUEUED)","dfgs":[97],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":217,"lineEnd":217,"lineMapIndex":16,"methodParents":[],"nodeIndex":96},{"cfgs":[98],"code":"query.setParameter(\"timedout\", HostRoleStatus.TIMEDOUT)","dfgs":[98],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":218,"lineEnd":218,"lineMapIndex":17,"methodParents":[],"nodeIndex":97},{"cfgs":[99],"code":"query.setParameter(\"skipped_failed\", HostRoleStatus.SKIPPED_FAILED)","dfgs":[99],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":219,"lineEnd":219,"lineMapIndex":18,"methodParents":[],"nodeIndex":98},{"cfgs":[102,100],"code":"for (HostRoleCommandStatusSummaryDTO dto : daoUtils.selectList(query))","dfgs":[100],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":221,"lineEnd":221,"lineMapIndex":19,"methodParents":[],"nodeIndex":99},{"cfgs":[],"code":"map.put(dto.getStageId(), dto)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":222,"lineEnd":222,"lineMapIndex":20,"methodParents":[],"nodeIndex":100},{"cfgs":[],"code":"","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":224,"lineEnd":224,"lineMapIndex":-1,"methodParents":[],"nodeIndex":101},{"cfgs":[],"code":"lock.readLock().unlock()","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":225,"lineEnd":225,"lineMapIndex":-1,"methodParents":[],"nodeIndex":102},{"cfgs":[],"code":"@Injectpublic HostRoleCommandDAO(@Named(HRC_STATUS_SUMMARY_CACHE_ENABLED) boolean hostRoleCommandStatusSummaryCacheEnabled,@Named(HRC_STATUS_SUMMARY_CACHE_SIZE) long hostRoleCommandStatusSummaryCacheLimit,@Named(HRC_STATUS_SUMMARY_CACHE_EXPIRY_DURATION_MINUTES) long hostRoleCommandStatusSummaryCacheExpiryDurationMins)","dfgs":[104],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":231,"lineEnd":235,"lineMapIndex":21,"methodParents":[],"nodeIndex":103},{"cfgs":[],"code":"hrcStatusSummaryCache = CacheBuilder.newBuilder().maximumSize(hostRoleCommandStatusSummaryCacheLimit).expireAfterWrite(hostRoleCommandStatusSummaryCacheExpiryDurationMins, TimeUnit.MINUTES).build(new CacheLoader<Long, Map<Long, HostRoleCommandStatusSummaryDTO>>() {@Overridepublic Map<Long, HostRoleCommandStatusSummaryDTO> load(Long requestId) throws Exception {LOG.debug(\"Cache miss for host role command status summary object for request {}, fetching from JPA\", requestId);Map<Long, HostRoleCommandStatusSummaryDTO> hrcCommandStatusByStageId = loadAggregateCounts(requestId);return hrcCommandStatusByStageId;}})","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":240,"lineEnd":251,"lineMapIndex":22,"methodParents":[],"nodeIndex":104},{"cfgs":[],"code":"public void create(HostRoleCommandEntity entity) ","dfgs":[107],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":580,"lineEnd":580,"lineMapIndex":-1,"methodParents":[],"nodeIndex":105},{"cfgs":[107],"code":"EntityManager entityManager = entityManagerProvider.get()","dfgs":[107,108],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":581,"lineEnd":581,"lineMapIndex":-1,"methodParents":[],"nodeIndex":106},{"cfgs":[108],"code":"entityManager.persist(entity)","dfgs":[108],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":582,"lineEnd":582,"lineMapIndex":-1,"methodParents":[],"nodeIndex":107},{"cfgs":[],"code":"invalidateHostRoleCommandStatusCache(entity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":584,"lineEnd":584,"lineMapIndex":-1,"methodParents":[80],"nodeIndex":108},{"cfgs":[110],"code":"public HostRoleCommandEntity merge(HostRoleCommandEntity entity) ","dfgs":[111],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":589,"lineEnd":589,"lineMapIndex":-1,"methodParents":[],"nodeIndex":109},{"cfgs":[111],"code":"EntityManager entityManager = entityManagerProvider.get()","dfgs":[111],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":590,"lineEnd":590,"lineMapIndex":-1,"methodParents":[],"nodeIndex":110},{"cfgs":[],"code":"entity = entityManager.merge(entity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":591,"lineEnd":591,"lineMapIndex":-1,"methodParents":[109],"nodeIndex":111},{"cfgs":[113],"code":"EntityManager entityManager = entityManagerProvider.get()","dfgs":[113],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":611,"lineEnd":611,"lineMapIndex":-1,"methodParents":[],"nodeIndex":112},{"cfgs":[],"code":"managedList.add(entityManager.merge(entity))","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":612,"lineEnd":612,"lineMapIndex":28,"methodParents":[109],"nodeIndex":113},{"cfgs":[],"code":"public void remove(HostRoleCommandEntity entity) ","dfgs":[116],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":621,"lineEnd":621,"lineMapIndex":-1,"methodParents":[],"nodeIndex":114},{"cfgs":[116],"code":"EntityManager entityManager = entityManagerProvider.get()","dfgs":[116],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":622,"lineEnd":622,"lineMapIndex":-1,"methodParents":[],"nodeIndex":115},{"cfgs":[117],"code":"entityManager.remove(merge(entity))","dfgs":[117],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":623,"lineEnd":623,"lineMapIndex":-1,"methodParents":[114],"nodeIndex":116},{"cfgs":[],"code":"invalidateHostRoleCommandStatusCache(entity)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":624,"lineEnd":624,"lineMapIndex":-1,"methodParents":[80],"nodeIndex":117},{"cfgs":[119],"code":"if (hostRoleCommandStatusSummaryCacheEnabled)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":639,"lineEnd":639,"lineMapIndex":32,"methodParents":[],"nodeIndex":118},{"cfgs":[],"code":"else","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_dao_HostRoleCommandDAO.java","fieldParents":[],"isDel":false,"lineBeg":642,"lineEnd":642,"lineMapIndex":-1,"methodParents":[],"nodeIndex":119},{"cfgs":[],"code":"import java.lang.reflect.Method","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":21,"lineEnd":21,"lineMapIndex":41,"methodParents":[],"nodeIndex":120},{"cfgs":[],"code":"import java.sql.SQLException","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":22,"lineEnd":22,"lineMapIndex":42,"methodParents":[],"nodeIndex":121},{"cfgs":[],"code":"import javax.persistence.EntityManager","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":24,"lineEnd":24,"lineMapIndex":38,"methodParents":[],"nodeIndex":122},{"cfgs":[],"code":"import javax.persistence.EntityTransaction","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":25,"lineEnd":25,"lineMapIndex":39,"methodParents":[],"nodeIndex":123},{"cfgs":[],"code":"import javax.persistence.PersistenceException","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":26,"lineEnd":26,"lineMapIndex":40,"methodParents":[],"nodeIndex":124},{"cfgs":[],"code":"import com.google.inject.Inject","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":34,"lineEnd":34,"lineMapIndex":34,"methodParents":[],"nodeIndex":125},{"cfgs":[],"code":"import com.google.inject.persist.Transactional","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":35,"lineEnd":35,"lineMapIndex":35,"methodParents":[],"nodeIndex":126},{"cfgs":[],"code":"import com.google.inject.persist.UnitOfWork","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":36,"lineEnd":36,"lineMapIndex":36,"methodParents":[],"nodeIndex":127},{"cfgs":[],"code":"import com.google.inject.persist.jpa.AmbariJpaPersistService","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":37,"lineEnd":37,"lineMapIndex":37,"methodParents":[],"nodeIndex":128},{"cfgs":[],"code":"EntityManager em = emProvider.get()","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":62,"lineEnd":62,"lineMapIndex":43,"methodParents":[],"nodeIndex":129},{"cfgs":[],"code":"Object result","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java","fieldParents":[],"isDel":false,"lineBeg":69,"lineEnd":69,"lineMapIndex":44,"methodParents":[],"nodeIndex":130},{"cfgs":[132],"code":"if (!commands.isEmpty())","dfgs":[132],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":202,"lineEnd":202,"lineMapIndex":-1,"methodParents":[],"nodeIndex":131},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":203,"lineEnd":203,"lineMapIndex":45,"methodParents":[112],"nodeIndex":132},{"cfgs":[134],"code":"if (!commands.isEmpty())","dfgs":[134],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":222,"lineEnd":222,"lineMapIndex":-1,"methodParents":[],"nodeIndex":133},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":223,"lineEnd":223,"lineMapIndex":46,"methodParents":[112],"nodeIndex":134},{"cfgs":[136],"code":"if (!commandEntities.isEmpty())","dfgs":[136],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":487,"lineEnd":487,"lineMapIndex":-1,"methodParents":[],"nodeIndex":135},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commandEntities)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":488,"lineEnd":488,"lineMapIndex":47,"methodParents":[112],"nodeIndex":136},{"cfgs":[138],"code":"if (!commands.isEmpty())","dfgs":[138],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":542,"lineEnd":542,"lineMapIndex":-1,"methodParents":[],"nodeIndex":137},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(commands)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":543,"lineEnd":543,"lineMapIndex":48,"methodParents":[112],"nodeIndex":138},{"cfgs":[140],"code":"if (!tasks.isEmpty())","dfgs":[140],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":742,"lineEnd":742,"lineMapIndex":-1,"methodParents":[],"nodeIndex":139},{"cfgs":[],"code":"hostRoleCommandDAO.mergeAll(tasks)","dfgs":[],"fName":"ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java","fieldParents":[],"isDel":false,"lineBeg":743,"lineEnd":743,"lineMapIndex":49,"methodParents":[112],"nodeIndex":140},{"cfgs":[],"code":"import javax.persistence.EntityManager","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":30,"lineEnd":30,"lineMapIndex":64,"methodParents":[],"nodeIndex":141},{"cfgs":[],"code":"import javax.persistence.EntityManagerFactory","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":31,"lineEnd":31,"lineMapIndex":65,"methodParents":[],"nodeIndex":142},{"cfgs":[],"code":"import org.aopalliance.intercept.MethodInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":33,"lineEnd":33,"lineMapIndex":59,"methodParents":[],"nodeIndex":143},{"cfgs":[],"code":"import org.aopalliance.intercept.MethodInvocation","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":34,"lineEnd":34,"lineMapIndex":60,"methodParents":[],"nodeIndex":144},{"cfgs":[],"code":"import org.apache.ambari.annotations.TransactionalLock","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":35,"lineEnd":35,"lineMapIndex":-1,"methodParents":[],"nodeIndex":145},{"cfgs":[],"code":"import org.apache.ambari.server.orm.AmbariJpaLocalTxnInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":36,"lineEnd":36,"lineMapIndex":61,"methodParents":[],"nodeIndex":146},{"cfgs":[],"code":"import org.apache.ambari.server.orm.AmbariLocalSessionInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":37,"lineEnd":37,"lineMapIndex":62,"methodParents":[],"nodeIndex":147},{"cfgs":[],"code":"import org.apache.ambari.server.orm.TransactionalLockInterceptor","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":38,"lineEnd":38,"lineMapIndex":-1,"methodParents":[],"nodeIndex":148},{"cfgs":[],"code":"import org.apache.ambari.server.orm.RequiresSession","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":39,"lineEnd":39,"lineMapIndex":63,"methodParents":[],"nodeIndex":149},{"cfgs":[],"code":"import com.google.common.collect.Lists","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":41,"lineEnd":41,"lineMapIndex":50,"methodParents":[],"nodeIndex":150},{"cfgs":[],"code":"import com.google.inject.Inject","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":42,"lineEnd":42,"lineMapIndex":51,"methodParents":[],"nodeIndex":151},{"cfgs":[],"code":"import com.google.inject.Singleton","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":43,"lineEnd":43,"lineMapIndex":52,"methodParents":[],"nodeIndex":152},{"cfgs":[],"code":"import com.google.inject.persist.PersistModule","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":44,"lineEnd":44,"lineMapIndex":53,"methodParents":[],"nodeIndex":153},{"cfgs":[],"code":"import com.google.inject.persist.PersistService","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":45,"lineEnd":45,"lineMapIndex":54,"methodParents":[],"nodeIndex":154},{"cfgs":[],"code":"import com.google.inject.persist.UnitOfWork","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":46,"lineEnd":46,"lineMapIndex":55,"methodParents":[],"nodeIndex":155},{"cfgs":[],"code":"import com.google.inject.persist.finder.DynamicFinder","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":47,"lineEnd":47,"lineMapIndex":56,"methodParents":[],"nodeIndex":156},{"cfgs":[],"code":"import com.google.inject.persist.finder.Finder","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":48,"lineEnd":48,"lineMapIndex":57,"methodParents":[],"nodeIndex":157},{"cfgs":[],"code":"import com.google.inject.util.Providers","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":49,"lineEnd":49,"lineMapIndex":58,"methodParents":[],"nodeIndex":158},{"cfgs":[160],"code":"bind(Properties.class).annotatedWith(Jpa.class).toProvider(Providers.<Properties> of(null))","dfgs":[160],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":74,"lineEnd":74,"lineMapIndex":67,"methodParents":[],"nodeIndex":159},{"cfgs":[161],"code":"bind(EntityManagerFactory.class).toProvider(JpaPersistService.EntityManagerFactoryProvider.class)","dfgs":[162],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":82,"lineEnd":82,"lineMapIndex":68,"methodParents":[],"nodeIndex":160},{"cfgs":[162],"code":"MethodInterceptor sessionInterceptor = new AmbariLocalSessionInterceptor()","dfgs":[162],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":87,"lineEnd":87,"lineMapIndex":69,"methodParents":[],"nodeIndex":161},{"cfgs":[163],"code":"requestInjection(sessionInterceptor)","dfgs":[164],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":88,"lineEnd":88,"lineMapIndex":70,"methodParents":[],"nodeIndex":162},{"cfgs":[164],"code":"MethodInterceptor lockAwareInterceptor = new TransactionalLockInterceptor()","dfgs":[164],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":101,"lineEnd":101,"lineMapIndex":-1,"methodParents":[],"nodeIndex":163},{"cfgs":[165],"code":"requestInjection(lockAwareInterceptor)","dfgs":[165],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":102,"lineEnd":102,"lineMapIndex":-1,"methodParents":[],"nodeIndex":164},{"cfgs":[],"code":"bindInterceptor(any(), annotatedWith(TransactionalLock.class), lockAwareInterceptor)","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":103,"lineEnd":103,"lineMapIndex":-1,"methodParents":[],"nodeIndex":165},{"cfgs":[],"code":"return finderProxy.invoke(new MethodInvocation() {@Overridepublic Method getMethod() {return method;}@Overridepublic Object[] getArguments() {return null == args ? new Object[0] : args;}@Overridepublic Object proceed() throws Throwable {return method.invoke(thisObject, args);}@Overridepublic Object getThis() {throw new UnsupportedOperationException(\"Bottomless proxies don't expose a this.\");}@Overridepublic AccessibleObject getStaticPart() {throw new UnsupportedOperationException();}})","dfgs":[],"fName":"ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java","fieldParents":[],"isDel":false,"lineBeg":155,"lineEnd":180,"lineMapIndex":-1,"methodParents":[129],"nodeIndex":166}]