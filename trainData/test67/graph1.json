[{"cfgs": [], "code": "import org.aopalliance.intercept.MethodInvocation", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 22, "lineEnd": 22, "lineMapIndex": 59, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.AmbariJpaLocalTxnInterceptor", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 25, "lineEnd": 25, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.InMemoryDefaultTestModule", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 26, "lineEnd": 26, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.TransactionalLockInterceptor", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 27, "lineEnd": 27, "lineMapIndex": 61, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.dao.HostRoleCommandDAO", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 28, "lineEnd": 28, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.entities.HostRoleCommandEntity", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 29, "lineEnd": 29, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.easymock.EasyMock", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 30, "lineEnd": 30, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.junit.runner.RunWith", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 32, "lineEnd": 32, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.powermock.api.easymock.PowerMock", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 33, "lineEnd": 33, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.powermock.api.mockito.PowerMockito", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 34, "lineEnd": 34, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.powermock.core.classloader.annotations.PowerMockIgnore", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 35, "lineEnd": 35, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.powermock.core.classloader.annotations.PrepareForTest", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 36, "lineEnd": 36, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.powermock.modules.junit4.PowerMockRunner", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 37, "lineEnd": 37, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.Guice", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 39, "lineEnd": 39, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 13, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.Injector", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 40, "lineEnd": 40, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.persist.Transactional", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 41, "lineEnd": 41, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.persist.jpa.AmbariJpaPersistModule", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 42, "lineEnd": 42, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.persist.jpa.AmbariJpaPersistService", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 43, "lineEnd": 43, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "public void testTransactionLockOrdering() throws Throwable ", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 95, "lineEnd": 95, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 18, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [20], "code": "AmbariJpaLocalTxnInterceptor ambariJPAInterceptor = PowerMock.createNiceMock(AmbariJpaLocalTxnInterceptor.class)", "dfgs": [21, 20], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 96, "lineEnd": 97, "lineMapIndex": 63, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [21], "code": "TransactionalLockInterceptor lockInterceptor = PowerMock.createNiceMock(TransactionalLockInterceptor.class)", "dfgs": [22], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 99, "lineEnd": 100, "lineMapIndex": 64, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [22], "code": "PowerMockito.whenNew(AmbariJpaLocalTxnInterceptor.class).withAnyArguments().thenReturn(ambariJPAInterceptor)", "dfgs": [22, 25], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 102, "lineEnd": 103, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [23], "code": "PowerMockito.whenNew(TransactionalLockInterceptor.class).withAnyArguments().thenReturn(lockInterceptor)", "dfgs": [24], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 105, "lineEnd": 106, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 22, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [24], "code": "Object object = new Object()", "dfgs": [24], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 108, "lineEnd": 108, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 23, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [25], "code": "EasyMock.expect(lockInterceptor.invoke(EasyMock.anyObject(MethodInvocation.class))).andReturn(object).once()", "dfgs": [26, 25], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 110, "lineEnd": 111, "lineMapIndex": -1, "methodParents": [32], "nodeIndex": 24, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [26], "code": "EasyMock.expect(ambariJPAInterceptor.invoke(EasyMock.anyObject(MethodInvocation.class))).andReturn(object).once()", "dfgs": [26], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 113, "lineEnd": 115, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 25, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [27], "code": "EasyMock.replay(ambariJPAInterceptor, lockInterceptor)", "dfgs": [30], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 117, "lineEnd": 117, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [28], "code": "Injector injector = Guice.createInjector(new InMemoryDefaultTestModule())", "dfgs": [28], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 119, "lineEnd": 119, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [29], "code": "HostRoleCommandDAO hostRoleCommandDAO = injector.getInstance(HostRoleCommandDAO.class)", "dfgs": [29], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 120, "lineEnd": 120, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [30], "code": "hostRoleCommandDAO.create(new HostRoleCommandEntity())", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 121, "lineEnd": 121, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "EasyMock.verify(lockInterceptor)", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": true, "lineBeg": 123, "lineEnd": 123, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import com.google.inject.persist.Transactional", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessor.java", "fieldParents": [], "isDel": true, "lineBeg": 29, "lineEnd": 29, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": ["3beda060b31d1b5a359ff52567e12a00eb70147d"]}, {"cfgs": [], "code": "Object result", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 69, "lineEnd": 69, "lineMapIndex": 89, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [34], "code": "final EntityTransaction txn = em.getTransaction()", "dfgs": [34], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 71, "lineEnd": 71, "lineMapIndex": 87, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [35], "code": "txn.begin()", "dfgs": [45, 38, 41], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 72, "lineEnd": 72, "lineMapIndex": 88, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [36], "code": "try ", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 74, "lineEnd": 74, "lineMapIndex": 90, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [41, 37], "code": "result = methodInvocation.proceed()", "dfgs": [53], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 75, "lineEnd": 75, "lineMapIndex": 91, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [38], "code": "catch (Exception e)", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 77, "lineEnd": 77, "lineMapIndex": 92, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [39], "code": "if (rollbackIfNecessary(transactional, e, txn))", "dfgs": [45, 39, 41], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 79, "lineEnd": 79, "lineMapIndex": 93, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [40], "code": "detailedLogForPersistenceError(e)", "dfgs": [40, 47, 42, 43, 50, 51, 52, 41], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 83, "lineEnd": 83, "lineMapIndex": 95, "methodParents": [], "nodeIndex": 39, "rootcause": false, "commits": ["ff43fe25a0a27f502a02076200303b0a14bb0f17"]}, {"cfgs": [41], "code": "throw e", "dfgs": [47], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 86, "lineEnd": 86, "lineMapIndex": 96, "methodParents": [], "nodeIndex": 40, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [42, 44], "code": "if (null != didWeStartWork.get() && !txn.isActive())", "dfgs": [45, 47, 42, 50], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 90, "lineEnd": 90, "lineMapIndex": 98, "methodParents": [], "nodeIndex": 41, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [43], "code": "didWeStartWork.remove()", "dfgs": [47, 50], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 91, "lineEnd": 91, "lineMapIndex": 99, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [44], "code": "unitOfWork.end()", "dfgs": [47, 52], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 92, "lineEnd": 92, "lineMapIndex": 100, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [45], "code": "try ", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 99, "lineEnd": 99, "lineMapIndex": 101, "methodParents": [], "nodeIndex": 44, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [50, 46], "code": "txn.commit()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 100, "lineEnd": 100, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 45, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [47], "code": "catch (Exception e)", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 101, "lineEnd": 101, "lineMapIndex": 102, "methodParents": [], "nodeIndex": 46, "rootcause": false, "commits": ["ff43fe25a0a27f502a02076200303b0a14bb0f17"]}, {"cfgs": [48], "code": "detailedLogForPersistenceError(e)", "dfgs": [48, 50, 51, 52], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 102, "lineEnd": 102, "lineMapIndex": 103, "methodParents": [], "nodeIndex": 47, "rootcause": false, "commits": ["ff43fe25a0a27f502a02076200303b0a14bb0f17"]}, {"cfgs": [50], "code": "throw e", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 103, "lineEnd": 103, "lineMapIndex": 104, "methodParents": [], "nodeIndex": 48, "rootcause": false, "commits": ["ff43fe25a0a27f502a02076200303b0a14bb0f17"]}, {"cfgs": [], "code": "", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 104, "lineEnd": 104, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 49, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [51, 53], "code": "if (null != didWeStartWork.get())", "dfgs": [51], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 106, "lineEnd": 106, "lineMapIndex": 106, "methodParents": [], "nodeIndex": 50, "rootcause": false, "commits": ["ff43fe25a0a27f502a02076200303b0a14bb0f17"]}, {"cfgs": [52], "code": "didWeStartWork.remove()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 107, "lineEnd": 107, "lineMapIndex": 107, "methodParents": [], "nodeIndex": 51, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [53], "code": "unitOfWork.end()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 108, "lineEnd": 108, "lineMapIndex": 108, "methodParents": [], "nodeIndex": 52, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [], "code": "return result", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": true, "lineBeg": 113, "lineEnd": 113, "lineMapIndex": 109, "methodParents": [], "nodeIndex": 53, "rootcause": false, "commits": ["fae3fa56d453aec038890c0fc4d04f4ba69824a3"]}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock", "dfgs": [], "fName": "ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java", "fieldParents": [], "isDel": true, "lineBeg": 35, "lineEnd": 35, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 54, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import org.apache.ambari.server.orm.TransactionalLockInterceptor", "dfgs": [], "fName": "ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java", "fieldParents": [], "isDel": true, "lineBeg": 38, "lineEnd": 38, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 55, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [57], "code": "MethodInterceptor lockAwareInterceptor = new TransactionalLockInterceptor()", "dfgs": [57], "fName": "ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java", "fieldParents": [], "isDel": true, "lineBeg": 101, "lineEnd": 101, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 56, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [58], "code": "requestInjection(lockAwareInterceptor)", "dfgs": [58], "fName": "ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java", "fieldParents": [], "isDel": true, "lineBeg": 102, "lineEnd": 102, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 57, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "bindInterceptor(any(), annotatedWith(TransactionalLock.class), lockAwareInterceptor)", "dfgs": [], "fName": "ambari-server_src_main_java_com_google_inject_persist_jpa_AmbariJpaPersistModule.java", "fieldParents": [], "isDel": true, "lineBeg": 103, "lineEnd": 103, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 58, "rootcause": false, "commits": ["1621a53dc5820ba1ca5bf5204628b51d341f0caa"]}, {"cfgs": [], "code": "import java.lang.reflect.Method", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 20, "lineEnd": 20, "lineMapIndex": 0, "methodParents": [], "nodeIndex": 59, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.HashSet", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 21, "lineEnd": 21, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 60, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock.LockType", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 25, "lineEnd": 25, "lineMapIndex": 3, "methodParents": [], "nodeIndex": 61, "rootcause": false, "commits": []}, {"cfgs": [], "code": "public void testAnnotationEquality() ", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 70, "lineEnd": 70, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 62, "rootcause": false, "commits": []}, {"cfgs": [64], "code": "HashSet<TransactionalLock> annotations = new HashSet<>()", "dfgs": [71, 69], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 71, "lineEnd": 71, "lineMapIndex": 19, "methodParents": [], "nodeIndex": 63, "rootcause": false, "commits": []}, {"cfgs": [65], "code": "int annotationsFound = 0", "dfgs": [72, 70], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 73, "lineEnd": 73, "lineMapIndex": 20, "methodParents": [], "nodeIndex": 64, "rootcause": false, "commits": []}, {"cfgs": [66], "code": "Method[] methods = getClass().getDeclaredMethods()", "dfgs": [66], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 74, "lineEnd": 74, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 65, "rootcause": false, "commits": []}, {"cfgs": [71, 67], "code": "for (Method method : methods)", "dfgs": [67], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 75, "lineEnd": 75, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 66, "rootcause": false, "commits": []}, {"cfgs": [68], "code": "TransactionalLock annotation = method.getAnnotation(TransactionalLock.class)", "dfgs": [68], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 76, "lineEnd": 76, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 67, "rootcause": false, "commits": []}, {"cfgs": [69], "code": "if (null != annotation)", "dfgs": [69], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 77, "lineEnd": 77, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 68, "rootcause": false, "commits": []}, {"cfgs": [70], "code": "annotations.add(annotation)", "dfgs": [71], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 78, "lineEnd": 78, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 69, "rootcause": false, "commits": []}, {"cfgs": [], "code": "annotationsFound++", "dfgs": [72], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 79, "lineEnd": 79, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 70, "rootcause": false, "commits": []}, {"cfgs": [72], "code": "Assert.assertEquals(2, annotations.size())", "dfgs": [72], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 85, "lineEnd": 85, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 71, "rootcause": false, "commits": []}, {"cfgs": [], "code": "Assert.assertEquals(3, annotationsFound)", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 86, "lineEnd": 86, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 72, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private void transactionalHRCRead() ", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 91, "lineEnd": 91, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 73, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private void transactionalHRCRead2() ", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 95, "lineEnd": 95, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 74, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private void transactionalHRCWrite() ", "dfgs": [], "fName": "ambari-server_src_test_java_org_apache_ambari_annotations_TransactionalLockTest.java", "fieldParents": [], "isDel": false, "lineBeg": 99, "lineEnd": 99, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 75, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.Iterator", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 23, "lineEnd": 23, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 76, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.LinkedList", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 24, "lineEnd": 24, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 77, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.concurrent.locks.Lock", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 25, "lineEnd": 25, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 78, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import java.util.concurrent.locks.ReadWriteLock", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 26, "lineEnd": 26, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 79, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 34, "lineEnd": 34, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 80, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock.LockArea", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 35, "lineEnd": 35, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 81, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock.LockType", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 36, "lineEnd": 36, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 82, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private static final ThreadLocal<LinkedList<TransactionalLock>> s_transactionalLocks = new ThreadLocal<LinkedList<TransactionalLock>>() {/*** {@inheritDoc}*/@Overrideprotected LinkedList<TransactionalLock> initialValue() {return new LinkedList<>();}}", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 70, "lineEnd": 78, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 83, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private final TransactionalLocks transactionLocks = null", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 87, "lineEnd": 87, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 84, "rootcause": false, "commits": []}, {"cfgs": [86], "code": "lockTransaction(methodInvocation)", "dfgs": [91, 103, 93, 99, 100, 106, 107, 108, 98], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 114, "lineEnd": 114, "lineMapIndex": -1, "methodParents": [111], "nodeIndex": 85, "rootcause": false, "commits": []}, {"cfgs": [87], "code": "try ", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 121, "lineEnd": 121, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 86, "rootcause": false, "commits": []}, {"cfgs": [88], "code": "final EntityTransaction txn = em.getTransaction()", "dfgs": [88], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 123, "lineEnd": 123, "lineMapIndex": 33, "methodParents": [], "nodeIndex": 87, "rootcause": false, "commits": []}, {"cfgs": [90], "code": "txn.begin()", "dfgs": [93, 98], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 124, "lineEnd": 124, "lineMapIndex": 34, "methodParents": [], "nodeIndex": 88, "rootcause": false, "commits": []}, {"cfgs": [], "code": "Object result", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 126, "lineEnd": 126, "lineMapIndex": 32, "methodParents": [], "nodeIndex": 89, "rootcause": false, "commits": []}, {"cfgs": [91], "code": "try ", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 127, "lineEnd": 127, "lineMapIndex": 35, "methodParents": [], "nodeIndex": 90, "rootcause": false, "commits": []}, {"cfgs": [98, 92], "code": "result = methodInvocation.proceed()", "dfgs": [109], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 128, "lineEnd": 128, "lineMapIndex": 36, "methodParents": [], "nodeIndex": 91, "rootcause": false, "commits": []}, {"cfgs": [93], "code": "catch (Exception e)", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 130, "lineEnd": 130, "lineMapIndex": 37, "methodParents": [], "nodeIndex": 92, "rootcause": false, "commits": []}, {"cfgs": [94, 95], "code": "if (rollbackIfNecessary(transactional, e, txn))", "dfgs": [95, 94, 98], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 132, "lineEnd": 132, "lineMapIndex": 38, "methodParents": [], "nodeIndex": 93, "rootcause": false, "commits": []}, {"cfgs": [95], "code": "txn.commit()", "dfgs": [98], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 133, "lineEnd": 133, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 94, "rootcause": false, "commits": []}, {"cfgs": [96], "code": "detailedLogForPersistenceError(e)", "dfgs": [96, 103, 99, 100, 106, 107, 108, 98], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 136, "lineEnd": 136, "lineMapIndex": 39, "methodParents": [], "nodeIndex": 95, "rootcause": false, "commits": []}, {"cfgs": [98], "code": "throw e", "dfgs": [103], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 139, "lineEnd": 139, "lineMapIndex": 40, "methodParents": [], "nodeIndex": 96, "rootcause": false, "commits": []}, {"cfgs": [], "code": "", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 140, "lineEnd": 140, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 97, "rootcause": false, "commits": []}, {"cfgs": [99, 101], "code": "if (null != didWeStartWork.get() && !txn.isActive())", "dfgs": [103, 99, 106], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 143, "lineEnd": 143, "lineMapIndex": 41, "methodParents": [], "nodeIndex": 98, "rootcause": false, "commits": []}, {"cfgs": [100], "code": "didWeStartWork.remove()", "dfgs": [103, 106], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 144, "lineEnd": 144, "lineMapIndex": 42, "methodParents": [], "nodeIndex": 99, "rootcause": false, "commits": []}, {"cfgs": [101], "code": "unitOfWork.end()", "dfgs": [103, 108], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 145, "lineEnd": 145, "lineMapIndex": 43, "methodParents": [], "nodeIndex": 100, "rootcause": false, "commits": []}, {"cfgs": [106, 102], "code": "try ", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 152, "lineEnd": 152, "lineMapIndex": 44, "methodParents": [], "nodeIndex": 101, "rootcause": false, "commits": []}, {"cfgs": [103], "code": "catch (Exception e)", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 154, "lineEnd": 154, "lineMapIndex": 46, "methodParents": [], "nodeIndex": 102, "rootcause": false, "commits": []}, {"cfgs": [104], "code": "detailedLogForPersistenceError(e)", "dfgs": [104, 106, 107, 108], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 155, "lineEnd": 155, "lineMapIndex": 47, "methodParents": [], "nodeIndex": 103, "rootcause": false, "commits": []}, {"cfgs": [106], "code": "throw e", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 156, "lineEnd": 156, "lineMapIndex": 48, "methodParents": [], "nodeIndex": 104, "rootcause": false, "commits": []}, {"cfgs": [], "code": "", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 157, "lineEnd": 157, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 105, "rootcause": false, "commits": []}, {"cfgs": [107, 109], "code": "if (null != didWeStartWork.get())", "dfgs": [107], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 159, "lineEnd": 159, "lineMapIndex": 50, "methodParents": [], "nodeIndex": 106, "rootcause": false, "commits": []}, {"cfgs": [108], "code": "didWeStartWork.remove()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 160, "lineEnd": 160, "lineMapIndex": 51, "methodParents": [], "nodeIndex": 107, "rootcause": false, "commits": []}, {"cfgs": [109], "code": "unitOfWork.end()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 161, "lineEnd": 161, "lineMapIndex": 52, "methodParents": [], "nodeIndex": 108, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return result", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 166, "lineEnd": 166, "lineMapIndex": 53, "methodParents": [], "nodeIndex": 109, "rootcause": false, "commits": []}, {"cfgs": [], "code": "unlockTransaction()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 169, "lineEnd": 169, "lineMapIndex": -1, "methodParents": [121], "nodeIndex": 110, "rootcause": false, "commits": []}, {"cfgs": [112], "code": "private void lockTransaction(MethodInvocation methodInvocation) ", "dfgs": [119, 120, 113, 114, 115, 116, 117, 112, 118], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 270, "lineEnd": 270, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 111, "rootcause": false, "commits": []}, {"cfgs": [113], "code": "TransactionalLock annotation = methodInvocation.getMethod().getAnnotation(TransactionalLock.class)", "dfgs": [113], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 271, "lineEnd": 272, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 112, "rootcause": false, "commits": []}, {"cfgs": [114, 115], "code": "if (null == annotation)", "dfgs": [115], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 275, "lineEnd": 275, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 113, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 276, "lineEnd": 276, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 114, "rootcause": false, "commits": []}, {"cfgs": [116], "code": "LockArea lockArea = annotation.lockArea()", "dfgs": [116, 117], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 280, "lineEnd": 280, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 115, "rootcause": false, "commits": []}, {"cfgs": [117], "code": "LockType lockType = annotation.lockType()", "dfgs": [120, 118], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 281, "lineEnd": 281, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 116, "rootcause": false, "commits": []}, {"cfgs": [118], "code": "ReadWriteLock rwLock = transactionLocks.getLock(lockArea)", "dfgs": [118], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [84], "isDel": false, "lineBeg": 283, "lineEnd": 283, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 117, "rootcause": false, "commits": []}, {"cfgs": [119], "code": "Lock lock = lockType == LockType.READ ? rwLock.readLock() : rwLock.writeLock()", "dfgs": [119], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 284, "lineEnd": 284, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 118, "rootcause": false, "commits": []}, {"cfgs": [120], "code": "lock.lock()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 286, "lineEnd": 286, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 119, "rootcause": false, "commits": []}, {"cfgs": [], "code": "s_transactionalLocks.get().add(annotation)", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [83], "isDel": false, "lineBeg": 290, "lineEnd": 290, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 120, "rootcause": false, "commits": []}, {"cfgs": [122], "code": "private void unlockTransaction()", "dfgs": [123, 124, 125, 126, 132, 133, 127, 128, 129, 130, 131], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 298, "lineEnd": 298, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 121, "rootcause": false, "commits": []}, {"cfgs": [123], "code": "LinkedList<TransactionalLock> annotations = s_transactionalLocks.get()", "dfgs": [123], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [83], "isDel": false, "lineBeg": 299, "lineEnd": 299, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 122, "rootcause": false, "commits": []}, {"cfgs": [124, 125], "code": "if (annotations.isEmpty())", "dfgs": [125], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 300, "lineEnd": 300, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 123, "rootcause": false, "commits": []}, {"cfgs": [], "code": "return", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 301, "lineEnd": 301, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 124, "rootcause": false, "commits": []}, {"cfgs": [126], "code": "Iterator<TransactionalLock> iterator = annotations.descendingIterator()", "dfgs": [126], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 307, "lineEnd": 307, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 125, "rootcause": false, "commits": []}, {"cfgs": [127], "code": "while (iterator.hasNext())", "dfgs": [127], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 308, "lineEnd": 308, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 126, "rootcause": false, "commits": []}, {"cfgs": [128], "code": "TransactionalLock annotation = iterator.next()", "dfgs": [133, 128], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 309, "lineEnd": 309, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 127, "rootcause": false, "commits": []}, {"cfgs": [129], "code": "LockArea lockArea = annotation.lockArea()", "dfgs": [129, 130], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 310, "lineEnd": 310, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 128, "rootcause": false, "commits": []}, {"cfgs": [130], "code": "LockType lockType = annotation.lockType()", "dfgs": [131], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 311, "lineEnd": 311, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 129, "rootcause": false, "commits": []}, {"cfgs": [131], "code": "ReadWriteLock rwLock = transactionLocks.getLock(lockArea)", "dfgs": [131], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [84], "isDel": false, "lineBeg": 313, "lineEnd": 313, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 130, "rootcause": false, "commits": []}, {"cfgs": [132], "code": "Lock lock = lockType == LockType.READ ? rwLock.readLock() : rwLock.writeLock()", "dfgs": [132], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 314, "lineEnd": 314, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 131, "rootcause": false, "commits": []}, {"cfgs": [133], "code": "lock.unlock()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 316, "lineEnd": 316, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 132, "rootcause": false, "commits": []}, {"cfgs": [], "code": "iterator.remove()", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_orm_AmbariJpaLocalTxnInterceptor.java", "fieldParents": [], "isDel": false, "lineBeg": 317, "lineEnd": 317, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 133, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java", "fieldParents": [], "isDel": false, "lineBeg": 32, "lineEnd": 32, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 134, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock.LockArea", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java", "fieldParents": [], "isDel": false, "lineBeg": 33, "lineEnd": 33, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 135, "rootcause": false, "commits": []}, {"cfgs": [], "code": "import org.apache.ambari.annotations.TransactionalLock.LockType", "dfgs": [], "fName": "ambari-server_src_main_java_org_apache_ambari_server_actionmanager_ActionDBAccessorImpl.java", "fieldParents": [], "isDel": false, "lineBeg": 34, "lineEnd": 34, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 136, "rootcause": false, "commits": []}]