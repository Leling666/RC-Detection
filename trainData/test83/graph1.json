[{"cfgs": [], "code": "private static final String TEST_KEY = \"testKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs-nfs_src_test_java_org_apache_hadoop_hdfs_nfs_nfs3_TestRpcProgramNfs3.java", "fieldParents": [], "isDel": true, "lineBeg": 118, "lineEnd": 118, "lineMapIndex": 23, "methodParents": [], "nodeIndex": 0, "rootcause": false, "commits": ["70be56d093022de9953e14a92dfa1a146bd9a290"]}, {"cfgs": [2], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kA.ALL\", \"*\")", "dfgs": [2], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1525, "lineEnd": 1525, "lineMapIndex": 26, "methodParents": [], "nodeIndex": 1, "rootcause": false, "commits": ["b02a4b40610e93eef6559db09a11d287e859446d"]}, {"cfgs": [], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kD.ALL\", \"*\")", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1526, "lineEnd": 1526, "lineMapIndex": 27, "methodParents": [], "nodeIndex": 2, "rootcause": false, "commits": ["b02a4b40610e93eef6559db09a11d287e859446d"]}, {"cfgs": [], "code": "kp.createKey(\"kA\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1542, "lineEnd": 1542, "lineMapIndex": 28, "methodParents": [], "nodeIndex": 3, "rootcause": false, "commits": ["e86c9ef6517313aaa0e4575261a462f2f55d43dc"]}, {"cfgs": [], "code": "kp.createKey(\"kA\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1563, "lineEnd": 1563, "lineMapIndex": 29, "methodParents": [], "nodeIndex": 4, "rootcause": false, "commits": ["e86c9ef6517313aaa0e4575261a462f2f55d43dc"]}, {"cfgs": [], "code": "kp.createKey(\"kD\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1572, "lineEnd": 1572, "lineMapIndex": 30, "methodParents": [], "nodeIndex": 5, "rootcause": false, "commits": ["e86c9ef6517313aaa0e4575261a462f2f55d43dc"]}, {"cfgs": [7], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kAA.ALL\", \"client\")", "dfgs": [7], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1707, "lineEnd": 1707, "lineMapIndex": 31, "methodParents": [], "nodeIndex": 6, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [8], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kBB.ALL\", \"foo\")", "dfgs": [8], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1708, "lineEnd": 1708, "lineMapIndex": 32, "methodParents": [], "nodeIndex": 7, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [9], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kCC.ALL\", \"foo1\")", "dfgs": [9], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1709, "lineEnd": 1709, "lineMapIndex": 33, "methodParents": [], "nodeIndex": 8, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kDD.ALL\", \"bar\")", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1710, "lineEnd": 1710, "lineMapIndex": 34, "methodParents": [], "nodeIndex": 9, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [], "code": "kp.createKey(\"kAA\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1735, "lineEnd": 1735, "lineMapIndex": 35, "methodParents": [], "nodeIndex": 10, "rootcause": false, "commits": ["e932365d6d46b5be16d0e79b751fac0b0b661400"]}, {"cfgs": [], "code": "fooUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {Assert.assertNotNull(kp.createKey(\"kBB\",new KeyProvider.Options(conf)));return null;}})", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1740, "lineEnd": 1747, "lineMapIndex": 36, "methodParents": [], "nodeIndex": 11, "rootcause": false, "commits": ["e932365d6d46b5be16d0e79b751fac0b0b661400"]}, {"cfgs": [], "code": "kp.createKey(\"kCC\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1756, "lineEnd": 1756, "lineMapIndex": 37, "methodParents": [], "nodeIndex": 12, "rootcause": false, "commits": ["e932365d6d46b5be16d0e79b751fac0b0b661400"]}, {"cfgs": [], "code": "Assert.assertNotNull(kp.createKey(\"kDD\",new KeyProvider.Options(conf)))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1773, "lineEnd": 1774, "lineMapIndex": 38, "methodParents": [], "nodeIndex": 13, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [15], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kAA.ALL\", \"foo\")", "dfgs": [15], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1813, "lineEnd": 1813, "lineMapIndex": 39, "methodParents": [], "nodeIndex": 14, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [16], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kBB.ALL\", \"foo1\")", "dfgs": [16], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1814, "lineEnd": 1814, "lineMapIndex": 40, "methodParents": [], "nodeIndex": 15, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [17], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kCC.ALL\", \"bar\")", "dfgs": [17], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1815, "lineEnd": 1815, "lineMapIndex": 41, "methodParents": [], "nodeIndex": 16, "rootcause": false, "commits": ["0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [], "code": "runServer(null, null, testDir, new KMSCallable<Void>() {@Overridepublic Void call() throws Exception {final Configuration conf = new Configuration();conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME, 64);final URI uri = createKMSUri(getKMSUrl());UserGroupInformation proxyUgi = null;if (kerberos) {// proxyuser client using kerberos credentialsproxyUgi = UserGroupInformation.loginUserFromKeytabAndReturnUGI(\"client\", keytab.getAbsolutePath());} else {proxyUgi = UserGroupInformation.createRemoteUser(\"client\");}final UserGroupInformation clientUgi = proxyUgi;clientUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {// authorized proxyuserUserGroupInformation fooUgi =UserGroupInformation.createProxyUser(\"foo\", clientUgi);fooUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {KeyProvider kp = new KMSClientProvider(uri, conf);Assert.assertNotNull(kp.createKey(\"kAA\",new KeyProvider.Options(conf)));return null;}});// unauthorized proxyuserUserGroupInformation foo1Ugi =UserGroupInformation.createProxyUser(\"foo1\", clientUgi);foo1Ugi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {try {KeyProvider kp = new KMSClientProvider(uri, conf);kp.createKey(\"kBB\", new KeyProvider.Options(conf));Assert.fail();} catch (Exception ex) {Assert.assertTrue(ex.getMessage(), ex.getMessage().contains(\"Forbidden\"));}return null;}});// authorized proxyuserUserGroupInformation barUgi =UserGroupInformation.createProxyUser(\"bar\", clientUgi);barUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {KeyProvider kp = new KMSClientProvider(uri, conf);Assert.assertNotNull(kp.createKey(\"kCC\",new KeyProvider.Options(conf)));return null;}});return null;}});return null;}})", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": true, "lineBeg": 1819, "lineEnd": 1889, "lineMapIndex": 42, "methodParents": [], "nodeIndex": 17, "rootcause": false, "commits": ["e932365d6d46b5be16d0e79b751fac0b0b661400", "0e57aa3bf689374736939300d8f3525ec38bead7"]}, {"cfgs": [], "code": "protected final String TEST_KEY = \"testKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": true, "lineBeg": 123, "lineEnd": 123, "lineMapIndex": 43, "methodParents": [], "nodeIndex": 18, "rootcause": false, "commits": ["d3d3d47202a18749eeebec22db759c19dd3e232c"]}, {"cfgs": [20], "code": "final String otherKey = \"otherKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": true, "lineBeg": 988, "lineEnd": 988, "lineMapIndex": 44, "methodParents": [], "nodeIndex": 19, "rootcause": false, "commits": ["74059536928beafed48a6a55a3b0146256d51f90"]}, {"cfgs": [], "code": "final String anotherKey = \"anotherKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": true, "lineBeg": 1008, "lineEnd": 1008, "lineMapIndex": 45, "methodParents": [], "nodeIndex": 20, "rootcause": false, "commits": ["74059536928beafed48a6a55a3b0146256d51f90"]}, {"cfgs": [], "code": "private final String TEST_KEY = \"testKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestReservedRawPaths.java", "fieldParents": [], "isDel": true, "lineBeg": 59, "lineEnd": 59, "lineMapIndex": 46, "methodParents": [], "nodeIndex": 21, "rootcause": false, "commits": ["3d9e39e51f8532716965dbafb16d9f0dbf3b79c5"]}, {"cfgs": [], "code": "private final String TEST_KEY = \"testKey\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZonesWithHA.java", "fieldParents": [], "isDel": true, "lineBeg": 51, "lineEnd": 51, "lineMapIndex": 47, "methodParents": [], "nodeIndex": 22, "rootcause": false, "commits": ["bf64fce78c5474f4d6ead839c4de18c8401a54d6"]}, {"cfgs": [], "code": "private static final String TEST_KEY = \"test_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs-nfs_src_test_java_org_apache_hadoop_hdfs_nfs_nfs3_TestRpcProgramNfs3.java", "fieldParents": [], "isDel": false, "lineBeg": 118, "lineEnd": 118, "lineMapIndex": 0, "methodParents": [], "nodeIndex": 23, "rootcause": false, "commits": []}, {"cfgs": [25], "code": "final String keyA = \"key_a\"", "dfgs": [26], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1525, "lineEnd": 1525, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 24, "rootcause": false, "commits": []}, {"cfgs": [26], "code": "final String keyD = \"key_d\"", "dfgs": [27], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1526, "lineEnd": 1526, "lineMapIndex": -1, "methodParents": [], "nodeIndex": 25, "rootcause": false, "commits": []}, {"cfgs": [27], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + keyA + \".ALL\", \"*\")", "dfgs": [27], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1527, "lineEnd": 1527, "lineMapIndex": 1, "methodParents": [], "nodeIndex": 26, "rootcause": false, "commits": []}, {"cfgs": [], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + keyD + \".ALL\", \"*\")", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1528, "lineEnd": 1528, "lineMapIndex": 2, "methodParents": [], "nodeIndex": 27, "rootcause": false, "commits": []}, {"cfgs": [], "code": "kp.createKey(keyA, new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1544, "lineEnd": 1544, "lineMapIndex": 3, "methodParents": [], "nodeIndex": 28, "rootcause": false, "commits": []}, {"cfgs": [], "code": "kp.createKey(keyA, new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1565, "lineEnd": 1565, "lineMapIndex": 4, "methodParents": [], "nodeIndex": 29, "rootcause": false, "commits": []}, {"cfgs": [], "code": "kp.createKey(keyD, new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1574, "lineEnd": 1574, "lineMapIndex": 5, "methodParents": [], "nodeIndex": 30, "rootcause": false, "commits": []}, {"cfgs": [32], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kaa.ALL\", \"client\")", "dfgs": [32], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1709, "lineEnd": 1709, "lineMapIndex": 6, "methodParents": [], "nodeIndex": 31, "rootcause": false, "commits": []}, {"cfgs": [33], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kbb.ALL\", \"foo\")", "dfgs": [33], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1710, "lineEnd": 1710, "lineMapIndex": 7, "methodParents": [], "nodeIndex": 32, "rootcause": false, "commits": []}, {"cfgs": [34], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kcc.ALL\", \"foo1\")", "dfgs": [34], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1711, "lineEnd": 1711, "lineMapIndex": 8, "methodParents": [], "nodeIndex": 33, "rootcause": false, "commits": []}, {"cfgs": [], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kdd.ALL\", \"bar\")", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1712, "lineEnd": 1712, "lineMapIndex": 9, "methodParents": [], "nodeIndex": 34, "rootcause": false, "commits": []}, {"cfgs": [], "code": "kp.createKey(\"kaa\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1737, "lineEnd": 1737, "lineMapIndex": 10, "methodParents": [], "nodeIndex": 35, "rootcause": false, "commits": []}, {"cfgs": [], "code": "fooUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {Assert.assertNotNull(kp.createKey(\"kbb\",new KeyProvider.Options(conf)));return null;}})", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1742, "lineEnd": 1749, "lineMapIndex": 11, "methodParents": [], "nodeIndex": 36, "rootcause": false, "commits": []}, {"cfgs": [], "code": "kp.createKey(\"kcc\", new KeyProvider.Options(conf))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1758, "lineEnd": 1758, "lineMapIndex": 12, "methodParents": [], "nodeIndex": 37, "rootcause": false, "commits": []}, {"cfgs": [], "code": "Assert.assertNotNull(kp.createKey(\"kdd\",new KeyProvider.Options(conf)))", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1775, "lineEnd": 1776, "lineMapIndex": 13, "methodParents": [], "nodeIndex": 38, "rootcause": false, "commits": []}, {"cfgs": [40], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kaa.ALL\", \"foo\")", "dfgs": [40], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1815, "lineEnd": 1815, "lineMapIndex": 14, "methodParents": [], "nodeIndex": 39, "rootcause": false, "commits": []}, {"cfgs": [41], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kbb.ALL\", \"foo1\")", "dfgs": [41], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1816, "lineEnd": 1816, "lineMapIndex": 15, "methodParents": [], "nodeIndex": 40, "rootcause": false, "commits": []}, {"cfgs": [42], "code": "conf.set(KeyAuthorizationKeyProvider.KEY_ACL + \"kcc.ALL\", \"bar\")", "dfgs": [42], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1817, "lineEnd": 1817, "lineMapIndex": 16, "methodParents": [], "nodeIndex": 41, "rootcause": false, "commits": []}, {"cfgs": [], "code": "runServer(null, null, testDir, new KMSCallable<Void>() {@Overridepublic Void call() throws Exception {final Configuration conf = new Configuration();conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME, 64);final URI uri = createKMSUri(getKMSUrl());UserGroupInformation proxyUgi = null;if (kerberos) {// proxyuser client using kerberos credentialsproxyUgi = UserGroupInformation.loginUserFromKeytabAndReturnUGI(\"client\", keytab.getAbsolutePath());} else {proxyUgi = UserGroupInformation.createRemoteUser(\"client\");}final UserGroupInformation clientUgi = proxyUgi;clientUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {// authorized proxyuserUserGroupInformation fooUgi =UserGroupInformation.createProxyUser(\"foo\", clientUgi);fooUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {KeyProvider kp = new KMSClientProvider(uri, conf);Assert.assertNotNull(kp.createKey(\"kaa\",new KeyProvider.Options(conf)));return null;}});// unauthorized proxyuserUserGroupInformation foo1Ugi =UserGroupInformation.createProxyUser(\"foo1\", clientUgi);foo1Ugi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {try {KeyProvider kp = new KMSClientProvider(uri, conf);kp.createKey(\"kbb\", new KeyProvider.Options(conf));Assert.fail();} catch (Exception ex) {Assert.assertTrue(ex.getMessage(), ex.getMessage().contains(\"Forbidden\"));}return null;}});// authorized proxyuserUserGroupInformation barUgi =UserGroupInformation.createProxyUser(\"bar\", clientUgi);barUgi.doAs(new PrivilegedExceptionAction<Void>() {@Overridepublic Void run() throws Exception {KeyProvider kp = new KMSClientProvider(uri, conf);Assert.assertNotNull(kp.createKey(\"kcc\",new KeyProvider.Options(conf)));return null;}});return null;}});return null;}})", "dfgs": [], "fName": "hadoop-common-project_hadoop-kms_src_test_java_org_apache_hadoop_crypto_key_kms_server_TestKMS.java", "fieldParents": [], "isDel": false, "lineBeg": 1821, "lineEnd": 1891, "lineMapIndex": 17, "methodParents": [], "nodeIndex": 42, "rootcause": false, "commits": []}, {"cfgs": [], "code": "protected final String TEST_KEY = \"test_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": false, "lineBeg": 123, "lineEnd": 123, "lineMapIndex": 18, "methodParents": [], "nodeIndex": 43, "rootcause": false, "commits": []}, {"cfgs": [45], "code": "final String otherKey = \"other_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": false, "lineBeg": 988, "lineEnd": 988, "lineMapIndex": 19, "methodParents": [], "nodeIndex": 44, "rootcause": false, "commits": []}, {"cfgs": [], "code": "final String anotherKey = \"another_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZones.java", "fieldParents": [], "isDel": false, "lineBeg": 1008, "lineEnd": 1008, "lineMapIndex": 20, "methodParents": [], "nodeIndex": 45, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private final String TEST_KEY = \"test_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestReservedRawPaths.java", "fieldParents": [], "isDel": false, "lineBeg": 59, "lineEnd": 59, "lineMapIndex": 21, "methodParents": [], "nodeIndex": 46, "rootcause": false, "commits": []}, {"cfgs": [], "code": "private final String TEST_KEY = \"test_key\"", "dfgs": [], "fName": "hadoop-hdfs-project_hadoop-hdfs_src_test_java_org_apache_hadoop_hdfs_TestEncryptionZonesWithHA.java", "fieldParents": [], "isDel": false, "lineBeg": 51, "lineEnd": 51, "lineMapIndex": 22, "methodParents": [], "nodeIndex": 47, "rootcause": false, "commits": []}]