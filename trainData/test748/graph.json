[{"cfgs":[],"code":"import org.verdictdb.core.query.AbstractRelation","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":3,"lineEnd":3,"lineMapIndex":9,"methodParents":[],"nodeIndex":0},{"cfgs":[],"code":"import org.verdictdb.core.query.BaseTable","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":4,"lineEnd":4,"lineMapIndex":10,"methodParents":[],"nodeIndex":1},{"cfgs":[],"code":"import org.verdictdb.core.query.JoinTable","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":5,"lineEnd":5,"lineMapIndex":11,"methodParents":[],"nodeIndex":2},{"cfgs":[],"code":"import org.verdictdb.core.query.SelectQuery","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":6,"lineEnd":6,"lineMapIndex":12,"methodParents":[],"nodeIndex":3},{"cfgs":[5],"code":"public static void convertSubqueriesIntoDependentNodes (SelectQuery query,CreateTableAsSelectExecutionNode node)","dfgs":[6,5],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":10,"lineEnd":12,"lineMapIndex":13,"methodParents":[],"nodeIndex":4},{"cfgs":[6],"code":"if (source instanceof JoinTable)","dfgs":[6],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":37,"lineEnd":37,"lineMapIndex":14,"methodParents":[],"nodeIndex":5},{"cfgs":[],"code":"((JoinTable) source).getJoinList().set(joinindex, base)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":true,"lineBeg":53,"lineEnd":53,"lineMapIndex":15,"methodParents":[],"nodeIndex":6},{"cfgs":[],"code":"SelectQuery rewritten = SelectQuery.create(Arrays.<SelectItem>asList(new AliasedColumn(new BaseColumn(\"newschema\", \"verdictdbtemptable_0\", \"a\"), \"a\")), new BaseTable(\"newschema\", \"verdictdbtemptable_0\", \"verdictdbtemptable_0\"))","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":true,"lineBeg":66,"lineEnd":69,"lineMapIndex":47,"methodParents":[],"nodeIndex":7},{"cfgs":[],"code":"ExecutionResult newTableToken = node.executeNode(conn, null)","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":true,"lineBeg":88,"lineEnd":88,"lineMapIndex":52,"methodParents":[],"nodeIndex":8},{"cfgs":[],"code":"import org.verdictdb.core.query.*","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":3,"lineEnd":3,"lineMapIndex":0,"methodParents":[],"nodeIndex":9},{"cfgs":[],"code":"import org.verdictdb.exception.VerdictDbException","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":4,"lineEnd":4,"lineMapIndex":1,"methodParents":[],"nodeIndex":10},{"cfgs":[],"code":"import java.util.ArrayList","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":6,"lineEnd":6,"lineMapIndex":2,"methodParents":[],"nodeIndex":11},{"cfgs":[],"code":"import java.util.List","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":7,"lineEnd":7,"lineMapIndex":3,"methodParents":[],"nodeIndex":12},{"cfgs":[15,14],"code":"public static void convertSubqueriesIntoDependentNodes(SelectQuery query,CreateTableAsSelectExecutionNode node)","dfgs":[15,16,33,26,28,30,14,18,19,17,20,22,21,23,35,44,36,41,45,29,31,43,46,25,34,37,42,38,39,40],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":11,"lineEnd":13,"lineMapIndex":4,"methodParents":[],"nodeIndex":13},{"cfgs":[15],"code":"if (source instanceof JoinTable)","dfgs":[16,33,26,28,30],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":37,"lineEnd":37,"lineMapIndex":5,"methodParents":[],"nodeIndex":14},{"cfgs":[16],"code":"int filterPlaceholderNum = 0","dfgs":[28],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":63,"lineEnd":63,"lineMapIndex":6,"methodParents":[],"nodeIndex":15},{"cfgs":[17],"code":"if (query.getFilter().isPresent())","dfgs":[17],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":66,"lineEnd":66,"lineMapIndex":-1,"methodParents":[],"nodeIndex":16},{"cfgs":[18],"code":"UnnamedColumn where = query.getFilter().get()","dfgs":[19],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":67,"lineEnd":67,"lineMapIndex":-1,"methodParents":[],"nodeIndex":17},{"cfgs":[19],"code":"List<UnnamedColumn> filters = new ArrayList<>()","dfgs":[19],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":68,"lineEnd":68,"lineMapIndex":-1,"methodParents":[],"nodeIndex":18},{"cfgs":[20],"code":"filters.add(where)","dfgs":[20],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":69,"lineEnd":69,"lineMapIndex":-1,"methodParents":[],"nodeIndex":19},{"cfgs":[21],"code":"while (!filters.isEmpty())","dfgs":[21],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":70,"lineEnd":70,"lineMapIndex":-1,"methodParents":[],"nodeIndex":20},{"cfgs":[22],"code":"UnnamedColumn filter = filters.get(0)","dfgs":[22,23],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":71,"lineEnd":71,"lineMapIndex":-1,"methodParents":[],"nodeIndex":21},{"cfgs":[23],"code":"filters.remove(0)","dfgs":[46],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":72,"lineEnd":72,"lineMapIndex":-1,"methodParents":[],"nodeIndex":22},{"cfgs":[25,45],"code":"if (filter instanceof SubqueryColumn)","dfgs":[44,45,29,25,36,42,30,33,43,26],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":74,"lineEnd":74,"lineMapIndex":-1,"methodParents":[],"nodeIndex":23},{"cfgs":[],"code":"BaseTable base","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":75,"lineEnd":75,"lineMapIndex":-1,"methodParents":[],"nodeIndex":24},{"cfgs":[26,27],"code":"if (((SubqueryColumn) filter).getSubquery().getAliasName().isPresent())","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":76,"lineEnd":76,"lineMapIndex":-1,"methodParents":[],"nodeIndex":25},{"cfgs":[29],"code":"base = node.createPlaceHolderTable(((SubqueryColumn) filter).getSubquery().getAliasName().get())","dfgs":[41,31,30,34,33,38],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":77,"lineEnd":77,"lineMapIndex":-1,"methodParents":[],"nodeIndex":26},{"cfgs":[28],"code":"else","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":78,"lineEnd":78,"lineMapIndex":-1,"methodParents":[],"nodeIndex":27},{"cfgs":[29],"code":"base = node.createPlaceHolderTable(\"filterPlaceholder\"+filterPlaceholderNum++)","dfgs":[41,31,30,34,33,38],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":79,"lineEnd":79,"lineMapIndex":-1,"methodParents":[],"nodeIndex":28},{"cfgs":[30,32],"code":"if (((SubqueryColumn) filter).getSubquery().isAggregateQuery())","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":82,"lineEnd":82,"lineMapIndex":-1,"methodParents":[],"nodeIndex":29},{"cfgs":[31],"code":"AggExecutionNode dep = AggExecutionNode.create(((SubqueryColumn) filter).getSubquery(), node.scratchpadSchemaName)","dfgs":[31],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":83,"lineEnd":83,"lineMapIndex":-1,"methodParents":[],"nodeIndex":30},{"cfgs":[35],"code":"node.addDependency(dep)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":84,"lineEnd":84,"lineMapIndex":-1,"methodParents":[],"nodeIndex":31},{"cfgs":[33],"code":"else","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":85,"lineEnd":85,"lineMapIndex":-1,"methodParents":[],"nodeIndex":32},{"cfgs":[34],"code":"ProjectionExecutionNode dep = ProjectionExecutionNode.create(((SubqueryColumn) filter).getSubquery(), node.scratchpadSchemaName)","dfgs":[34],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":86,"lineEnd":86,"lineMapIndex":-1,"methodParents":[],"nodeIndex":33},{"cfgs":[35],"code":"node.addDependency(dep)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":87,"lineEnd":87,"lineMapIndex":-1,"methodParents":[],"nodeIndex":34},{"cfgs":[36],"code":"List<SelectItem> newSelectItem = new ArrayList<>()","dfgs":[41,38,40],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":90,"lineEnd":90,"lineMapIndex":-1,"methodParents":[],"nodeIndex":35},{"cfgs":[41,37],"code":"for (SelectItem item : ((SubqueryColumn) filter).getSubquery().getSelectList())","dfgs":[37],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":91,"lineEnd":91,"lineMapIndex":-1,"methodParents":[],"nodeIndex":36},{"cfgs":[38,39],"code":"if (item instanceof AliasedColumn)","dfgs":[39,38],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":92,"lineEnd":92,"lineMapIndex":-1,"methodParents":[],"nodeIndex":37},{"cfgs":[],"code":"newSelectItem.add(new AliasedColumn(new BaseColumn(base.getSchemaName(), base.getAliasName().get(),((AliasedColumn) item).getAliasName()), ((AliasedColumn) item).getAliasName()))","dfgs":[41,40],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":93,"lineEnd":94,"lineMapIndex":-1,"methodParents":[],"nodeIndex":38},{"cfgs":[40],"code":"if (item instanceof AsteriskColumn)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":95,"lineEnd":95,"lineMapIndex":-1,"methodParents":[],"nodeIndex":39},{"cfgs":[],"code":"newSelectItem.add(new AsteriskColumn())","dfgs":[41],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":96,"lineEnd":96,"lineMapIndex":-1,"methodParents":[],"nodeIndex":40},{"cfgs":[42],"code":"SelectQuery newSubquery = SelectQuery.create(newSelectItem, base)","dfgs":[44,43],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":99,"lineEnd":99,"lineMapIndex":-1,"methodParents":[],"nodeIndex":41},{"cfgs":[44,43],"code":"if (((SubqueryColumn) filter).getSubquery().getAliasName().isPresent())","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":100,"lineEnd":100,"lineMapIndex":-1,"methodParents":[],"nodeIndex":42},{"cfgs":[44],"code":"newSubquery.setAliasName(((SubqueryColumn) filter).getSubquery().getAliasName().get())","dfgs":[44],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":101,"lineEnd":101,"lineMapIndex":-1,"methodParents":[],"nodeIndex":43},{"cfgs":[],"code":"((SubqueryColumn) filter).setSubquery(newSubquery)","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":103,"lineEnd":103,"lineMapIndex":-1,"methodParents":[],"nodeIndex":44},{"cfgs":[46],"code":"if (filter instanceof ColumnOp)","dfgs":[46],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":104,"lineEnd":104,"lineMapIndex":-1,"methodParents":[],"nodeIndex":45},{"cfgs":[],"code":"filters.addAll(((ColumnOp) filter).getOperands())","dfgs":[],"fName":"src_main_java_org_verdictdb_core_execution_SubqueriesToDependentNodes.java","fieldParents":[],"isDel":false,"lineBeg":105,"lineEnd":105,"lineMapIndex":-1,"methodParents":[],"nodeIndex":46},{"cfgs":[],"code":"SelectQuery rewritten = SelectQuery.create(Arrays.<SelectItem>asList(new AliasedColumn(new BaseColumn(\"placeholderSchemaName\", \"filterPlaceholder0\", \"a\"), \"a\")), new BaseTable(\"placeholderSchemaName\", \"placeholderTableName\", \"filterPlaceholder0\"))","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":66,"lineEnd":69,"lineMapIndex":7,"methodParents":[],"nodeIndex":47},{"cfgs":[49],"code":"QueryExecutionPlan.resetTempTableNameNum()","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":87,"lineEnd":87,"lineMapIndex":-1,"methodParents":[],"nodeIndex":48},{"cfgs":[50],"code":"ExecutionResult subqueryToken = new ExecutionResult()","dfgs":[50],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":88,"lineEnd":88,"lineMapIndex":-1,"methodParents":[],"nodeIndex":49},{"cfgs":[51],"code":"subqueryToken.setKeyValue(\"schemaName\", ((AggExecutionNode)node.dependents.get(0)).newTableSchemaName)","dfgs":[51],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":89,"lineEnd":89,"lineMapIndex":-1,"methodParents":[],"nodeIndex":50},{"cfgs":[52],"code":"subqueryToken.setKeyValue(\"tableName\", ((AggExecutionNode)node.dependents.get(0)).newTableName)","dfgs":[52],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":90,"lineEnd":90,"lineMapIndex":-1,"methodParents":[],"nodeIndex":51},{"cfgs":[53],"code":"ExecutionResult downstreamResult = node.dependents.get(0).executeNode(conn, null)","dfgs":[53],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":91,"lineEnd":91,"lineMapIndex":8,"methodParents":[],"nodeIndex":52},{"cfgs":[],"code":"ExecutionResult newTableToken = node.executeNode(conn, Arrays.asList(downstreamResult))","dfgs":[],"fName":"src_test_java_org_verdictdb_core_execution_AggExecutionNodeTest.java","fieldParents":[],"isDel":false,"lineBeg":92,"lineEnd":92,"lineMapIndex":-1,"methodParents":[],"nodeIndex":53}]